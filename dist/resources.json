[{"name":"brave-fix","aliases":[],"kind":{"mime":"application/javascript"},"content":"Ly8vIGJyYXZlLWZpeC5qcwovLy8gYWxpYXMgYmYuanMKZGVsZXRlIE5hdmlnYXRvci5wcm90b3R5cGUuYnJhdmUKZGVsZXRlIHdpbmRvdy5uYXZpZ2F0b3IuYnJhdmUK"},{"name":"sugarcoat-04f269ddab55349c262c62c9eaad20beb4273ffb","aliases":[],"kind":{"mime":"application/javascript"},"content":"ewogICAgY29uc3QgJF9fX21vY2tfMzgxZTVjNzY3NGM1NTc5OCA9IHt9OwogICAgKGV4cG9ydHMgPT4gewogICAgICAgICd1c2Ugc3RyaWN0JzsKICAgICAgICBjb25zdCBmZXRjaCA9IGFzeW5jIChyZXNvdXJjZSwgaW5pdCA9IG51bGwpID0+IHsKICAgICAgICAgICAgdGhyb3cgbmV3IFR5cGVFcnJvcignRmFpbGVkIHRvIGZldGNoJyk7CiAgICAgICAgfTsKICAgICAgICBleHBvcnRzLmZldGNoID0gewogICAgICAgICAgICBjb25maWd1cmFibGU6IHRydWUsCiAgICAgICAgICAgIGVudW1lcmFibGU6IHRydWUsCiAgICAgICAgICAgIHZhbHVlOiBmZXRjaCwKICAgICAgICAgICAgd3JpdGFibGU6IHRydWUKICAgICAgICB9OwogICAgfSkoJF9fX21vY2tfMzgxZTVjNzY3NGM1NTc5OCk7CiAgICBjb25zdCAkX19fbW9ja19hMjBhNTA5YjRlNzZjYTFkID0ge307CiAgICAoZXhwb3J0cyA9PiB7CiAgICAgICAgJ3VzZSBzdHJpY3QnOwogICAgICAgIGxldCBpc1NlYWxlZCA9IGZhbHNlOwogICAgICAgIGNsYXNzIFN0b3JhZ2UgewogICAgICAgICAgICBjb25zdHJ1Y3RvcigpIHsKICAgICAgICAgICAgICAgIGlmIChpc1NlYWxlZCkgewogICAgICAgICAgICAgICAgICAgIHRocm93IG5ldyBUeXBlRXJyb3IoJ0lsbGVnYWwgY29uc3RydWN0b3InKTsKICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgfQogICAgICAgICAgICBnZXQgbGVuZ3RoKCkgewogICAgICAgICAgICAgICAgcmV0dXJuIE9iamVjdC5rZXlzKHRoaXMpLmxlbmd0aDsKICAgICAgICAgICAgfQogICAgICAgICAgICBrZXkoaW5kZXgpIHsKICAgICAgICAgICAgICAgIGNvbnN0IGtleXMgPSBPYmplY3Qua2V5cyh0aGlzKTsKICAgICAgICAgICAgICAgIGlmIChpbmRleCA8IDAgfHwgaW5kZXggPj0ga2V5cy5sZW5ndGgpIHsKICAgICAgICAgICAgICAgICAgICByZXR1cm4gbnVsbDsKICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgIHJldHVybiBrZXlzW2luZGV4XTsKICAgICAgICAgICAgfQogICAgICAgICAgICBnZXRJdGVtKGtleSkgewogICAgICAgICAgICAgICAgcmV0dXJuIE9iamVjdC5wcm90b3R5cGUuaGFzT3duUHJvcGVydHkuY2FsbCh0aGlzLCBrZXkpID8gdGhpc1trZXldIDogbnVsbDsKICAgICAgICAgICAgfQogICAgICAgICAgICBzZXRJdGVtKGtleSwgdmFsdWUpIHsKICAgICAgICAgICAgICAgIHRoaXNba2V5XSA9IFN0cmluZyh2YWx1ZSk7CiAgICAgICAgICAgIH0KICAgICAgICAgICAgcmVtb3ZlSXRlbShrZXkpIHsKICAgICAgICAgICAgICAgIGRlbGV0ZSB0aGlzW2tleV07CiAgICAgICAgICAgIH0KICAgICAgICAgICAgY2xlYXIoKSB7CiAgICAgICAgICAgICAgICBjb25zdCBrZXlzID0gT2JqZWN0LmtleXModGhpcyk7CiAgICAgICAgICAgICAgICBmb3IgKGNvbnN0IGtleSBvZiBrZXlzKSB7CiAgICAgICAgICAgICAgICAgICAgZGVsZXRlIHRoaXNba2V5XTsKICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgfQogICAgICAgIH0KICAgICAgICBleHBvcnRzLlN0b3JhZ2UgPSB7CiAgICAgICAgICAgIGNvbmZpZ3VyYWJsZTogdHJ1ZSwKICAgICAgICAgICAgZW51bWVyYWJsZTogdHJ1ZSwKICAgICAgICAgICAgdmFsdWU6IFN0b3JhZ2UsCiAgICAgICAgICAgIHdyaXRhYmxlOiB0cnVlCiAgICAgICAgfTsKICAgICAgICBjb25zdCBsb2NhbFN0b3JhZ2UgPSBuZXcgU3RvcmFnZSgpOwogICAgICAgIGV4cG9ydHMubG9jYWxTdG9yYWdlID0gewogICAgICAgICAgICBjb25maWd1cmFibGU6IHRydWUsCiAgICAgICAgICAgIGVudW1lcmFibGU6IHRydWUsCiAgICAgICAgICAgIGdldCgpIHsKICAgICAgICAgICAgICAgIHJldHVybiBsb2NhbFN0b3JhZ2U7CiAgICAgICAgICAgIH0KICAgICAgICB9OwogICAgICAgIGNvbnN0IHNlc3Npb25TdG9yYWdlID0gbmV3IFN0b3JhZ2UoKTsKICAgICAgICBleHBvcnRzLnNlc3Npb25TdG9yYWdlID0gewogICAgICAgICAgICBjb25maWd1cmFibGU6IHRydWUsCiAgICAgICAgICAgIGVudW1lcmFibGU6IHRydWUsCiAgICAgICAgICAgIGdldCgpIHsKICAgICAgICAgICAgICAgIHJldHVybiBzZXNzaW9uU3RvcmFnZTsKICAgICAgICAgICAgfQogICAgICAgIH07CiAgICAgICAgaXNTZWFsZWQgPSB0cnVlOwogICAgfSkoJF9fX21vY2tfYTIwYTUwOWI0ZTc2Y2ExZCk7CiAgICAoZnVuY3Rpb24gKCkgewogICAgICAgIE1hcmtldGluZy5iaW5kRGVwZW5kZW5jeURPTVBhcnNlZChmdW5jdGlvbiAoKSB7CiAgICAgICAgICAgIHZhciBCb290c3RyYXBwZXIgPSB3aW5kb3dbJ01hcmtldGluZyddOwogICAgICAgICAgICB2YXIgZW5zaWdodGVuT3B0aW9ucyA9IE1hcmtldGluZy5lbnNpZ2h0ZW5PcHRpb25zOwogICAgICAgICAgICB0cnkgewogICAgICAgICAgICAgICAgTWFya2V0aW5nLlVETy5wZXJmVGltaW5nU3RhcnQoJ3J1bGVJZC0nICsgdGhpcy5pZCArICctZGVwbG95bWVudElkLScgKyB0aGlzLmRlcGxveW1lbnRJZCk7CiAgICAgICAgICAgICAgICB2YXIgZmlyZVBpeGVsID0gZnVuY3Rpb24gKCkgewogICAgICAgICAgICAgICAgICAgIGlmIChNYXJrZXRpbmcuVURPLnByb21vaWQgIT09ICcxMDAnICYmICFsb2NhdGlvbi5ocmVmLmluY2x1ZGVzKCd0aGFua3lvdScpKQogICAgICAgICAgICAgICAgICAgICAgICBNYXJrZXRpbmcubG9hZFNjcmlwdENhbGxiYWNrKCdodHRwczovL2F0cy5ybGNkbi5jb20vYXRzLmpzJywgZnVuY3Rpb24gKCkgewogICAgICAgICAgICAgICAgICAgICAgICAgICAgY29uc3QgJF9fX29sZF9kY2NkNjQ4YTRhODE0Nzk2ID0ge30uY29uc3RydWN0b3IuZ2V0T3duUHJvcGVydHlEZXNjcmlwdG9yKHdpbmRvdywgJ2ZldGNoJyksICRfX19vbGRfMDdjZTIxZDY5NmNhMmNlMiA9IHt9LmNvbnN0cnVjdG9yLmdldE93blByb3BlcnR5RGVzY3JpcHRvcih3aW5kb3csICdsb2NhbFN0b3JhZ2UnKTsKICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRyeSB7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKCRfX19vbGRfZGNjZDY0OGE0YTgxNDc5NikKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgKHt9LmNvbnN0cnVjdG9yLmRlZmluZVByb3BlcnR5KHdpbmRvdywgJ2ZldGNoJywgJF9fX21vY2tfMzgxZTVjNzY3NGM1NTc5OC5mZXRjaCkpOwogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmICgkX19fb2xkXzA3Y2UyMWQ2OTZjYTJjZTIpCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICh7fS5jb25zdHJ1Y3Rvci5kZWZpbmVQcm9wZXJ0eSh3aW5kb3csICdsb2NhbFN0b3JhZ2UnLCAkX19fbW9ja19hMjBhNTA5YjRlNzZjYTFkLmxvY2FsU3RvcmFnZSkpOwogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiBmdW5jdGlvbiAoKSB7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHdpbmRvdy5hdHMuc3RhcnQoewogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgJ3BsYWNlbWVudElEJzogJzEzNDQyJywKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICdzdG9yYWdlVHlwZSc6ICdsb2NhbFN0b3JhZ2UnLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgJ2RldGVjdGlvblR5cGUnOiAnc2NyYXBlQW5kVXJsJywKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICd1cmxQYXJhbWV0ZXInOiAnZW52JywKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICdlbWFpbEhhc2hlcyc6IFtNYXJrZXRpbmcuVURPLmVtYWlsaGFzaF0sCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAnbG9nZ2luZyc6ICdlcnJvcicKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfSk7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHZhciBkb21haW5NYXAgPSBsb2NhdGlvbi5ob3N0LmluY2x1ZGVzKCdkZWxsdGVjaG5vbG9naWVzJykgPyAnZGVsbHRlY2hub2xvZ2llcy5jb20nIDogJ2RlbGwuY29tJzsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdmFyIHByb21vaWRNYXAgPSB7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAxOiAnbWFpbl9ob21lcGFnZScsCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAyOiAnc2VnX2hvbWVwYWdlJywKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIDM6ICdwcm9kdWN0Y2F0ZWdvcnknLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgNDogJ2RlYWxzJywKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIDU6ICdmYW1pbHknLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgNjogJ2ZlYXR1cmVzJywKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIDc6ICdwcm9kdWN0ZGV0YWlscycsCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICA4OiAnY29uZmlndXJhdG9yJywKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIDk6ICdjYXJ0JwogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9OwogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB2YXIgcGFnZU5hbWUgPSBwcm9tb2lkTWFwW01hcmtldGluZy5VRE8ucHJvbW9pZF0gPyBwcm9tb2lkTWFwW01hcmtldGluZy5VRE8ucHJvbW9pZF0gOiBkb21haW5NYXAuaW5jbHVkZXMoJ2RlbGwuY29tJykgPyAnZGVsbF9wYWdlJyA6ICdkZWxsdGVjaF9wYWdlJzsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdmFyIGVudmVsb3BWYWx1ZSA9IGxvY2FsU3RvcmFnZS5nZXRJdGVtKCdfbHJfZW52JykgPyBKU09OLnBhcnNlKGF0b2IobG9jYWxTdG9yYWdlLmdldEl0ZW0oJ19scl9lbnYnKSkpLmVudmVsb3BlIDogJyc7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHZhciBwZGF0YU1hcCA9ICdjb3VudHJ5PScgKyBNYXJrZXRpbmcuVURPLmNvdW50cnkgKyAnLGxhbmd1YWdlPScgKyBNYXJrZXRpbmcuVURPLmxhbmd1YWdlICsgJyxzZWdtZW50PScgKyBNYXJrZXRpbmcuVURPLnNlZ21lbnQgKyAnLGRvbWFpbj0nICsgZG9tYWluTWFwICsgJyxwYWdlPScgKyBwYWdlTmFtZTsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgTWFya2V0aW5nLmltYWdlUmVxdWVzdCgnLy90LnJsY2RuLmNvbS9hcGkvc2VnbWVudD9waWQ9NzExMzk0Jml0PTE5Jml2PScgKyBlbnZlbG9wVmFsdWUgKyAnJnBkYXRhPScgKyBlbmNvZGVVUklDb21wb25lbnQocGRhdGFNYXApKTsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9LmFwcGx5KHRoaXMsIGFyZ3VtZW50cyk7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9IGZpbmFsbHkgewogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmICgkX19fb2xkX2RjY2Q2NDhhNGE4MTQ3OTYpCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICh7fS5jb25zdHJ1Y3Rvci5kZWZpbmVQcm9wZXJ0eSh3aW5kb3csICdmZXRjaCcsICRfX19vbGRfZGNjZDY0OGE0YTgxNDc5NikpOwogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmICgkX19fb2xkXzA3Y2UyMWQ2OTZjYTJjZTIpCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICh7fS5jb25zdHJ1Y3Rvci5kZWZpbmVQcm9wZXJ0eSh3aW5kb3csICdsb2NhbFN0b3JhZ2UnLCAkX19fb2xkXzA3Y2UyMWQ2OTZjYTJjZTIpKTsKICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgICAgICAgICAgfSk7CiAgICAgICAgICAgICAgICB9OwogICAgICAgICAgICAgICAgZmlyZVBpeGVsKCk7CiAgICAgICAgICAgICAgICBpZiAoTWFya2V0aW5nLnNjRGF0YU9iai5jbXMgPT0gJ29scicpCiAgICAgICAgICAgICAgICAgICAgd2luZG93LmFkZEV2ZW50TGlzdGVuZXIoJ3Vkb1JlYWR5JywgZnVuY3Rpb24gKGUpIHsKICAgICAgICAgICAgICAgICAgICAgICAgZmlyZVBpeGVsKCk7CiAgICAgICAgICAgICAgICAgICAgfSk7CiAgICAgICAgICAgICAgICBNYXJrZXRpbmcuVURPLnBlcmZUaW1pbmdFbmQoJ3J1bGVJZC0nICsgdGhpcy5pZCArICctZGVwbG95bWVudElkLScgKyB0aGlzLmRlcGxveW1lbnRJZCk7CiAgICAgICAgICAgIH0gY2F0Y2ggKGUpIHsKICAgICAgICAgICAgICAgIGRlbGxfbWFya2V0aW5nX3V0aWwuZGVidWcoZSk7CiAgICAgICAgICAgIH0KICAgICAgICB9LCAzNTkzMjkxLCBbMzYwNjMyOV0sIDY4NzE0OSwgWzYxMDMyM10pOwogICAgfSgpKQp9"},{"name":"sugarcoat-06d26e2fbffa08a55a4eaffb9985a5537514a5d0","aliases":[],"kind":{"mime":"application/javascript"},"content":"ewogICAgY29uc3QgJF9fX21vY2tfM2UxZjI1OWM3YzcwMmVjZSA9IHt9OwogICAgKGV4cG9ydHMgPT4gewogICAgICAgICd1c2Ugc3RyaWN0JzsKICAgICAgICBjb25zdCB4aHJVbnNlbnQgPSAwOwogICAgICAgIGNvbnN0IHhock9wZW5lZCA9IDE7CiAgICAgICAgY29uc3QgeGhySGVhZGVyc1JlY2VpdmVkID0gMjsKICAgICAgICBjb25zdCB4aHJMb2FkaW5nID0gMzsKICAgICAgICBjb25zdCB4aHJEb25lID0gNDsKICAgICAgICBjb25zdCB4aHJEZWZlcnJlZEhhbmRsZVN5bWJvbCA9IFN5bWJvbCgnZGVmZXJyZWRIYW5kbGUnKTsKICAgICAgICBjb25zdCB4aHJPbkxvYWRTdGFydFN5bWJvbCA9IFN5bWJvbCgnb25sb2Fkc3RhcnQnKTsKICAgICAgICBjb25zdCB4aHJPblByb2dyZXNzU3ltYm9sID0gU3ltYm9sKCdvbnByb2dyZXNzJyk7CiAgICAgICAgY29uc3QgeGhyT25BYm9ydFN5bWJvbCA9IFN5bWJvbCgnb25hYm9ydCcpOwogICAgICAgIGNvbnN0IHhock9uRXJyb3JTeW1ib2wgPSBTeW1ib2woJ29uZXJyb3InKTsKICAgICAgICBjb25zdCB4aHJPbkxvYWRTeW1ib2wgPSBTeW1ib2woJ29ubG9hZCcpOwogICAgICAgIGNvbnN0IHhock9uVGltZW91dFN5bWJvbCA9IFN5bWJvbCgnb250aW1lb3V0Jyk7CiAgICAgICAgY29uc3QgeGhyT25Mb2FkRW5kU3ltYm9sID0gU3ltYm9sKCdvbmxvYWRlbmQnKTsKICAgICAgICBjb25zdCB4aHJPblJlYWR5U3RhdGVDaGFuZ2VTeW1ib2wgPSBTeW1ib2woJ29ucmVhZHlzdGF0ZWNoYW5nZScpOwogICAgICAgIGNvbnN0IHhoclJlYWR5U3RhdGVTeW1ib2wgPSBTeW1ib2woJ3JlYWR5U3RhdGUnKTsKICAgICAgICBjb25zdCB4aHJUaW1lb3V0U3ltYm9sID0gU3ltYm9sKCd0aW1lb3V0Jyk7CiAgICAgICAgY29uc3QgeGhyV2l0aENyZWRlbnRpYWxzU3ltYm9sID0gU3ltYm9sKCd3aXRoQ3JlZGVudGlhbHMnKTsKICAgICAgICBjb25zdCB4aHJVcGxvYWRTeW1ib2wgPSBTeW1ib2woJ3VwbG9hZCcpOwogICAgICAgIGNvbnN0IHhoclJlc3BvbnNlVHlwZVN5bWJvbCA9IFN5bWJvbCgncmVzcG9uc2VUeXBlJyk7CiAgICAgICAgY29uc3QgZGVmaW5lRXZlbnQgPSAob2JqLCBzeW1ib2wpID0+IHsKICAgICAgICAgICAgY29uc3QgdHlwZSA9IHN5bWJvbC5kZXNjcmlwdGlvbi5zdWJzdHJpbmcoMik7CiAgICAgICAgICAgIE9iamVjdC5kZWZpbmVQcm9wZXJ0eShvYmosIHN5bWJvbCwgewogICAgICAgICAgICAgICAgY29uZmlndXJhYmxlOiBmYWxzZSwKICAgICAgICAgICAgICAgIGVudW1lcmFibGU6IGZhbHNlLAogICAgICAgICAgICAgICAgdmFsdWU6IG51bGwsCiAgICAgICAgICAgICAgICB3cml0YWJsZTogdHJ1ZQogICAgICAgICAgICB9KTsKICAgICAgICAgICAgb2JqLmFkZEV2ZW50TGlzdGVuZXIodHlwZSwgZnVuY3Rpb24gKGV2ZW50KSB7CiAgICAgICAgICAgICAgICBjb25zdCBoYW5kbGVyID0gdGhpc1tzeW1ib2xdOwogICAgICAgICAgICAgICAgaWYgKGhhbmRsZXIpIHsKICAgICAgICAgICAgICAgICAgICBoYW5kbGVyLmNhbGwodGhpcywgZXZlbnQpOwogICAgICAgICAgICAgICAgfQogICAgICAgICAgICB9KTsKICAgICAgICB9OwogICAgICAgIGNvbnN0IGNoYW5nZVJlYWR5U3RhdGUgPSAoeGhyLCByZWFkeVN0YXRlKSA9PiB7CiAgICAgICAgICAgIHhoclt4aHJSZWFkeVN0YXRlU3ltYm9sXSA9IHJlYWR5U3RhdGU7CiAgICAgICAgICAgIHhoci5kaXNwYXRjaEV2ZW50KG5ldyBFdmVudCgncmVhZHlzdGF0ZWNoYW5nZScpKTsKICAgICAgICB9OwogICAgICAgIGxldCBpc1NlYWxlZCA9IHRydWU7CiAgICAgICAgY2xhc3MgWE1MSHR0cFJlcXVlc3RFdmVudFRhcmdldCBleHRlbmRzIEV2ZW50VGFyZ2V0IHsKICAgICAgICAgICAgY29uc3RydWN0b3IoKSB7CiAgICAgICAgICAgICAgICBzdXBlcigpOwogICAgICAgICAgICAgICAgaWYgKCEodGhpcyBpbnN0YW5jZW9mIFhNTEh0dHBSZXF1ZXN0KSAmJiAhKHRoaXMgaW5zdGFuY2VvZiBYTUxIdHRwUmVxdWVzdFVwbG9hZCkpIHsKICAgICAgICAgICAgICAgICAgICB0aHJvdyBuZXcgVHlwZUVycm9yKCdJbGxlZ2FsIGNvbnN0cnVjdG9yJyk7CiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICBkZWZpbmVFdmVudCh0aGlzLCB4aHJPbkxvYWRTdGFydFN5bWJvbCk7CiAgICAgICAgICAgICAgICBkZWZpbmVFdmVudCh0aGlzLCB4aHJPblByb2dyZXNzU3ltYm9sKTsKICAgICAgICAgICAgICAgIGRlZmluZUV2ZW50KHRoaXMsIHhock9uQWJvcnRTeW1ib2wpOwogICAgICAgICAgICAgICAgZGVmaW5lRXZlbnQodGhpcywgeGhyT25FcnJvclN5bWJvbCk7CiAgICAgICAgICAgICAgICBkZWZpbmVFdmVudCh0aGlzLCB4aHJPbkxvYWRTeW1ib2wpOwogICAgICAgICAgICAgICAgZGVmaW5lRXZlbnQodGhpcywgeGhyT25UaW1lb3V0U3ltYm9sKTsKICAgICAgICAgICAgICAgIGRlZmluZUV2ZW50KHRoaXMsIHhock9uTG9hZEVuZFN5bWJvbCk7CiAgICAgICAgICAgIH0KICAgICAgICAgICAgZ2V0IG9ubG9hZHN0YXJ0KCkgewogICAgICAgICAgICAgICAgcmV0dXJuIHRoaXNbeGhyT25Mb2FkU3RhcnRTeW1ib2xdOwogICAgICAgICAgICB9CiAgICAgICAgICAgIHNldCBvbmxvYWRzdGFydCh2YWx1ZSkgewogICAgICAgICAgICAgICAgdGhpc1t4aHJPbkxvYWRTdGFydFN5bWJvbF0gPSB2YWx1ZTsKICAgICAgICAgICAgfQogICAgICAgICAgICBnZXQgb25wcm9ncmVzcygpIHsKICAgICAgICAgICAgICAgIHJldHVybiB0aGlzW3hock9uUHJvZ3Jlc3NTeW1ib2xdOwogICAgICAgICAgICB9CiAgICAgICAgICAgIHNldCBvbnByb2dyZXNzKHZhbHVlKSB7CiAgICAgICAgICAgICAgICB0aGlzW3hock9uUHJvZ3Jlc3NTeW1ib2xdID0gdmFsdWU7CiAgICAgICAgICAgIH0KICAgICAgICAgICAgZ2V0IG9uYWJvcnQoKSB7CiAgICAgICAgICAgICAgICByZXR1cm4gdGhpc1t4aHJPbkFib3J0U3ltYm9sXTsKICAgICAgICAgICAgfQogICAgICAgICAgICBzZXQgb25hYm9ydCh2YWx1ZSkgewogICAgICAgICAgICAgICAgdGhpc1t4aHJPbkFib3J0U3ltYm9sXSA9IHZhbHVlOwogICAgICAgICAgICB9CiAgICAgICAgICAgIGdldCBvbmVycm9yKCkgewogICAgICAgICAgICAgICAgcmV0dXJuIHRoaXNbeGhyT25FcnJvclN5bWJvbF07CiAgICAgICAgICAgIH0KICAgICAgICAgICAgc2V0IG9uZXJyb3IodmFsdWUpIHsKICAgICAgICAgICAgICAgIHRoaXNbeGhyT25FcnJvclN5bWJvbF0gPSB2YWx1ZTsKICAgICAgICAgICAgfQogICAgICAgICAgICBnZXQgb250aW1lb3V0KCkgewogICAgICAgICAgICAgICAgcmV0dXJuIHRoaXNbeGhyT25UaW1lb3V0U3ltYm9sXTsKICAgICAgICAgICAgfQogICAgICAgICAgICBzZXQgb250aW1lb3V0KHZhbHVlKSB7CiAgICAgICAgICAgICAgICB0aGlzW3hock9uVGltZW91dFN5bWJvbF0gPSB2YWx1ZTsKICAgICAgICAgICAgfQogICAgICAgICAgICBnZXQgb25sb2FkZW5kKCkgewogICAgICAgICAgICAgICAgcmV0dXJuIHRoaXNbeGhyT25Mb2FkRW5kU3ltYm9sXTsKICAgICAgICAgICAgfQogICAgICAgICAgICBzZXQgb25sb2FkZW5kKHZhbHVlKSB7CiAgICAgICAgICAgICAgICB0aGlzW3hock9uTG9hZEVuZFN5bWJvbF0gPSB2YWx1ZTsKICAgICAgICAgICAgfQogICAgICAgIH0KICAgICAgICBleHBvcnRzLlhNTEh0dHBSZXF1ZXN0RXZlbnRUYXJnZXQgPSB7CiAgICAgICAgICAgIGNvbmZpZ3VyYWJsZTogdHJ1ZSwKICAgICAgICAgICAgZW51bWVyYWJsZTogdHJ1ZSwKICAgICAgICAgICAgdmFsdWU6IFhNTEh0dHBSZXF1ZXN0RXZlbnRUYXJnZXQsCiAgICAgICAgICAgIHdyaXRhYmxlOiB0cnVlCiAgICAgICAgfTsKICAgICAgICBjbGFzcyBYTUxIdHRwUmVxdWVzdFVwbG9hZCBleHRlbmRzIFhNTEh0dHBSZXF1ZXN0RXZlbnRUYXJnZXQgewogICAgICAgICAgICBjb25zdHJ1Y3RvcigpIHsKICAgICAgICAgICAgICAgIGlmIChpc1NlYWxlZCkgewogICAgICAgICAgICAgICAgICAgIHRocm93IG5ldyBUeXBlRXJyb3IoJ0lsbGVnYWwgY29uc3RydWN0b3InKTsKICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgIHN1cGVyKCk7CiAgICAgICAgICAgIH0KICAgICAgICB9CiAgICAgICAgZXhwb3J0cy5YTUxIdHRwUmVxdWVzdFVwbG9hZCA9IHsKICAgICAgICAgICAgY29uZmlndXJhYmxlOiB0cnVlLAogICAgICAgICAgICBlbnVtZXJhYmxlOiB0cnVlLAogICAgICAgICAgICB2YWx1ZTogWE1MSHR0cFJlcXVlc3RVcGxvYWQsCiAgICAgICAgICAgIHdyaXRhYmxlOiB0cnVlCiAgICAgICAgfTsKICAgICAgICBjbGFzcyBYTUxIdHRwUmVxdWVzdCBleHRlbmRzIFhNTEh0dHBSZXF1ZXN0RXZlbnRUYXJnZXQgewogICAgICAgICAgICBjb25zdHJ1Y3RvcigpIHsKICAgICAgICAgICAgICAgIHN1cGVyKCk7CiAgICAgICAgICAgICAgICBpc1NlYWxlZCA9IGZhbHNlOwogICAgICAgICAgICAgICAgY29uc3QgeGhyVXBsb2FkID0gbmV3IFhNTEh0dHBSZXF1ZXN0VXBsb2FkKCk7CiAgICAgICAgICAgICAgICBpc1NlYWxlZCA9IHRydWU7CiAgICAgICAgICAgICAgICBPYmplY3QuZGVmaW5lUHJvcGVydHkodGhpcywgeGhyRGVmZXJyZWRIYW5kbGVTeW1ib2wsIHsKICAgICAgICAgICAgICAgICAgICBjb25maWd1cmFibGU6IGZhbHNlLAogICAgICAgICAgICAgICAgICAgIGVudW1lcmFibGU6IGZhbHNlLAogICAgICAgICAgICAgICAgICAgIHZhbHVlOiBudWxsLAogICAgICAgICAgICAgICAgICAgIHdyaXRhYmxlOiB0cnVlCiAgICAgICAgICAgICAgICB9KTsKICAgICAgICAgICAgICAgIGRlZmluZUV2ZW50KHRoaXMsIHhock9uUmVhZHlTdGF0ZUNoYW5nZVN5bWJvbCk7CiAgICAgICAgICAgICAgICBPYmplY3QuZGVmaW5lUHJvcGVydHkodGhpcywgeGhyUmVhZHlTdGF0ZVN5bWJvbCwgewogICAgICAgICAgICAgICAgICAgIGNvbmZpZ3VyYWJsZTogZmFsc2UsCiAgICAgICAgICAgICAgICAgICAgZW51bWVyYWJsZTogZmFsc2UsCiAgICAgICAgICAgICAgICAgICAgdmFsdWU6IHhoclVuc2VudCwKICAgICAgICAgICAgICAgICAgICB3cml0YWJsZTogdHJ1ZQogICAgICAgICAgICAgICAgfSk7CiAgICAgICAgICAgICAgICBPYmplY3QuZGVmaW5lUHJvcGVydHkodGhpcywgeGhyVGltZW91dFN5bWJvbCwgewogICAgICAgICAgICAgICAgICAgIGNvbmZpZ3VyYWJsZTogZmFsc2UsCiAgICAgICAgICAgICAgICAgICAgZW51bWVyYWJsZTogZmFsc2UsCiAgICAgICAgICAgICAgICAgICAgdmFsdWU6IDAsCiAgICAgICAgICAgICAgICAgICAgd3JpdGFibGU6IHRydWUKICAgICAgICAgICAgICAgIH0pOwogICAgICAgICAgICAgICAgT2JqZWN0LmRlZmluZVByb3BlcnR5KHRoaXMsIHhocldpdGhDcmVkZW50aWFsc1N5bWJvbCwgewogICAgICAgICAgICAgICAgICAgIGNvbmZpZ3VyYWJsZTogZmFsc2UsCiAgICAgICAgICAgICAgICAgICAgZW51bWVyYWJsZTogZmFsc2UsCiAgICAgICAgICAgICAgICAgICAgdmFsdWU6IGZhbHNlLAogICAgICAgICAgICAgICAgICAgIHdyaXRhYmxlOiB0cnVlCiAgICAgICAgICAgICAgICB9KTsKICAgICAgICAgICAgICAgIE9iamVjdC5kZWZpbmVQcm9wZXJ0eSh0aGlzLCB4aHJVcGxvYWRTeW1ib2wsIHsKICAgICAgICAgICAgICAgICAgICBjb25maWd1cmFibGU6IGZhbHNlLAogICAgICAgICAgICAgICAgICAgIGVudW1lcmFibGU6IGZhbHNlLAogICAgICAgICAgICAgICAgICAgIHZhbHVlOiB4aHJVcGxvYWQsCiAgICAgICAgICAgICAgICAgICAgd3JpdGFibGU6IGZhbHNlCiAgICAgICAgICAgICAgICB9KTsKICAgICAgICAgICAgICAgIE9iamVjdC5kZWZpbmVQcm9wZXJ0eSh0aGlzLCB4aHJSZXNwb25zZVR5cGVTeW1ib2wsIHsKICAgICAgICAgICAgICAgICAgICBjb25maWd1cmFibGU6IGZhbHNlLAogICAgICAgICAgICAgICAgICAgIGVudW1lcmFibGU6IGZhbHNlLAogICAgICAgICAgICAgICAgICAgIHZhbHVlOiAnJywKICAgICAgICAgICAgICAgICAgICB3cml0YWJsZTogdHJ1ZQogICAgICAgICAgICAgICAgfSk7CiAgICAgICAgICAgIH0KICAgICAgICAgICAgZ2V0IG9ucmVhZHlzdGF0ZWNoYW5nZSgpIHsKICAgICAgICAgICAgICAgIHJldHVybiB0aGlzW3hock9uUmVhZHlTdGF0ZUNoYW5nZVN5bWJvbF07CiAgICAgICAgICAgIH0KICAgICAgICAgICAgc2V0IG9ucmVhZHlzdGF0ZWNoYW5nZSh2YWx1ZSkgewogICAgICAgICAgICAgICAgdGhpc1t4aHJPblJlYWR5U3RhdGVDaGFuZ2VTeW1ib2xdID0gdmFsdWU7CiAgICAgICAgICAgIH0KICAgICAgICAgICAgZ2V0IHJlYWR5U3RhdGUoKSB7CiAgICAgICAgICAgICAgICByZXR1cm4gdGhpc1t4aHJSZWFkeVN0YXRlU3ltYm9sXTsKICAgICAgICAgICAgfQogICAgICAgICAgICBvcGVuKG1ldGhvZCwgdXJsKSB7CiAgICAgICAgICAgICAgICBzd2l0Y2ggKHRoaXNbeGhyUmVhZHlTdGF0ZVN5bWJvbF0pIHsKICAgICAgICAgICAgICAgIGNhc2UgeGhyVW5zZW50OgogICAgICAgICAgICAgICAgY2FzZSB4aHJEb25lOiB7CiAgICAgICAgICAgICAgICAgICAgICAgIGNoYW5nZVJlYWR5U3RhdGUodGhpcywgeGhyT3BlbmVkKTsKICAgICAgICAgICAgICAgICAgICAgICAgYnJlYWs7CiAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgfQogICAgICAgICAgICB9CiAgICAgICAgICAgIHNldFJlcXVlc3RIZWFkZXIobmFtZSwgdmFsdWUpIHsKICAgICAgICAgICAgfQogICAgICAgICAgICBzZXRUcnVzdFRva2VuKHRydXN0VG9rZW4pIHsKICAgICAgICAgICAgfQogICAgICAgICAgICBnZXQgdGltZW91dCgpIHsKICAgICAgICAgICAgICAgIHJldHVybiB0aGlzW3hoclRpbWVvdXRTeW1ib2xdOwogICAgICAgICAgICB9CiAgICAgICAgICAgIHNldCB0aW1lb3V0KHZhbHVlKSB7CiAgICAgICAgICAgICAgICB0aGlzW3hoclRpbWVvdXRTeW1ib2xdID0gdmFsdWU7CiAgICAgICAgICAgIH0KICAgICAgICAgICAgZ2V0IHdpdGhDcmVkZW50aWFscygpIHsKICAgICAgICAgICAgICAgIHJldHVybiB0aGlzW3hocldpdGhDcmVkZW50aWFsc1N5bWJvbF07CiAgICAgICAgICAgIH0KICAgICAgICAgICAgc2V0IHdpdGhDcmVkZW50aWFscyh2YWx1ZSkgewogICAgICAgICAgICAgICAgc3dpdGNoICh0aGlzW3hoclJlYWR5U3RhdGVTeW1ib2xdKSB7CiAgICAgICAgICAgICAgICBjYXNlIHhoclVuc2VudDoKICAgICAgICAgICAgICAgIGNhc2UgeGhyT3BlbmVkOiB7CiAgICAgICAgICAgICAgICAgICAgICAgIGJyZWFrOwogICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgIGRlZmF1bHQ6IHsKICAgICAgICAgICAgICAgICAgICAgICAgdGhyb3cgbmV3IERPTUV4Y2VwdGlvbignRmFpbGVkIHRvIHNldCB0aGUgXCd3aXRoQ3JlZGVudGlhbHNcJyBwcm9wZXJ0eSBvbiBcJ1hNTEh0dHBSZXF1ZXN0XCc6IFRoZSB2YWx1ZSBtYXkgb25seSBiZSBzZXQgaWYgdGhlIG9iamVjdFwncyBzdGF0ZSBpcyBVTlNFTlQgb3IgT1BFTkVELicpOwogICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgIHRoaXNbeGhyV2l0aENyZWRlbnRpYWxzU3ltYm9sXSA9ICEhdmFsdWU7CiAgICAgICAgICAgIH0KICAgICAgICAgICAgZ2V0IHVwbG9hZCgpIHsKICAgICAgICAgICAgICAgIHJldHVybiB0aGlzW3hoclVwbG9hZFN5bWJvbF07CiAgICAgICAgICAgIH0KICAgICAgICAgICAgc2VuZCgpIHsKICAgICAgICAgICAgICAgIGlmICh0aGlzW3hoclJlYWR5U3RhdGVTeW1ib2xdID09PSB4aHJPcGVuZWQgJiYgdGhpc1t4aHJEZWZlcnJlZEhhbmRsZVN5bWJvbF0gPT09IG51bGwpIHsKICAgICAgICAgICAgICAgICAgICB0aGlzW3hockRlZmVycmVkSGFuZGxlU3ltYm9sXSA9IHNldFRpbWVvdXQoKCkgPT4gewogICAgICAgICAgICAgICAgICAgICAgICB0aGlzW3hockRlZmVycmVkSGFuZGxlU3ltYm9sXSA9IG51bGw7CiAgICAgICAgICAgICAgICAgICAgICAgIGNoYW5nZVJlYWR5U3RhdGUodGhpcywgeGhyRG9uZSk7CiAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMuZGlzcGF0Y2hFdmVudChuZXcgUHJvZ3Jlc3NFdmVudCgnZXJyb3InKSk7CiAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMuZGlzcGF0Y2hFdmVudChuZXcgUHJvZ3Jlc3NFdmVudCgnbG9hZGVuZCcpKTsKICAgICAgICAgICAgICAgICAgICB9LCAwKTsKICAgICAgICAgICAgICAgIH0gZWxzZSB7CiAgICAgICAgICAgICAgICAgICAgdGhyb3cgbmV3IERPTUV4Y2VwdGlvbignRmFpbGVkIHRvIGV4ZWN1dGUgXCdzZW5kXCcgb24gXCdYTUxIdHRwUmVxdWVzdFwnOiBUaGUgb2JqZWN0XCdzIHN0YXRlIG11c3QgYmUgT1BFTkVELicpOwogICAgICAgICAgICAgICAgfQogICAgICAgICAgICB9CiAgICAgICAgICAgIGFib3J0KCkgewogICAgICAgICAgICAgICAgaWYgKHRoaXNbeGhyUmVhZHlTdGF0ZVN5bWJvbF0gPT09IHhock9wZW5lZCAmJiB0aGlzW3hockRlZmVycmVkSGFuZGxlU3ltYm9sXSAhPT0gbnVsbCkgewogICAgICAgICAgICAgICAgICAgIGNsZWFyVGltZW91dCh0aGlzW3hockRlZmVycmVkSGFuZGxlU3ltYm9sXSk7CiAgICAgICAgICAgICAgICAgICAgdGhpc1t4aHJEZWZlcnJlZEhhbmRsZVN5bWJvbF0gPSBudWxsOwogICAgICAgICAgICAgICAgICAgIGNoYW5nZVJlYWR5U3RhdGUodGhpcywgeGhyVW5zZW50KTsKICAgICAgICAgICAgICAgICAgICB0aGlzLmRpc3BhdGNoRXZlbnQobmV3IFByb2dyZXNzRXZlbnQoJ2Fib3J0JykpOwogICAgICAgICAgICAgICAgICAgIHRoaXMuZGlzcGF0Y2hFdmVudChuZXcgUHJvZ3Jlc3NFdmVudCgnbG9hZGVuZCcpKTsKICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgfQogICAgICAgICAgICBnZXQgcmVzcG9uc2VVUkwoKSB7CiAgICAgICAgICAgICAgICByZXR1cm4gJyc7CiAgICAgICAgICAgIH0KICAgICAgICAgICAgZ2V0IHN0YXR1cygpIHsKICAgICAgICAgICAgICAgIHJldHVybiAwOwogICAgICAgICAgICB9CiAgICAgICAgICAgIGdldCBzdGF0dXNUZXh0KCkgewogICAgICAgICAgICAgICAgcmV0dXJuICcnOwogICAgICAgICAgICB9CiAgICAgICAgICAgIGdldFJlc3BvbnNlSGVhZGVyKG5hbWUpIHsKICAgICAgICAgICAgICAgIHJldHVybiBudWxsOwogICAgICAgICAgICB9CiAgICAgICAgICAgIG92ZXJyaWRlTWltZVR5cGUobWltZSkgewogICAgICAgICAgICB9CiAgICAgICAgICAgIGdldCByZXNwb25zZVR5cGUoKSB7CiAgICAgICAgICAgICAgICByZXR1cm4gdGhpc1t4aHJSZXNwb25zZVR5cGVTeW1ib2xdOwogICAgICAgICAgICB9CiAgICAgICAgICAgIHNldCByZXNwb25zZVR5cGUodmFsdWUpIHsKICAgICAgICAgICAgICAgIHN3aXRjaCAodGhpc1t4aHJSZWFkeVN0YXRlU3ltYm9sXSkgewogICAgICAgICAgICAgICAgY2FzZSB4aHJEb25lOiB7CiAgICAgICAgICAgICAgICAgICAgICAgIHRocm93IG5ldyBET01FeGNlcHRpb24oJ0ZhaWxlZCB0byBzZXQgdGhlIFwncmVzcG9uc2VUeXBlXCcgcHJvcGVydHkgb24gXCdYTUxIdHRwUmVxdWVzdFwnOiBUaGUgcmVzcG9uc2UgdHlwZSBjYW5ub3QgYmUgc2V0IGlmIHRoZSBvYmplY3RcJ3Mgc3RhdGUgaXMgTE9BRElORyBvciBET05FLicpOwogICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgIHN3aXRjaCAodmFsdWUpIHsKICAgICAgICAgICAgICAgIGNhc2UgJyc6CiAgICAgICAgICAgICAgICBjYXNlICdhcnJheWJ1ZmZlcic6CiAgICAgICAgICAgICAgICBjYXNlICdibG9iJzoKICAgICAgICAgICAgICAgIGNhc2UgJ2RvY3VtZW50JzoKICAgICAgICAgICAgICAgIGNhc2UgJ2pzb24nOgogICAgICAgICAgICAgICAgY2FzZSAndGV4dCc6IHsKICAgICAgICAgICAgICAgICAgICAgICAgdGhpc1t4aHJSZXNwb25zZVR5cGVTeW1ib2xdID0gdmFsdWU7CiAgICAgICAgICAgICAgICAgICAgICAgIGJyZWFrOwogICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgfQogICAgICAgICAgICBnZXQgcmVzcG9uc2UoKSB7CiAgICAgICAgICAgICAgICBjb25zdCByZXNwb25zZVR5cGUgPSB0aGlzW3hoclJlc3BvbnNlVHlwZVN5bWJvbF07CiAgICAgICAgICAgICAgICByZXR1cm4gcmVzcG9uc2VUeXBlID09PSAnJyB8fCByZXNwb25zZVR5cGUgPT09ICd0ZXh0JyA/ICcnIDogbnVsbDsKICAgICAgICAgICAgfQogICAgICAgICAgICBnZXQgcmVzcG9uc2VUZXh0KCkgewogICAgICAgICAgICAgICAgY29uc3QgcmVzcG9uc2VUeXBlID0gdGhpc1t4aHJSZXNwb25zZVR5cGVTeW1ib2xdOwogICAgICAgICAgICAgICAgaWYgKHJlc3BvbnNlVHlwZSA9PT0gJycgfHwgcmVzcG9uc2VUeXBlID09PSAndGV4dCcpIHsKICAgICAgICAgICAgICAgICAgICByZXR1cm4gJyc7CiAgICAgICAgICAgICAgICB9IGVsc2UgewogICAgICAgICAgICAgICAgICAgIHRocm93IG5ldyBET01FeGNlcHRpb24oJ0ZhaWxlZCB0byByZWFkIHRoZSBcJ3Jlc3BvbnNlVGV4dFwnIHByb3BlcnR5IGZyb20gXCdYTUxIdHRwUmVxdWVzdFwnOiBUaGUgdmFsdWUgaXMgb25seSBhY2Nlc3NpYmxlIGlmIHRoZSBvYmplY3RcJ3MgXCdyZXNwb25zZVR5cGVcJyBpcyBcJ1wnIG9yIFwndGV4dFwnICh3YXMgXCdhcnJheWJ1ZmZlclwnKS4nKTsKICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgfQogICAgICAgICAgICBnZXQgcmVzcG9uc2VYTUwoKSB7CiAgICAgICAgICAgICAgICByZXR1cm4gbnVsbDsKICAgICAgICAgICAgfQogICAgICAgIH0KICAgICAgICBPYmplY3QuZGVmaW5lUHJvcGVydHkoWE1MSHR0cFJlcXVlc3QsICdVTlNFTlQnLCB7CiAgICAgICAgICAgIGNvbmZpZ3VyYWJsZTogZmFsc2UsCiAgICAgICAgICAgIGVudW1lcmFibGU6IHRydWUsCiAgICAgICAgICAgIHZhbHVlOiB4aHJVbnNlbnQKICAgICAgICB9KTsKICAgICAgICBPYmplY3QuZGVmaW5lUHJvcGVydHkoWE1MSHR0cFJlcXVlc3QsICdPUEVORUQnLCB7CiAgICAgICAgICAgIGNvbmZpZ3VyYWJsZTogZmFsc2UsCiAgICAgICAgICAgIGVudW1lcmFibGU6IHRydWUsCiAgICAgICAgICAgIHZhbHVlOiB4aHJPcGVuZWQKICAgICAgICB9KTsKICAgICAgICBPYmplY3QuZGVmaW5lUHJvcGVydHkoWE1MSHR0cFJlcXVlc3QsICdIRUFERVJTX1JFQ0VJVkVEJywgewogICAgICAgICAgICBjb25maWd1cmFibGU6IGZhbHNlLAogICAgICAgICAgICBlbnVtZXJhYmxlOiB0cnVlLAogICAgICAgICAgICB2YWx1ZTogeGhySGVhZGVyc1JlY2VpdmVkCiAgICAgICAgfSk7CiAgICAgICAgT2JqZWN0LmRlZmluZVByb3BlcnR5KFhNTEh0dHBSZXF1ZXN0LCAnTE9BRElORycsIHsKICAgICAgICAgICAgY29uZmlndXJhYmxlOiBmYWxzZSwKICAgICAgICAgICAgZW51bWVyYWJsZTogdHJ1ZSwKICAgICAgICAgICAgdmFsdWU6IHhockxvYWRpbmcKICAgICAgICB9KTsKICAgICAgICBPYmplY3QuZGVmaW5lUHJvcGVydHkoWE1MSHR0cFJlcXVlc3QsICdET05FJywgewogICAgICAgICAgICBjb25maWd1cmFibGU6IGZhbHNlLAogICAgICAgICAgICBlbnVtZXJhYmxlOiB0cnVlLAogICAgICAgICAgICB2YWx1ZTogeGhyRG9uZQogICAgICAgIH0pOwogICAgICAgIGV4cG9ydHMuWE1MSHR0cFJlcXVlc3QgPSB7CiAgICAgICAgICAgIGNvbmZpZ3VyYWJsZTogdHJ1ZSwKICAgICAgICAgICAgZW51bWVyYWJsZTogdHJ1ZSwKICAgICAgICAgICAgdmFsdWU6IFhNTEh0dHBSZXF1ZXN0LAogICAgICAgICAgICB3cml0YWJsZTogdHJ1ZQogICAgICAgIH07CiAgICB9KSgkX19fbW9ja18zZTFmMjU5YzdjNzAyZWNlKTsKICAgIGNvbnN0ICRfX19tb2NrX2EyMGE1MDliNGU3NmNhMWQgPSB7fTsKICAgIChleHBvcnRzID0+IHsKICAgICAgICAndXNlIHN0cmljdCc7CiAgICAgICAgbGV0IGlzU2VhbGVkID0gZmFsc2U7CiAgICAgICAgY2xhc3MgU3RvcmFnZSB7CiAgICAgICAgICAgIGNvbnN0cnVjdG9yKCkgewogICAgICAgICAgICAgICAgaWYgKGlzU2VhbGVkKSB7CiAgICAgICAgICAgICAgICAgICAgdGhyb3cgbmV3IFR5cGVFcnJvcignSWxsZWdhbCBjb25zdHJ1Y3RvcicpOwogICAgICAgICAgICAgICAgfQogICAgICAgICAgICB9CiAgICAgICAgICAgIGdldCBsZW5ndGgoKSB7CiAgICAgICAgICAgICAgICByZXR1cm4gT2JqZWN0LmtleXModGhpcykubGVuZ3RoOwogICAgICAgICAgICB9CiAgICAgICAgICAgIGtleShpbmRleCkgewogICAgICAgICAgICAgICAgY29uc3Qga2V5cyA9IE9iamVjdC5rZXlzKHRoaXMpOwogICAgICAgICAgICAgICAgaWYgKGluZGV4IDwgMCB8fCBpbmRleCA+PSBrZXlzLmxlbmd0aCkgewogICAgICAgICAgICAgICAgICAgIHJldHVybiBudWxsOwogICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgcmV0dXJuIGtleXNbaW5kZXhdOwogICAgICAgICAgICB9CiAgICAgICAgICAgIGdldEl0ZW0oa2V5KSB7CiAgICAgICAgICAgICAgICByZXR1cm4gT2JqZWN0LnByb3RvdHlwZS5oYXNPd25Qcm9wZXJ0eS5jYWxsKHRoaXMsIGtleSkgPyB0aGlzW2tleV0gOiBudWxsOwogICAgICAgICAgICB9CiAgICAgICAgICAgIHNldEl0ZW0oa2V5LCB2YWx1ZSkgewogICAgICAgICAgICAgICAgdGhpc1trZXldID0gU3RyaW5nKHZhbHVlKTsKICAgICAgICAgICAgfQogICAgICAgICAgICByZW1vdmVJdGVtKGtleSkgewogICAgICAgICAgICAgICAgZGVsZXRlIHRoaXNba2V5XTsKICAgICAgICAgICAgfQogICAgICAgICAgICBjbGVhcigpIHsKICAgICAgICAgICAgICAgIGNvbnN0IGtleXMgPSBPYmplY3Qua2V5cyh0aGlzKTsKICAgICAgICAgICAgICAgIGZvciAoY29uc3Qga2V5IG9mIGtleXMpIHsKICAgICAgICAgICAgICAgICAgICBkZWxldGUgdGhpc1trZXldOwogICAgICAgICAgICAgICAgfQogICAgICAgICAgICB9CiAgICAgICAgfQogICAgICAgIGV4cG9ydHMuU3RvcmFnZSA9IHsKICAgICAgICAgICAgY29uZmlndXJhYmxlOiB0cnVlLAogICAgICAgICAgICBlbnVtZXJhYmxlOiB0cnVlLAogICAgICAgICAgICB2YWx1ZTogU3RvcmFnZSwKICAgICAgICAgICAgd3JpdGFibGU6IHRydWUKICAgICAgICB9OwogICAgICAgIGNvbnN0IGxvY2FsU3RvcmFnZSA9IG5ldyBTdG9yYWdlKCk7CiAgICAgICAgZXhwb3J0cy5sb2NhbFN0b3JhZ2UgPSB7CiAgICAgICAgICAgIGNvbmZpZ3VyYWJsZTogdHJ1ZSwKICAgICAgICAgICAgZW51bWVyYWJsZTogdHJ1ZSwKICAgICAgICAgICAgZ2V0KCkgewogICAgICAgICAgICAgICAgcmV0dXJuIGxvY2FsU3RvcmFnZTsKICAgICAgICAgICAgfQogICAgICAgIH07CiAgICAgICAgY29uc3Qgc2Vzc2lvblN0b3JhZ2UgPSBuZXcgU3RvcmFnZSgpOwogICAgICAgIGV4cG9ydHMuc2Vzc2lvblN0b3JhZ2UgPSB7CiAgICAgICAgICAgIGNvbmZpZ3VyYWJsZTogdHJ1ZSwKICAgICAgICAgICAgZW51bWVyYWJsZTogdHJ1ZSwKICAgICAgICAgICAgZ2V0KCkgewogICAgICAgICAgICAgICAgcmV0dXJuIHNlc3Npb25TdG9yYWdlOwogICAgICAgICAgICB9CiAgICAgICAgfTsKICAgICAgICBpc1NlYWxlZCA9IHRydWU7CiAgICB9KSgkX19fbW9ja19hMjBhNTA5YjRlNzZjYTFkKTsKICAgIChmdW5jdGlvbiAoKSB7CiAgICAgICAgTWFya2V0aW5nLmJpbmREZXBlbmRlbmN5SW1tZWRpYXRlKGZ1bmN0aW9uICgpIHsKICAgICAgICAgICAgdmFyIEJvb3RzdHJhcHBlciA9IHdpbmRvd1snTWFya2V0aW5nJ107CiAgICAgICAgICAgIHZhciBlbnNpZ2h0ZW5PcHRpb25zID0gTWFya2V0aW5nLmVuc2lnaHRlbk9wdGlvbnM7CiAgICAgICAgICAgIHRyeSB7CiAgICAgICAgICAgICAgICBNYXJrZXRpbmcuVURPLnBlcmZUaW1pbmdTdGFydCgncnVsZUlkLScgKyB0aGlzLmlkICsgJy1kZXBsb3ltZW50SWQtJyArIHRoaXMuZGVwbG95bWVudElkKTsKICAgICAgICAgICAgICAgIGlmIChkZWxsX21hcmtldGluZ191dGlsLmdldFBhcmFtZXRlckJ5TmFtZSgnbWRlYnVnJywgbG9jYXRpb24uc2VhcmNoKSA9PSAndHJ1ZScpIHsKICAgICAgICAgICAgICAgICAgICBkZWxsX21hcmtldGluZ191dGlsLmdldERwaWQgPSBmdW5jdGlvbiAoKSB7CiAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiBuZXcgRGF0ZSgpLmdldFRpbWUoKTsKICAgICAgICAgICAgICAgICAgICB9OwogICAgICAgICAgICAgICAgICAgIE1hcmtldGluZy5nRXZlbnQoJ0RDLTk2MzI2NDUvc2FsZXMwL2NzYl90ZXN0K3RyYW5zYWN0aW9ucycsICdwdXJjaGFzZScpOwogICAgICAgICAgICAgICAgICAgIGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3JBbGwoJ2lmcmFtZScpLmZvckVhY2goZnVuY3Rpb24gKGtleSkgewogICAgICAgICAgICAgICAgICAgICAgICBpZiAoa2V5LnNyYy5pbmNsdWRlcygndHlwZT1zYWxlcycpKQogICAgICAgICAgICAgICAgICAgICAgICAgICAga2V5LmNvbnRlbnRXaW5kb3cucG9zdE1lc3NhZ2UoSlNPTi5zdHJpbmdpZnkoTWFya2V0aW5nKSwgJyonKTsKICAgICAgICAgICAgICAgICAgICB9KTsKICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgIE1hcmtldGluZy5VRE8ucGVyZlRpbWluZ0VuZCgncnVsZUlkLScgKyB0aGlzLmlkICsgJy1kZXBsb3ltZW50SWQtJyArIHRoaXMuZGVwbG95bWVudElkKTsKICAgICAgICAgICAgfSBjYXRjaCAoZSkgewogICAgICAgICAgICAgICAgZGVsbF9tYXJrZXRpbmdfdXRpbC5kZWJ1ZyhlKTsKICAgICAgICAgICAgfQogICAgICAgIH0sIDM2MDAzMTEsIFszNjE3NjgyXSwgNjM2MTQyLCBbNjE5NDA0XSk7CiAgICAgICAgTWFya2V0aW5nLmJpbmREZXBlbmRlbmN5RE9NUGFyc2VkKGZ1bmN0aW9uICgpIHsKICAgICAgICAgICAgdmFyIEJvb3RzdHJhcHBlciA9IHdpbmRvd1snTWFya2V0aW5nJ107CiAgICAgICAgICAgIHZhciBlbnNpZ2h0ZW5PcHRpb25zID0gTWFya2V0aW5nLmVuc2lnaHRlbk9wdGlvbnM7CiAgICAgICAgICAgIHRyeSB7CiAgICAgICAgICAgICAgICBNYXJrZXRpbmcuVURPLnBlcmZUaW1pbmdTdGFydCgncnVsZUlkLScgKyB0aGlzLmlkICsgJy1kZXBsb3ltZW50SWQtJyArIHRoaXMuZGVwbG95bWVudElkKTsKICAgICAgICAgICAgICAgIChmdW5jdGlvbiAodywgZCwgdCwgciwgdSkgewogICAgICAgICAgICAgICAgICAgIHZhciBmLCBuLCBpOwogICAgICAgICAgICAgICAgICAgIHdbdV0gPSB3W3VdIHx8IFtdLCBmID0gZnVuY3Rpb24gKCkgewogICAgICAgICAgICAgICAgICAgICAgICBjb25zdCAkX19fb2xkXzg3MjJhNDNlZjQxNDI2OTQgPSB7fS5jb25zdHJ1Y3Rvci5nZXRPd25Qcm9wZXJ0eURlc2NyaXB0b3Iod2luZG93LCAnWE1MSHR0cFJlcXVlc3QnKSwgJF9fX29sZF9iNTI1ODcwYTA4YTlmZDk3ID0ge30uY29uc3RydWN0b3IuZ2V0T3duUHJvcGVydHlEZXNjcmlwdG9yKHdpbmRvdywgJ2xvY2FsU3RvcmFnZScpOwogICAgICAgICAgICAgICAgICAgICAgICB0cnkgewogICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKCRfX19vbGRfODcyMmE0M2VmNDE0MjY5NCkKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAoe30uY29uc3RydWN0b3IuZGVmaW5lUHJvcGVydHkod2luZG93LCAnWE1MSHR0cFJlcXVlc3QnLCAkX19fbW9ja18zZTFmMjU5YzdjNzAyZWNlLlhNTEh0dHBSZXF1ZXN0KSk7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAoJF9fX29sZF9iNTI1ODcwYTA4YTlmZDk3KQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICh7fS5jb25zdHJ1Y3Rvci5kZWZpbmVQcm9wZXJ0eSh3aW5kb3csICdsb2NhbFN0b3JhZ2UnLCAkX19fbW9ja19hMjBhNTA5YjRlNzZjYTFkLmxvY2FsU3RvcmFnZSkpOwogICAgICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIGZ1bmN0aW9uICgpIHsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB2YXIgbyA9IHsgdGk6ICc1MTAyMjYxJyB9OwogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIG8ucSA9IHdbdV0sIHdbdV0gPSBuZXcgVUVUKG8pLCB3W3VdLnB1c2goJ3BhZ2VMb2FkJyk7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9LmFwcGx5KHRoaXMsIGFyZ3VtZW50cyk7CiAgICAgICAgICAgICAgICAgICAgICAgIH0gZmluYWxseSB7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAoJF9fX29sZF84NzIyYTQzZWY0MTQyNjk0KQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICh7fS5jb25zdHJ1Y3Rvci5kZWZpbmVQcm9wZXJ0eSh3aW5kb3csICdYTUxIdHRwUmVxdWVzdCcsICRfX19vbGRfODcyMmE0M2VmNDE0MjY5NCkpOwogICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKCRfX19vbGRfYjUyNTg3MGEwOGE5ZmQ5NykKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAoe30uY29uc3RydWN0b3IuZGVmaW5lUHJvcGVydHkod2luZG93LCAnbG9jYWxTdG9yYWdlJywgJF9fX29sZF9iNTI1ODcwYTA4YTlmZDk3KSk7CiAgICAgICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgICAgICB9LCBuID0gZC5jcmVhdGVFbGVtZW50KHQpLCBuLnNyYyA9IHIsIG4uYXN5bmMgPSAxLCBuLm9ubG9hZCA9IG4ub25yZWFkeXN0YXRlY2hhbmdlID0gZnVuY3Rpb24gKCkgewogICAgICAgICAgICAgICAgICAgICAgICB2YXIgcyA9IHRoaXMucmVhZHlTdGF0ZTsKICAgICAgICAgICAgICAgICAgICAgICAgcyAmJiBzICE9PSAnbG9hZGVkJyAmJiBzICE9PSAnY29tcGxldGUnIHx8IChmKCksIG4ub25sb2FkID0gbi5vbnJlYWR5c3RhdGVjaGFuZ2UgPSBudWxsKTsKICAgICAgICAgICAgICAgICAgICB9LCBpID0gZC5nZXRFbGVtZW50c0J5VGFnTmFtZSh0KVswXSwgaS5wYXJlbnROb2RlLmluc2VydEJlZm9yZShuLCBpKTsKICAgICAgICAgICAgICAgIH0od2luZG93LCBkb2N1bWVudCwgJ3NjcmlwdCcsICcvL2JhdC5iaW5nLmNvbS9iYXQuanMnLCAndWV0cScpKTsKICAgICAgICAgICAgICAgIE1hcmtldGluZy5VRE8ucGVyZlRpbWluZ0VuZCgncnVsZUlkLScgKyB0aGlzLmlkICsgJy1kZXBsb3ltZW50SWQtJyArIHRoaXMuZGVwbG95bWVudElkKTsKICAgICAgICAgICAgfSBjYXRjaCAoZSkgewogICAgICAgICAgICAgICAgZGVsbF9tYXJrZXRpbmdfdXRpbC5kZWJ1ZyhlKTsKICAgICAgICAgICAgfQogICAgICAgIH0sIDM2MDUyNDIsIFszNjA2MzI5XSwgNjk1ODc0LCBbNjEwMzIzXSk7CiAgICAgICAgTWFya2V0aW5nLmJpbmREZXBlbmRlbmN5RE9NUGFyc2VkKGZ1bmN0aW9uICgpIHsKICAgICAgICAgICAgdmFyIEJvb3RzdHJhcHBlciA9IHdpbmRvd1snTWFya2V0aW5nJ107CiAgICAgICAgICAgIHZhciBlbnNpZ2h0ZW5PcHRpb25zID0gTWFya2V0aW5nLmVuc2lnaHRlbk9wdGlvbnM7CiAgICAgICAgICAgIHRyeSB7CiAgICAgICAgICAgICAgICBNYXJrZXRpbmcuVURPLnBlcmZUaW1pbmdTdGFydCgncnVsZUlkLScgKyB0aGlzLmlkICsgJy1kZXBsb3ltZW50SWQtJyArIHRoaXMuZGVwbG95bWVudElkKTsKICAgICAgICAgICAgICAgIGlmIChNYXJrZXRpbmcuVURPLnByaW9yY29uc2VudCkgewogICAgICAgICAgICAgICAgICAgIHZhciBjID0gTWFya2V0aW5nLnNjRGF0YU9iai5jb3VudHJ5OwogICAgICAgICAgICAgICAgICAgIGlmIChjID09PSAndXMnKQogICAgICAgICAgICAgICAgICAgICAgICBNYXJrZXRpbmcuaW5zZXJ0U2NyaXB0KCcvL3Z0Lm15dmlzdWFsaXEubmV0LzIvVHhVUU5IU0t2R1dJaU1qMU9oM3RmdyUzRCUzRC92dC0yODguanMnKTsKICAgICAgICAgICAgICAgICAgICBpZiAoYyA9PT0gJ2NhJykKICAgICAgICAgICAgICAgICAgICAgICAgTWFya2V0aW5nLmluc2VydFNjcmlwdCgnLy92dC5teXZpc3VhbGlxLm5ldC8yL1R4VVFOSFNLdkdXSWlNajFPaDN0ZnclM0QlM0QvdnQtMjg5LmpzJyk7CiAgICAgICAgICAgICAgICAgICAgaWYgKGMgPT09ICdicicpCiAgICAgICAgICAgICAgICAgICAgICAgIE1hcmtldGluZy5pbnNlcnRTY3JpcHQoJy8vdnQubXl2aXN1YWxpcS5uZXQvMi93UVF0VGlpemw0U2l4cmhJVHlUcWJnJTNEJTNEL3Z0LTI4Ni5qcycpOwogICAgICAgICAgICAgICAgICAgIGlmIChjID09PSAndWsnKQogICAgICAgICAgICAgICAgICAgICAgICBNYXJrZXRpbmcuaW5zZXJ0U2NyaXB0KCcvL3Z0Lm15dmlzdWFsaXEubmV0LzIvYW1pN2VXRDdNYTlxa3U5SERHMjMydyUzRCUzRC92dC0yMTMuanMnKTsKICAgICAgICAgICAgICAgICAgICBpZiAoYyA9PT0gJ2pwJykKICAgICAgICAgICAgICAgICAgICAgICAgTWFya2V0aW5nLmluc2VydFNjcmlwdCgnLy92dC5teXZpc3VhbGlxLm5ldC8yLzYlMkJ4VCUyQk8zejF6aDE0eXVsSkJETjZnJTNEJTNEL3Z0LTI4Ny5qcycpOwogICAgICAgICAgICAgICAgICAgIGlmIChjID09PSAnYXUnKQogICAgICAgICAgICAgICAgICAgICAgICBNYXJrZXRpbmcuaW5zZXJ0U2NyaXB0KCcvL3Z0Lm15dmlzdWFsaXEubmV0LzIvaXBlZXlIaHQ0bnBRRWl6aUNXYVl6dyUzRCUzRC92dC0yOTkuanMnKTsKICAgICAgICAgICAgICAgICAgICBpZiAoYyA9PT0gJ256JykKICAgICAgICAgICAgICAgICAgICAgICAgTWFya2V0aW5nLmluc2VydFNjcmlwdCgnLy92dC5teXZpc3VhbGlxLm5ldC8yL2lwZWV5SGh0NG5wUUVpemlDV2FZenclM0QlM0QvdnQtMzAxLmpzJyk7CiAgICAgICAgICAgICAgICAgICAgaWYgKGMgPT09ICdpbicpCiAgICAgICAgICAgICAgICAgICAgICAgIE1hcmtldGluZy5pbnNlcnRTY3JpcHQoJy8vdnQubXl2aXN1YWxpcS5uZXQvMi91QkYlMkJuZEpUN24wcjlXeXNOSTFWd3clM0QlM0QvdnQtMjk4LmpzJyk7CiAgICAgICAgICAgICAgICAgICAgaWYgKGMgPT09ICdmcicpCiAgICAgICAgICAgICAgICAgICAgICAgIE1hcmtldGluZy5pbnNlcnRTY3JpcHQoJy8vdnQubXl2aXN1YWxpcS5uZXQvMi9HWE9kTiUyQld1Z1kzTjNuNGE1TEFrTlElM0QlM0QvdnQtMzAwLmpzJyk7CiAgICAgICAgICAgICAgICAgICAgaWYgKGMgPT09ICdkZScpCiAgICAgICAgICAgICAgICAgICAgICAgIE1hcmtldGluZy5pbnNlcnRTY3JpcHQoJy8vdnQubXl2aXN1YWxpcS5uZXQvMi92OUJKT0djZ2w0d2ZqbjdwWEJodW5BJTNEJTNEL3Z0LTMwMi5qcycpOwogICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgTWFya2V0aW5nLlVETy5wZXJmVGltaW5nRW5kKCdydWxlSWQtJyArIHRoaXMuaWQgKyAnLWRlcGxveW1lbnRJZC0nICsgdGhpcy5kZXBsb3ltZW50SWQpOwogICAgICAgICAgICB9IGNhdGNoIChlKSB7CiAgICAgICAgICAgICAgICBkZWxsX21hcmtldGluZ191dGlsLmRlYnVnKGUpOwogICAgICAgICAgICB9CiAgICAgICAgfSwgMzU5MzM2NSwgWwogICAgICAgICAgICAzNTA2OTI0LAogICAgICAgICAgICAzNjA2MzI5CiAgICAgICAgXSwgNjIxOTE5LCBbCiAgICAgICAgICAgIDYxMDMxMCwKICAgICAgICAgICAgNjEwMzIzCiAgICAgICAgXSk7CiAgICAgICAgTWFya2V0aW5nLmJpbmRET01QYXJzZWQoZnVuY3Rpb24gKCkgewogICAgICAgICAgICB2YXIgQm9vdHN0cmFwcGVyID0gd2luZG93WydNYXJrZXRpbmcnXTsKICAgICAgICAgICAgdmFyIGVuc2lnaHRlbk9wdGlvbnMgPSBNYXJrZXRpbmcuZW5zaWdodGVuT3B0aW9uczsKICAgICAgICAgICAgdHJ5IHsKICAgICAgICAgICAgICAgIE1hcmtldGluZy5VRE8ucGVyZlRpbWluZ1N0YXJ0KCdydWxlSWQtJyArIHRoaXMuaWQgKyAnLWRlcGxveW1lbnRJZC0nICsgdGhpcy5kZXBsb3ltZW50SWQpOwogICAgICAgICAgICAgICAgaWYgKE1hcmtldGluZy5VRE8ucHJpb3Jjb25zZW50KQogICAgICAgICAgICAgICAgICAgIE1hcmtldGluZy5pbWFnZVJlcXVlc3QoJ2h0dHBzOi8vcHguYWRzLmxpbmtlZGluLmNvbS9jb2xsZWN0Lz9waWQ9NzUxMyZmbXQ9Z2lmJyk7CiAgICAgICAgICAgICAgICBNYXJrZXRpbmcuVURPLnBlcmZUaW1pbmdFbmQoJ3J1bGVJZC0nICsgdGhpcy5pZCArICctZGVwbG95bWVudElkLScgKyB0aGlzLmRlcGxveW1lbnRJZCk7CiAgICAgICAgICAgIH0gY2F0Y2ggKGUpIHsKICAgICAgICAgICAgICAgIGRlbGxfbWFya2V0aW5nX3V0aWwuZGVidWcoZSk7CiAgICAgICAgICAgIH0KICAgICAgICB9LCAzNTkzMjg3LCA2MTkwODkpOwogICAgICAgIE1hcmtldGluZy5iaW5kRGVwZW5kZW5jeUltbWVkaWF0ZShmdW5jdGlvbiAoKSB7CiAgICAgICAgICAgIHZhciBCb290c3RyYXBwZXIgPSB3aW5kb3dbJ01hcmtldGluZyddOwogICAgICAgICAgICB2YXIgZW5zaWdodGVuT3B0aW9ucyA9IE1hcmtldGluZy5lbnNpZ2h0ZW5PcHRpb25zOwogICAgICAgICAgICBNYXJrZXRpbmcuVURPLmZsX2xvYWRlZCA9IGZhbHNlOwogICAgICAgICAgICBpZiAoTWFya2V0aW5nLlVETy5wcmlvcmNvbnNlbnQpIHsKICAgICAgICAgICAgICAgIE1hcmtldGluZy5sb2FkU2NyaXB0Q2FsbGJhY2soJ2h0dHBzOi8vd3d3Lmdvb2dsZXRhZ21hbmFnZXIuY29tL2d0YWcvanM/aWQ9REMtOTYzMjY0NScsIGZ1bmN0aW9uICgpIHsKICAgICAgICAgICAgICAgICAgICBkZWxsX21hcmtldGluZ191dGlsLmN1c3RvbV9tYXJrZXRpbmdfZXZlbnQoJ2ZsX2xvYWRlZCcpOwogICAgICAgICAgICAgICAgICAgIE1hcmtldGluZy5VRE8uZmxfbG9hZGVkID0gdHJ1ZTsKICAgICAgICAgICAgICAgIH0pOwogICAgICAgICAgICAgICAgd2luZG93LmRhdGFMYXllciA9IHdpbmRvdy5kYXRhTGF5ZXIgfHwgW107CiAgICAgICAgICAgICAgICB3aW5kb3cuZ3RhZyA9IGZ1bmN0aW9uICgpIHsKICAgICAgICAgICAgICAgICAgICBkYXRhTGF5ZXIucHVzaChhcmd1bWVudHMpOwogICAgICAgICAgICAgICAgfTsKICAgICAgICAgICAgICAgIGd0YWcoJ2pzJywgbmV3IERhdGUoKSk7CiAgICAgICAgICAgICAgICBndGFnKCdjb25maWcnLCAnREMtOTYzMjY0NScpOwogICAgICAgICAgICAgICAgZ3RhZygnY29uZmlnJywgJ0RDLTk2MzI5MjEnKTsKICAgICAgICAgICAgICAgIGd0YWcoJ2NvbmZpZycsICdEQy05NjMyNjQ4Jyk7CiAgICAgICAgICAgICAgICB2YXIgY2Zsdl9tYXN0ZXJfc2V0dXAgPSBmdW5jdGlvbiAoKSB7CiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIHsKICAgICAgICAgICAgICAgICAgICAgICAgYWxsb3dfY3VzdG9tX3NjcmlwdHM6IHRydWUsCiAgICAgICAgICAgICAgICAgICAgICAgIHUxOiBNYXJrZXRpbmcuVURPLmxhbmd1YWdlLAogICAgICAgICAgICAgICAgICAgICAgICB1MTA6IE1hcmtldGluZy5VRE8uY3NlZywKICAgICAgICAgICAgICAgICAgICAgICAgdTExOiBNYXJrZXRpbmcuVURPLmRlYWxzLAogICAgICAgICAgICAgICAgICAgICAgICB1MTI6IE1hcmtldGluZy5VRE8uZGV2aWNlLAogICAgICAgICAgICAgICAgICAgICAgICB1MTM6IE1hcmtldGluZy5VRE8uZGlzY291bnQsCiAgICAgICAgICAgICAgICAgICAgICAgIHUxNDogTWFya2V0aW5nLlVETy5mYW1pbHksCiAgICAgICAgICAgICAgICAgICAgICAgIHUxNTogTWFya2V0aW5nLlVETy5vZ2lkLAogICAgICAgICAgICAgICAgICAgICAgICB1MTY6IE1hcmtldGluZy5VRE8ub3JkZXJjb2RlLAogICAgICAgICAgICAgICAgICAgICAgICB1MTc6IE1hcmtldGluZy5VRE8ucGxhdGZvcm0sCiAgICAgICAgICAgICAgICAgICAgICAgIHUxODogTWFya2V0aW5nLlVETy5wcm9kY2F0LAogICAgICAgICAgICAgICAgICAgICAgICB1MTk6IE1hcmtldGluZy5VRE8ucHJvZHVjdCwKICAgICAgICAgICAgICAgICAgICAgICAgdTI6IE1hcmtldGluZy5VRE8uc2VnbWVudCwKICAgICAgICAgICAgICAgICAgICAgICAgdTIwOiBNYXJrZXRpbmcuVURPLnByb21vaWQsCiAgICAgICAgICAgICAgICAgICAgICAgIHUyMTogTWFya2V0aW5nLlVETy50eXBlLAogICAgICAgICAgICAgICAgICAgICAgICB1MjI6IGRlbGxfbWFya2V0aW5nX3V0aWwuZ2V0UGFyYW1ldGVyQnlOYW1lKCdkZ2MnLCBsb2NhdGlvbi50b1N0cmluZygpLnRvTG93ZXJDYXNlKCkpLAogICAgICAgICAgICAgICAgICAgICAgICB1MjM6IE1hcmtldGluZy5VRE8uZ2FjZCwKICAgICAgICAgICAgICAgICAgICAgICAgdTI0OiBkZWxsX21hcmtldGluZ191dGlsLmdldFBhcmFtZXRlckJ5TmFtZSgnbGlkJywgbG9jYXRpb24udG9TdHJpbmcoKS50b0xvd2VyQ2FzZSgpKSwKICAgICAgICAgICAgICAgICAgICAgICAgdTI1OiBNYXJrZXRpbmcuVURPLnZlbjEsCiAgICAgICAgICAgICAgICAgICAgICAgIHUyNjogTWFya2V0aW5nLlVETy52ZW4yLAogICAgICAgICAgICAgICAgICAgICAgICB1Mjg6IGRlbGxfbWFya2V0aW5nX3V0aWwuZ2V0UGFyYW1ldGVyQnlOYW1lKCd0ZmNpZCcsIGxvY2F0aW9uLnRvU3RyaW5nKCkudG9Mb3dlckNhc2UoKSksCiAgICAgICAgICAgICAgICAgICAgICAgIHUyOTogTWFya2V0aW5nLlVETy5yZXZlbnVlLAogICAgICAgICAgICAgICAgICAgICAgICB1MzogTWFya2V0aW5nLlVETy5jdXJyZW5jeSwKICAgICAgICAgICAgICAgICAgICAgICAgdTMwOiBNYXJrZXRpbmcuVURPLnVzZHJldiwKICAgICAgICAgICAgICAgICAgICAgICAgdTM1OiBNYXJrZXRpbmcuVURPLmRwaWQsCiAgICAgICAgICAgICAgICAgICAgICAgIHUzNjogTWFya2V0aW5nLlVETy5sYW5kLAogICAgICAgICAgICAgICAgICAgICAgICB1Mzc6IE1hcmtldGluZy5VRE8uc2VyaWFscHJvZGxpc3QsCiAgICAgICAgICAgICAgICAgICAgICAgIHUzODogTWFya2V0aW5nLlVETy5jamV2ZW50LAogICAgICAgICAgICAgICAgICAgICAgICB1NDogTWFya2V0aW5nLlVETy5jb3VudHJ5LAogICAgICAgICAgICAgICAgICAgICAgICB1NTogTWFya2V0aW5nLlVETy5hY2NvdW50aWQsCiAgICAgICAgICAgICAgICAgICAgICAgIHU2OiBNYXJrZXRpbmcuVURPLmNhdGVnb3J5LAogICAgICAgICAgICAgICAgICAgICAgICB1NzogTWFya2V0aW5nLlVETy5jYXRlZ29yeXBhdGgsCiAgICAgICAgICAgICAgICAgICAgICAgIHU4OiBNYXJrZXRpbmcuVURPLmNpZCwKICAgICAgICAgICAgICAgICAgICAgICAgdTk6IE1hcmtldGluZy5VRE8uY291cG9uCiAgICAgICAgICAgICAgICAgICAgfTsKICAgICAgICAgICAgICAgIH07CiAgICAgICAgICAgICAgICBNYXJrZXRpbmcuVURPLnJlYWREYXRhKCk7CiAgICAgICAgICAgICAgICB2YXIgY2Zsdl9tYXN0ZXIgPSBjZmx2X21hc3Rlcl9zZXR1cCgpOwogICAgICAgICAgICAgICAgY2Zsdl9tYXN0ZXJbJ3UzMSddID0gJyc7CiAgICAgICAgICAgICAgICB2YXIgYWRvYmVfbWNtaWQgPSBkZWxsX21hcmtldGluZ191dGlsLmdldENvb2tpZSgnQU1DVl80REQ4MDg2MTUxNUNBQjk5MEE0OTBENDUlNDBBZG9iZU9yZycpOwogICAgICAgICAgICAgICAgaWYgKGFkb2JlX21jbWlkKQogICAgICAgICAgICAgICAgICAgIGNmbHZfbWFzdGVyWyd1MzEnXSA9IGFkb2JlX21jbWlkLnNwbGl0KCdNQ01JRHwnKVsxXS5zcGxpdCgnfCcpWzBdOwogICAgICAgICAgICAgICAgTWFya2V0aW5nLmdFdmVudCA9IE1hcmtldGluZy5nRXZlbnQgfHwgZnVuY3Rpb24gKGlkU3RyaW5nLCBldmVudFR5cGUpIHsKICAgICAgICAgICAgICAgICAgICB3aW5kb3cuYWRkRXZlbnRMaXN0ZW5lcignZmxfbG9hZGVkJywgZnVuY3Rpb24gKCkgewogICAgICAgICAgICAgICAgICAgICAgICB2YXIgY2ZsdiA9IGNmbHZfbWFzdGVyOwogICAgICAgICAgICAgICAgICAgICAgICBpZiAoZXZlbnRUeXBlID09PSAncHVyY2hhc2UnKSB7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICBjZmx2Wyd2YWx1ZSddID0gTWFya2V0aW5nLlVETy51c2RyZXYgfHwgTWFya2V0aW5nLlVETy5yZXZlbnVlOwogICAgICAgICAgICAgICAgICAgICAgICAgICAgY2ZsdlsndHJhbnNhY3Rpb25faWQnXSA9IGRlbGxfbWFya2V0aW5nX3V0aWwuZ2V0RHBpZCgpOwogICAgICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICAgICAgICAgIGNmbHZbJ3NlbmRfdG8nXSA9IGlkU3RyaW5nOwogICAgICAgICAgICAgICAgICAgICAgICBndGFnKCdldmVudCcsIGV2ZW50VHlwZSwgY2Zsdik7CiAgICAgICAgICAgICAgICAgICAgfSk7CiAgICAgICAgICAgICAgICAgICAgaWYgKE1hcmtldGluZy5VRE8uZmxfbG9hZGVkKSB7CiAgICAgICAgICAgICAgICAgICAgICAgIGNmbHZfbWFzdGVyID0gY2Zsdl9tYXN0ZXJfc2V0dXAoKTsKICAgICAgICAgICAgICAgICAgICAgICAgdmFyIGNmbHYgPSBjZmx2X21hc3RlcjsKICAgICAgICAgICAgICAgICAgICAgICAgaWYgKGV2ZW50VHlwZSA9PT0gJ3B1cmNoYXNlJykgewogICAgICAgICAgICAgICAgICAgICAgICAgICAgY2ZsdlsndmFsdWUnXSA9IE1hcmtldGluZy5VRE8udXNkcmV2IHx8IE1hcmtldGluZy5VRE8ucmV2ZW51ZTsKICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNmbHZbJ3RyYW5zYWN0aW9uX2lkJ10gPSBkZWxsX21hcmtldGluZ191dGlsLmdldERwaWQoKTsKICAgICAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgICAgICAgICBjZmx2WydzZW5kX3RvJ10gPSBpZFN0cmluZzsKICAgICAgICAgICAgICAgICAgICAgICAgZ3RhZygnZXZlbnQnLCBldmVudFR5cGUsIGNmbHYpOwogICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgIH07CiAgICAgICAgICAgIH0KICAgICAgICB9LCAzNjE3NjgyLCBbMzYwNjMyOV0sIDYxOTQwNCwgWzYxMDMyM10pOwogICAgICAgIE1hcmtldGluZy5iaW5kRGVwZW5kZW5jeUltbWVkaWF0ZShmdW5jdGlvbiAoKSB7CiAgICAgICAgICAgIHZhciBCb290c3RyYXBwZXIgPSB3aW5kb3dbJ01hcmtldGluZyddOwogICAgICAgICAgICB2YXIgZW5zaWdodGVuT3B0aW9ucyA9IE1hcmtldGluZy5lbnNpZ2h0ZW5PcHRpb25zOwogICAgICAgICAgICBNYXJrZXRpbmcuVURPLmdfZG93bmxvYWQgPSBmdW5jdGlvbiAoaWRTdHJpbmcsIGV2ZW50VHlwZSkgewogICAgICAgICAgICAgICAgd2luZG93LmFkZEV2ZW50TGlzdGVuZXIoJ2h2ZScsIGZ1bmN0aW9uIChlKSB7CiAgICAgICAgICAgICAgICAgICAgTWFya2V0aW5nLlVETy5odmVvdmVybGF5ID0gZmFsc2U7CiAgICAgICAgICAgICAgICAgICAgaWYgKGUuZGV0YWlsLnR5cGUgPT09ICdkb3dubG9hZCcpCiAgICAgICAgICAgICAgICAgICAgICAgIE1hcmtldGluZy5nRXZlbnQoaWRTdHJpbmcsIGV2ZW50VHlwZSk7CiAgICAgICAgICAgICAgICB9KTsKICAgICAgICAgICAgICAgIGlmIChNYXJrZXRpbmcuVURPLmh2ZW92ZXJsYXkpCiAgICAgICAgICAgICAgICAgICAgTWFya2V0aW5nLmdFdmVudChpZFN0cmluZywgZXZlbnRUeXBlKTsKICAgICAgICAgICAgfTsKICAgICAgICAgICAgTWFya2V0aW5nLlVETy5nX3NoYXJlID0gZnVuY3Rpb24gKGlkU3RyaW5nLCBldmVudFR5cGUpIHsKICAgICAgICAgICAgICAgIHdpbmRvdy5hZGRFdmVudExpc3RlbmVyKCdodmUnLCBmdW5jdGlvbiAoZSkgewogICAgICAgICAgICAgICAgICAgIGlmIChlLmRldGFpbC50eXBlID09PSAnc2hhcmUnKQogICAgICAgICAgICAgICAgICAgICAgICBNYXJrZXRpbmcuZ0V2ZW50KGlkU3RyaW5nLCBldmVudFR5cGUpOwogICAgICAgICAgICAgICAgfSk7CiAgICAgICAgICAgIH07CiAgICAgICAgICAgIE1hcmtldGluZy5VRE8uZ19tcHYgPSBmdW5jdGlvbiAoaWRTdHJpbmcsIGV2ZW50VHlwZSkgewogICAgICAgICAgICAgICAgaWYgKHNlc3Npb25TdG9yYWdlLmVuc3BhZ2Vjb3VudEZMVCA9PSAzKQogICAgICAgICAgICAgICAgICAgIE1hcmtldGluZy5nRXZlbnQoaWRTdHJpbmcsIGV2ZW50VHlwZSk7CiAgICAgICAgICAgIH07CiAgICAgICAgICAgIE1hcmtldGluZy5VRE8uZ19iY19zdGFydCA9IGZ1bmN0aW9uIChpZFN0cmluZywgZXZlbnRUeXBlKSB7CiAgICAgICAgICAgICAgICBpZiAodHlwZW9mIHZpZGVvanMgIT09ICd1bmRlZmluZWQnICYmIHZpZGVvanMucGxheWVycykKICAgICAgICAgICAgICAgICAgICBmb3IgKHZhciB2IGluIHZpZGVvanMucGxheWVycykKICAgICAgICAgICAgICAgICAgICAgICAgdmlkZW9qcy5wbGF5ZXJzW3ZdLnJlYWR5KGZ1bmN0aW9uICgpIHsKICAgICAgICAgICAgICAgICAgICAgICAgICAgIHZhciBteXBsYXllciA9IHRoaXMsIHVzZXJWaWRlbyA9ICFteXBsYXllci5lbF8uaGFzQXR0cmlidXRlKCdtdXRlZCcpOwogICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKHVzZXJWaWRlbykKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBteXBsYXllci5vbignc3RhcnQnLCBmdW5jdGlvbiAoKSB7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmICghbXlwbGF5ZXIudmlkZW9fc3RhcnQpIHsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIG15cGxheWVyLnZpZGVvXzUwX3BlcmNlbnQgPSBmYWxzZTsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIG15cGxheWVyLnZpZGVvXzgwX3BlcmNlbnQgPSBmYWxzZTsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIE1hcmtldGluZy5nRXZlbnQoaWRTdHJpbmcsIGV2ZW50VHlwZSk7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9KTsKICAgICAgICAgICAgICAgICAgICAgICAgfSk7CiAgICAgICAgICAgICAgICBlbHNlCiAgICAgICAgICAgICAgICAgICAgd2luZG93LmFkZEV2ZW50TGlzdGVuZXIoJ2h2ZScsIGZ1bmN0aW9uIF9oYW5kbGVyKGUpIHsKICAgICAgICAgICAgICAgICAgICAgICAgaWYgKGUuZGV0YWlsLnR5cGUgPT09ICdicmlnaHRjb3ZlJykgewogICAgICAgICAgICAgICAgICAgICAgICAgICAgTWFya2V0aW5nLlVETy5nX2JjX3N0YXJ0KGlkU3RyaW5nLCBldmVudFR5cGUpOwogICAgICAgICAgICAgICAgICAgICAgICAgICAgd2luZG93LnJlbW92ZUV2ZW50TGlzdGVuZXIoJ2h2ZScsIF9oYW5kbGVyKTsKICAgICAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgICAgIH0pOwogICAgICAgICAgICB9OwogICAgICAgICAgICBNYXJrZXRpbmcuVURPLmdfYmNfNTAgPSBmdW5jdGlvbiAoaWRTdHJpbmcsIGV2ZW50VHlwZSkgewogICAgICAgICAgICAgICAgd2luZG93LmFkZEV2ZW50TGlzdGVuZXIoJ2JyaWdodGNvdmU1MCcsIGZ1bmN0aW9uIChlKSB7CiAgICAgICAgICAgICAgICAgICAgTWFya2V0aW5nLmdFdmVudChpZFN0cmluZywgZXZlbnRUeXBlKTsKICAgICAgICAgICAgICAgIH0pOwogICAgICAgICAgICB9OwogICAgICAgICAgICBNYXJrZXRpbmcuVURPLmdfYmNfODAgPSBmdW5jdGlvbiAoaWRTdHJpbmcsIGV2ZW50VHlwZSkgewogICAgICAgICAgICAgICAgd2luZG93LmFkZEV2ZW50TGlzdGVuZXIoJ2JyaWdodGNvdmU4MCcsIGZ1bmN0aW9uIChlKSB7CiAgICAgICAgICAgICAgICAgICAgTWFya2V0aW5nLmdFdmVudChpZFN0cmluZywgZXZlbnRUeXBlKTsKICAgICAgICAgICAgICAgIH0pOwogICAgICAgICAgICB9OwogICAgICAgICAgICBNYXJrZXRpbmcuVURPLmdfYmNfZW5kID0gZnVuY3Rpb24gKGlkU3RyaW5nLCBldmVudFR5cGUpIHsKICAgICAgICAgICAgICAgIGlmICh0eXBlb2YgdmlkZW9qcyAhPT0gJ3VuZGVmaW5lZCcgJiYgdmlkZW9qcy5wbGF5ZXJzKQogICAgICAgICAgICAgICAgICAgIGZvciAodmFyIHYgaW4gdmlkZW9qcy5wbGF5ZXJzKQogICAgICAgICAgICAgICAgICAgICAgICB2aWRlb2pzLnBsYXllcnNbdl0ucmVhZHkoZnVuY3Rpb24gKCkgewogICAgICAgICAgICAgICAgICAgICAgICAgICAgdmFyIG15cGxheWVyID0gdGhpcywgdXNlclZpZGVvID0gIW15cGxheWVyLmVsXy5oYXNBdHRyaWJ1dGUoJ211dGVkJyk7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAodXNlclZpZGVvKQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIG15cGxheWVyLm9uKCdlbmRlZCcsIGZ1bmN0aW9uICgpIHsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgTWFya2V0aW5nLmdFdmVudChpZFN0cmluZywgZXZlbnRUeXBlKTsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgbXlwbGF5ZXIudmlkZW9fc3RhcnQgPSBmYWxzZTsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9KTsKICAgICAgICAgICAgICAgICAgICAgICAgfSk7CiAgICAgICAgICAgICAgICBlbHNlCiAgICAgICAgICAgICAgICAgICAgd2luZG93LmFkZEV2ZW50TGlzdGVuZXIoJ2h2ZScsIGZ1bmN0aW9uIF9oYW5kbGVyKGUpIHsKICAgICAgICAgICAgICAgICAgICAgICAgaWYgKGUuZGV0YWlsLnR5cGUgPT09ICdicmlnaHRjb3ZlJykgewogICAgICAgICAgICAgICAgICAgICAgICAgICAgTWFya2V0aW5nLlVETy5nX2JjX2VuZChpZFN0cmluZywgZXZlbnRUeXBlKTsKICAgICAgICAgICAgICAgICAgICAgICAgICAgIHdpbmRvdy5yZW1vdmVFdmVudExpc3RlbmVyKCdodmUnLCBfaGFuZGxlcik7CiAgICAgICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgICAgICB9KTsKICAgICAgICAgICAgfTsKICAgICAgICAgICAgTWFya2V0aW5nLlVETy5nX2NvbnRhY3R1cyA9IGZ1bmN0aW9uIChpZFN0cmluZywgZXZlbnRUeXBlKSB7CiAgICAgICAgICAgICAgICB3aW5kb3cuYWRkRXZlbnRMaXN0ZW5lcignaHZlJywgZnVuY3Rpb24gKGUpIHsKICAgICAgICAgICAgICAgICAgICBpZiAoZS5kZXRhaWwudHlwZSA9PT0gJ2NvbnRhY3R1cycpCiAgICAgICAgICAgICAgICAgICAgICAgIE1hcmtldGluZy5nRXZlbnQoaWRTdHJpbmcsIGV2ZW50VHlwZSk7CiAgICAgICAgICAgICAgICB9KTsKICAgICAgICAgICAgfTsKICAgICAgICAgICAgTWFya2V0aW5nLlVETy5nX2NoYXQgPSBmdW5jdGlvbiAoaWRTdHJpbmcsIGV2ZW50VHlwZSkgewogICAgICAgICAgICAgICAgd2luZG93LmFkZEV2ZW50TGlzdGVuZXIoJ2h2ZScsIGZ1bmN0aW9uIChlKSB7CiAgICAgICAgICAgICAgICAgICAgaWYgKGUuZGV0YWlsLnR5cGUgPT09ICdjaGF0JykKICAgICAgICAgICAgICAgICAgICAgICAgTWFya2V0aW5nLmdFdmVudChpZFN0cmluZywgZXZlbnRUeXBlKTsKICAgICAgICAgICAgICAgIH0pOwogICAgICAgICAgICB9OwogICAgICAgICAgICBNYXJrZXRpbmcuVURPLmdfYWRkdG9jYXJ0ID0gZnVuY3Rpb24gKGlkU3RyaW5nLCBldmVudFR5cGUpIHsKICAgICAgICAgICAgICAgIGlmIChkZWxsX21hcmtldGluZ191dGlsLmdldHNjTWFwKCd3YWNvbnRyb2xsZXInKSA9PT0gJ2NvbnRlbnRzJyB8fCBkZWxsX21hcmtldGluZ191dGlsLmdldHNjTWFwKCd3b3JrZmxvd3N0ZXAnKSA9PT0gJ2NhcnQnKQogICAgICAgICAgICAgICAgICAgIE1hcmtldGluZy5nRXZlbnQoaWRTdHJpbmcsIGV2ZW50VHlwZSk7CiAgICAgICAgICAgIH07CiAgICAgICAgICAgIE1hcmtldGluZy5VRE8uZ19jaGVja291dCA9IGZ1bmN0aW9uIChpZFN0cmluZywgZXZlbnRUeXBlKSB7CiAgICAgICAgICAgICAgICBpZiAoZGVsbF9tYXJrZXRpbmdfdXRpbC5nZXRzY01hcCgnd2Fjb250cm9sbGVyJykgPT09ICdjb25maXJtYXRpb24nKQogICAgICAgICAgICAgICAgICAgIE1hcmtldGluZy5nRXZlbnQoaWRTdHJpbmcsIGV2ZW50VHlwZSk7CiAgICAgICAgICAgIH07CiAgICAgICAgICAgIE1hcmtldGluZy5VRE8uZ19wb2RjYXN0X2xpc3RlbiA9IGZ1bmN0aW9uIChpZFN0cmluZywgZXZlbnRUeXBlKSB7CiAgICAgICAgICAgICAgICB3aW5kb3cuYWRkRXZlbnRMaXN0ZW5lcignaHZlJywgZnVuY3Rpb24gKGUpIHsKICAgICAgICAgICAgICAgICAgICBpZiAoZS5kZXRhaWwudHlwZSA9PT0gJ3BvZGNhc3RfbGlzdGVuJykKICAgICAgICAgICAgICAgICAgICAgICAgTWFya2V0aW5nLmdFdmVudChpZFN0cmluZywgZXZlbnRUeXBlKTsKICAgICAgICAgICAgICAgIH0pOwogICAgICAgICAgICB9OwogICAgICAgICAgICBNYXJrZXRpbmcuVURPLmdfcG9kY2FzdF9zdWJzY3JpYmUgPSBmdW5jdGlvbiAoaWRTdHJpbmcsIGV2ZW50VHlwZSkgewogICAgICAgICAgICAgICAgd2luZG93LmFkZEV2ZW50TGlzdGVuZXIoJ2h2ZScsIGZ1bmN0aW9uIChlKSB7CiAgICAgICAgICAgICAgICAgICAgaWYgKGUuZGV0YWlsLnR5cGUgPT09ICdwb2RjYXN0X3N1YnNjcmliZScpCiAgICAgICAgICAgICAgICAgICAgICAgIE1hcmtldGluZy5nRXZlbnQoaWRTdHJpbmcsIGV2ZW50VHlwZSk7CiAgICAgICAgICAgICAgICB9KTsKICAgICAgICAgICAgfTsKICAgICAgICAgICAgTWFya2V0aW5nLlVETy5nX3JmcV9zdWJtaXQgPSBmdW5jdGlvbiAoaWRTdHJpbmcsIGV2ZW50VHlwZSkgewogICAgICAgICAgICAgICAgd2luZG93LmFkZEV2ZW50TGlzdGVuZXIoJ2h2ZScsIGZ1bmN0aW9uIChlKSB7CiAgICAgICAgICAgICAgICAgICAgaWYgKGUuZGV0YWlsLnR5cGUgPT09ICdyZnFfc3VibWl0JykKICAgICAgICAgICAgICAgICAgICAgICAgTWFya2V0aW5nLmdFdmVudChpZFN0cmluZywgZXZlbnRUeXBlKTsKICAgICAgICAgICAgICAgIH0pOwogICAgICAgICAgICB9OwogICAgICAgICAgICBNYXJrZXRpbmcuVURPLmdfaW9uX3N1Ym1pdCA9IGZ1bmN0aW9uIChpZFN0cmluZywgZXZlbnRUeXBlKSB7CiAgICAgICAgICAgICAgICBpZiAoL2xpdmViYWxsLipjb21wbGV0ZWQvZ2kudGVzdChkZWxsX21hcmtldGluZ191dGlsLmdldHNjTWFwKCdwYWdlbmFtZScpKSkKICAgICAgICAgICAgICAgICAgICBNYXJrZXRpbmcuZ0V2ZW50KGlkU3RyaW5nLCBldmVudFR5cGUpOwogICAgICAgICAgICB9OwogICAgICAgICAgICBNYXJrZXRpbmcuVURPLmdfZ2F0ZWRfc3VibWl0ID0gZnVuY3Rpb24gKGlkU3RyaW5nLCBldmVudFR5cGUpIHsKICAgICAgICAgICAgICAgIHdpbmRvdy5hZGRFdmVudExpc3RlbmVyKCdodmUnLCBmdW5jdGlvbiAoZSkgewogICAgICAgICAgICAgICAgICAgIGlmIChlLmRldGFpbC50eXBlID09PSAnZ2F0ZWRfc3VibWl0JykKICAgICAgICAgICAgICAgICAgICAgICAgTWFya2V0aW5nLmdFdmVudChpZFN0cmluZywgZXZlbnRUeXBlKTsKICAgICAgICAgICAgICAgIH0pOwogICAgICAgICAgICB9OwogICAgICAgIH0sIDM0NzUxOTMsIFszNjE3NjgyXSwgNjIwODE4LCBbNjE5NDA0XSk7CiAgICB9KCkpCn0="},{"name":"sugarcoat-17dbedf29c222ec937e1ba47e7f974c45dff2329","aliases":[],"kind":{"mime":"application/javascript"},"content":"ewogICAgY29uc3QgJF9fX21vY2tfYTIwYTUwOWI0ZTc2Y2ExZCA9IHt9OwogICAgKGV4cG9ydHMgPT4gewogICAgICAgICd1c2Ugc3RyaWN0JzsKICAgICAgICBsZXQgaXNTZWFsZWQgPSBmYWxzZTsKICAgICAgICBjbGFzcyBTdG9yYWdlIHsKICAgICAgICAgICAgY29uc3RydWN0b3IoKSB7CiAgICAgICAgICAgICAgICBpZiAoaXNTZWFsZWQpIHsKICAgICAgICAgICAgICAgICAgICB0aHJvdyBuZXcgVHlwZUVycm9yKCdJbGxlZ2FsIGNvbnN0cnVjdG9yJyk7CiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgIH0KICAgICAgICAgICAgZ2V0IGxlbmd0aCgpIHsKICAgICAgICAgICAgICAgIHJldHVybiBPYmplY3Qua2V5cyh0aGlzKS5sZW5ndGg7CiAgICAgICAgICAgIH0KICAgICAgICAgICAga2V5KGluZGV4KSB7CiAgICAgICAgICAgICAgICBjb25zdCBrZXlzID0gT2JqZWN0LmtleXModGhpcyk7CiAgICAgICAgICAgICAgICBpZiAoaW5kZXggPCAwIHx8IGluZGV4ID49IGtleXMubGVuZ3RoKSB7CiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIG51bGw7CiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICByZXR1cm4ga2V5c1tpbmRleF07CiAgICAgICAgICAgIH0KICAgICAgICAgICAgZ2V0SXRlbShrZXkpIHsKICAgICAgICAgICAgICAgIHJldHVybiBPYmplY3QucHJvdG90eXBlLmhhc093blByb3BlcnR5LmNhbGwodGhpcywga2V5KSA/IHRoaXNba2V5XSA6IG51bGw7CiAgICAgICAgICAgIH0KICAgICAgICAgICAgc2V0SXRlbShrZXksIHZhbHVlKSB7CiAgICAgICAgICAgICAgICB0aGlzW2tleV0gPSBTdHJpbmcodmFsdWUpOwogICAgICAgICAgICB9CiAgICAgICAgICAgIHJlbW92ZUl0ZW0oa2V5KSB7CiAgICAgICAgICAgICAgICBkZWxldGUgdGhpc1trZXldOwogICAgICAgICAgICB9CiAgICAgICAgICAgIGNsZWFyKCkgewogICAgICAgICAgICAgICAgY29uc3Qga2V5cyA9IE9iamVjdC5rZXlzKHRoaXMpOwogICAgICAgICAgICAgICAgZm9yIChjb25zdCBrZXkgb2Yga2V5cykgewogICAgICAgICAgICAgICAgICAgIGRlbGV0ZSB0aGlzW2tleV07CiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgIH0KICAgICAgICB9CiAgICAgICAgZXhwb3J0cy5TdG9yYWdlID0gewogICAgICAgICAgICBjb25maWd1cmFibGU6IHRydWUsCiAgICAgICAgICAgIGVudW1lcmFibGU6IHRydWUsCiAgICAgICAgICAgIHZhbHVlOiBTdG9yYWdlLAogICAgICAgICAgICB3cml0YWJsZTogdHJ1ZQogICAgICAgIH07CiAgICAgICAgY29uc3QgbG9jYWxTdG9yYWdlID0gbmV3IFN0b3JhZ2UoKTsKICAgICAgICBleHBvcnRzLmxvY2FsU3RvcmFnZSA9IHsKICAgICAgICAgICAgY29uZmlndXJhYmxlOiB0cnVlLAogICAgICAgICAgICBlbnVtZXJhYmxlOiB0cnVlLAogICAgICAgICAgICBnZXQoKSB7CiAgICAgICAgICAgICAgICByZXR1cm4gbG9jYWxTdG9yYWdlOwogICAgICAgICAgICB9CiAgICAgICAgfTsKICAgICAgICBjb25zdCBzZXNzaW9uU3RvcmFnZSA9IG5ldyBTdG9yYWdlKCk7CiAgICAgICAgZXhwb3J0cy5zZXNzaW9uU3RvcmFnZSA9IHsKICAgICAgICAgICAgY29uZmlndXJhYmxlOiB0cnVlLAogICAgICAgICAgICBlbnVtZXJhYmxlOiB0cnVlLAogICAgICAgICAgICBnZXQoKSB7CiAgICAgICAgICAgICAgICByZXR1cm4gc2Vzc2lvblN0b3JhZ2U7CiAgICAgICAgICAgIH0KICAgICAgICB9OwogICAgICAgIGlzU2VhbGVkID0gdHJ1ZTsKICAgIH0pKCRfX19tb2NrX2EyMGE1MDliNGU3NmNhMWQpOwogICAgKGZ1bmN0aW9uICgpIHsKICAgICAgICBNYXJrZXRpbmcuYmluZERlcGVuZGVuY3lET01QYXJzZWQoZnVuY3Rpb24gKCkgewogICAgICAgICAgICB2YXIgQm9vdHN0cmFwcGVyID0gd2luZG93WydNYXJrZXRpbmcnXTsKICAgICAgICAgICAgdmFyIGVuc2lnaHRlbk9wdGlvbnMgPSBNYXJrZXRpbmcuZW5zaWdodGVuT3B0aW9uczsKICAgICAgICAgICAgdHJ5IHsKICAgICAgICAgICAgICAgIE1hcmtldGluZy5VRE8ucGVyZlRpbWluZ1N0YXJ0KCdydWxlSWQtJyArIHRoaXMuaWQgKyAnLWRlcGxveW1lbnRJZC0nICsgdGhpcy5kZXBsb3ltZW50SWQpOwogICAgICAgICAgICAgICAgdmFyIGdlb0xvY2F0aW9uID0gWwogICAgICAgICAgICAgICAgICAgICdhdScsCiAgICAgICAgICAgICAgICAgICAgJ256JywKICAgICAgICAgICAgICAgICAgICAnaW4nLAogICAgICAgICAgICAgICAgICAgICdzZycsCiAgICAgICAgICAgICAgICAgICAgJ215JywKICAgICAgICAgICAgICAgICAgICAnanAnLAogICAgICAgICAgICAgICAgICAgICdrcicsCiAgICAgICAgICAgICAgICAgICAgJ3R3JywKICAgICAgICAgICAgICAgICAgICAnaGsnCiAgICAgICAgICAgICAgICBdOwogICAgICAgICAgICAgICAgdmFyIGZpcmVQaXhlbCA9IGZ1bmN0aW9uIChwaXhlbElEKSB7CiAgICAgICAgICAgICAgICAgICAgdmFyIHNjcmlwdFVybCA9IHBpeGVsSUQgKyAnJnMxPScgKyBlbmNvZGVVUklDb21wb25lbnQod2luZG93LmxvY2F0aW9uLmhyZWYpICsgJyZzMj0nICsgZW5jb2RlVVJJQ29tcG9uZW50KGRvY3VtZW50LnJlZmVycmVyKSArICcmczM9JyArIE1hcmtldGluZy5VRE8ucHJvbW9pZCArICcmczQ9JnM1PScgKyBNYXJrZXRpbmcuVURPLnByb2RjYXQgKyAnJnM2PSZzNz0nICsgTWFya2V0aW5nLlVETy5vcmRlcmNvZGUgKyAnJnM4PScgKyBlbmNvZGVVUklDb21wb25lbnQoTWFya2V0aW5nLlVETy5jYXRlZ29yeSkgKyAnJnM5PScgKyBlbmNvZGVVUklDb21wb25lbnQoTWFya2V0aW5nLlVETy5mYW1pbHkpICsgJyZzMTA9JyArIE1hcmtldGluZy5VRE8ucHJvZHVjdCArICcmdjE9JyArIE1hcmtldGluZy5VRE8ucmV2ZW51ZSArICcmdjI9JyArIE1hcmtldGluZy5VRE8uZGVhbHMgKyAnJnYzPSZ2ND0mdjU9JyArIE1hcmtldGluZy5zY0RhdGFPYmouY291bnRyeSArICcmdjY9JyArIE1hcmtldGluZy5zY0RhdGFPYmoubGFuZ3VhZ2UgKyAnJnY3PScgKyBNYXJrZXRpbmcuVURPLmNzZWcgKyAnJnY4PScgKyBNYXJrZXRpbmcuc2NEYXRhT2JqLnNlZ21lbnQgKyAnJnY5PScgKyBNYXJrZXRpbmcuVURPLnBsYXRmb3JtICsgJyZ2MTA9JyArIE1hcmtldGluZy5VRE8uZHBpZDsKICAgICAgICAgICAgICAgICAgICBNYXJrZXRpbmcuaW5zZXJ0U2NyaXB0KCcvL3BpeGVsLm1hdGh0YWcuY29tL2V2ZW50L2pzPycgKyBzY3JpcHRVcmwpOwogICAgICAgICAgICAgICAgfTsKICAgICAgICAgICAgICAgIGlmIChNYXJrZXRpbmcuVURPLmNvdW50cnkgPT0gJ3VzJykgewogICAgICAgICAgICAgICAgICAgIGZpcmVQaXhlbCgnbXRfaWQ9Nzc2MjIxJm10X2FkaWQ9MTI5ODA1Jyk7CiAgICAgICAgICAgICAgICAgICAgaWYgKE1hcmtldGluZy5zY0RhdGFPYmouY21zID09ICdvbHInKQogICAgICAgICAgICAgICAgICAgICAgICB3aW5kb3cuYWRkRXZlbnRMaXN0ZW5lcigndWRvUmVhZHknLCBmdW5jdGlvbiAoKSB7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICBmaXJlUGl4ZWwoJ210X2lkPTc3NjIyMSZtdF9hZGlkPTEyOTgwNScpOwogICAgICAgICAgICAgICAgICAgICAgICB9KTsKICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgIGlmIChNYXJrZXRpbmcuVURPLmNvdW50cnkgPT0gJ2JyJykKICAgICAgICAgICAgICAgICAgICBmaXJlUGl4ZWwoJ210X2lkPTgzODU3NSZtdF9hZGlkPTE0OTA1MScpOwogICAgICAgICAgICAgICAgaWYgKE1hcmtldGluZy5VRE8uY291bnRyeSA9PSAnaW4nICYmIE1hcmtldGluZy5zY0RhdGFPYmouY21zICE9ICdkZWxsZW1jJyAmJiBNYXJrZXRpbmcuc2NEYXRhT2JqLmNtcyAhPSAnZGVsbHRlY2gnKQogICAgICAgICAgICAgICAgICAgIGZpcmVQaXhlbCgnbXRfaWQ9NzY5ODE3Jm10X2FkaWQ9MTQxNjI5Jyk7CiAgICAgICAgICAgICAgICBpZiAoZ2VvTG9jYXRpb24uaW5kZXhPZihNYXJrZXRpbmcuVURPLmNvdW50cnkpID4gLTEgJiYgTWFya2V0aW5nLnNjRGF0YU9iai5jbXMgIT0gJ2NvbXB1aW5kaWEnKSB7CiAgICAgICAgICAgICAgICAgICAgZmlyZVBpeGVsKCdtdF9pZD0xMzI0Njc2Jm10X2FkaWQ9MTg5MTY2Jm10X2V4ZW09Jm10X2V4Y2w9Jyk7CiAgICAgICAgICAgICAgICAgICAgaWYgKChNYXJrZXRpbmcuVURPLmNvdW50cnkgPT0gJ2F1JyB8fCBNYXJrZXRpbmcuVURPLmNvdW50cnkgPT0gJ3NnJyB8fCBNYXJrZXRpbmcuVURPLmNvdW50cnkgPT0gJ215JykgJiYgTWFya2V0aW5nLnNjRGF0YU9iai5jbXMgPT0gJ29scicpIHsKICAgICAgICAgICAgICAgICAgICAgICAgaWYgKE1hcmtldGluZy5VRE8ucHJvbW9pZCA9PSAnMTAwJykKICAgICAgICAgICAgICAgICAgICAgICAgICAgIGZpcmVQaXhlbCgnbXRfaWQ9MTU1ODQyMiZtdF9hZGlkPTE4OTE2NiZtdF9leGVtPSZtdF9leGNsPScpOwogICAgICAgICAgICAgICAgICAgICAgICB3aW5kb3cuYWRkRXZlbnRMaXN0ZW5lcigndWRvUmVhZHknLCBmdW5jdGlvbiAoKSB7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICBmaXJlUGl4ZWwoJ210X2lkPTEzMjQ2NzYmbXRfYWRpZD0xODkxNjYmbXRfZXhlbT0mbXRfZXhjbD0nKTsKICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmIChNYXJrZXRpbmcuVURPLnByb21vaWQgPT0gJzEwMCcpCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZmlyZVBpeGVsKCdtdF9pZD0xNTU4NDIyJm10X2FkaWQ9MTg5MTY2Jm10X2V4ZW09Jm10X2V4Y2w9Jyk7CiAgICAgICAgICAgICAgICAgICAgICAgIH0pOwogICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgIE1hcmtldGluZy5VRE8ucGVyZlRpbWluZ0VuZCgncnVsZUlkLScgKyB0aGlzLmlkICsgJy1kZXBsb3ltZW50SWQtJyArIHRoaXMuZGVwbG95bWVudElkKTsKICAgICAgICAgICAgfSBjYXRjaCAoZSkgewogICAgICAgICAgICAgICAgZGVsbF9tYXJrZXRpbmdfdXRpbC5kZWJ1ZyhlKTsKICAgICAgICAgICAgfQogICAgICAgIH0sIDM2MTMyNTIsIFszNjA2MzI5XSwgNjMwNjgwLCBbNjEwMzIzXSk7CiAgICAgICAgTWFya2V0aW5nLmJpbmREZXBlbmRlbmN5RE9NUGFyc2VkKGZ1bmN0aW9uICgpIHsKICAgICAgICAgICAgdmFyIEJvb3RzdHJhcHBlciA9IHdpbmRvd1snTWFya2V0aW5nJ107CiAgICAgICAgICAgIHZhciBlbnNpZ2h0ZW5PcHRpb25zID0gTWFya2V0aW5nLmVuc2lnaHRlbk9wdGlvbnM7CiAgICAgICAgICAgIHRyeSB7CiAgICAgICAgICAgICAgICBNYXJrZXRpbmcuVURPLnBlcmZUaW1pbmdTdGFydCgncnVsZUlkLScgKyB0aGlzLmlkICsgJy1kZXBsb3ltZW50SWQtJyArIHRoaXMuZGVwbG95bWVudElkKTsKICAgICAgICAgICAgICAgIHZhciBtYXJrZXRpbmdzY0RhdGFPYmogPSBNYXJrZXRpbmcuc2NEYXRhT2JqOwogICAgICAgICAgICAgICAgdmFyIG1hcmtldGluZ1VETyA9IE1hcmtldGluZy5VRE87CiAgICAgICAgICAgICAgICBpZiAobWFya2V0aW5nc2NEYXRhT2JqLnNlZ21lbnQgPT0gJ2JzZCcpIHsKICAgICAgICAgICAgICAgICAgICBpZiAobWFya2V0aW5nVURPLnByb21vaWQgPT0gJzInKQogICAgICAgICAgICAgICAgICAgICAgICBNYXJrZXRpbmcuaW1hZ2VSZXF1ZXN0KCcvL3IudHVybi5jb20vci9iZWFjb24/YjI9MURQUWtiTVBvYnJQdHUxRTdGNGEtdHY2aXVOTmVFSmF1UXRuR3hBaXFwYWZub09Ub2NOdkZ3RUU0WWdISGt2YnhMNGpKR3lOSzBabWhDTFhHeTJ0S3cmY2lkPScpOwogICAgICAgICAgICAgICAgICAgIGlmIChtYXJrZXRpbmdzY0RhdGFPYmouY2F0ZWdvcnlpZCA9PSAncGNhYXMnICYmIG1hcmtldGluZ3NjRGF0YU9iai5wYWdlID09ICdjYW1wYWlnbicgfHwgbWFya2V0aW5nc2NEYXRhT2JqLmNhdGVnb3J5aWQgPT0gJ3Bvd2VyZWRnZS10b3dlci1zZXJ2ZXItZGVhbHMnICYmIG1hcmtldGluZ3NjRGF0YU9iai5wYWdlID09ICdkZWFscycgfHwgKG1hcmtldGluZ3NjRGF0YU9iai5jYXRlZ29yeWlkID09ICd4cHMtbGFwdG9wcycgfHwgbWFya2V0aW5nc2NEYXRhT2JqLmNhdGVnb3J5aWQgPT0gJzgxNDEnIHx8IG1hcmtldGluZ3NjRGF0YU9iai5jYXRlZ29yeWlkID09ICdvcHRpcGxleC1kZXNrdG9wcycgfHwgbWFya2V0aW5nc2NEYXRhT2JqLmNhdGVnb3J5aWQgPT0gJ3Zvc3Ryby1sYXB0b3BzJykgJiYgbWFya2V0aW5nc2NEYXRhT2JqLnBhZ2UgPT0gJ3Byb2R1Y3RkZXRhaWxzJykgewogICAgICAgICAgICAgICAgICAgICAgICBNYXJrZXRpbmcuaW1hZ2VSZXF1ZXN0KCcvL3IudHVybi5jb20vci9iZWFjb24/YjI9SGV1N2QyZjFKdW5mQXY0aWZTZk9MYnFOMEo0NUlwYl9LNjRLbVZQeWNCMmZub09Ub2NOdkZ3RUU0WWdISGt2YmJ3eHplQ0ZSV3Q5TEJ6NkZGSUs2bVEmY2lkPScpOwogICAgICAgICAgICAgICAgICAgICAgICBNYXJrZXRpbmcuaW1hZ2VSZXF1ZXN0KCcvL3IudHVybi5jb20vci9iZWFjb24/YjI9T3B1Q1RkZ213aThLRXpRR0ZoX2w2c2tsa0NNRWR0RmYzTHZuaVFSeDJyQ2Zub09Ub2NOdkZ3RUU0WWdISGt2Yjl4TkRVcmpGNnZkOHRQNVQ4ZXlXcXcmY2lkPScpOwogICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgICAgICBpZiAobWFya2V0aW5nc2NEYXRhT2JqLmNhdGVnb3J5aWQgPT0gJ3NtYWxsLWJ1c2luZXNzLWNlbnRyYWwnICYmIG1hcmtldGluZ3NjRGF0YU9iai5wYWdlID09ICdjYW1wYWlnbicpCiAgICAgICAgICAgICAgICAgICAgICAgIE1hcmtldGluZy5pbWFnZVJlcXVlc3QoJy8vci50dXJuLmNvbS9yL2JlYWNvbj9iMj1ieDkybmU2SjZERWM4R04yUjFNdGp1ODhnUi1EQnNEQjdpUllHQVBseGVlZm5vT1RvY052RndFRTRZZ0hIa3ZiOHA0dFk1TVlrUEVvSVVFdVRHakdGUSZjaWQ9Jyk7CiAgICAgICAgICAgICAgICAgICAgaWYgKG1hcmtldGluZ3NjRGF0YU9iai5wYWdlID09ICdjb25maXJtYXRpb24nKQogICAgICAgICAgICAgICAgICAgICAgICBNYXJrZXRpbmcuaW1hZ2VSZXF1ZXN0KCcvL3IudHVybi5jb20vci9iZWFjb24/YjI9NHladEtzbnd6bWp2NWdIRnEtci10SU5udHZVdmRJMVptLTlENGNsVG11Q2Zub09Ub2NOdkZ3RUU0WWdISGt2Yi1yN2NZRDZub2VKLWxqbkZ4X3lXZWcmY2lkPScpOwogICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgaWYgKG1hcmtldGluZ3NjRGF0YU9iai5zZWdtZW50ID09ICdkaHMnKSB7CiAgICAgICAgICAgICAgICAgICAgaWYgKG1hcmtldGluZ1VETy5wcm9tb2lkID09ICcyJykKICAgICAgICAgICAgICAgICAgICAgICAgTWFya2V0aW5nLmltYWdlUmVxdWVzdCgnLy9yLnR1cm4uY29tL3IvYmVhY29uP2IyPXFHLXZNazdTSEIzVGZiOE1scXNXOXBZbVlLSW10WGtFemxacTQ4bzNJdmVmbm9PVG9jTnZGd0VFNFlnSEhrdmJkRno5S0lXTG1JYXMzUm5HdVB1SVJ3JmNpZD0nKTsKICAgICAgICAgICAgICAgICAgICBpZiAobWFya2V0aW5nVURPLnByb21vaWQgPT0gJzQnKQogICAgICAgICAgICAgICAgICAgICAgICBNYXJrZXRpbmcuaW1hZ2VSZXF1ZXN0KCcvL3IudHVybi5jb20vci9iZWFjb24/YjI9YmJGODI5SEVLQ2FGR181THlYZkFHZDk2UDF0aE1lekRQcXpWclhocUlBT2Zub09Ub2NOdkZ3RUU0WWdISGt2YjY2ZFFOWkt4NjlxLVpWSnRTQWFlUmcmY2lkPScpOwogICAgICAgICAgICAgICAgICAgIGlmIChtYXJrZXRpbmdzY0RhdGFPYmoucGFnZSA9PSAnY29uZmlybWF0aW9uJykKICAgICAgICAgICAgICAgICAgICAgICAgTWFya2V0aW5nLmltYWdlUmVxdWVzdCgnLy9yLnR1cm4uY29tL3IvYmVhY29uP2IyPS03X29wY0dNeFhRN3BHWjBXUHRGajg0UFl0cS0taWI2RGdtanF3TlhjdVdmbm9PVG9jTnZGd0VFNFlnSEhrdmJVTjV4TkVoSFJaM2VHX21BX1V5bkJ3JmNpZD0mYnByaWNlPScgKyBtYXJrZXRpbmdVRE8ucmV2ZW51ZSk7CiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICBpZiAobWFya2V0aW5nc2NEYXRhT2JqLnNlZ21lbnQgPT0gJ2VlcCcpIHsKICAgICAgICAgICAgICAgICAgICBpZiAobWFya2V0aW5nVURPLnByb21vaWQgPT0gJzInKQogICAgICAgICAgICAgICAgICAgICAgICBNYXJrZXRpbmcuaW1hZ2VSZXF1ZXN0KCcvL3IudHVybi5jb20vci9iZWFjb24/YjI9MVNLN2hObDRKRVdTSDhCSGhpYUExT21JRjE5cF9hMGk1TnlNUXBWTmZscWZub09Ub2NOdkZ3RUU0WWdISGt2YnFVTTNtdWo4TVQ2cjdWXy10VzFZTncmY2lkPScpOwogICAgICAgICAgICAgICAgICAgIGlmIChtYXJrZXRpbmdVRE8ucHJvbW9pZCA9PSAnNCcpCiAgICAgICAgICAgICAgICAgICAgICAgIE1hcmtldGluZy5pbWFnZVJlcXVlc3QoJy8vci50dXJuLmNvbS9yL2JlYWNvbj9iMj1BTUhwVDZ0V1E2QWxKNUdRYXJqeTlNVzF3MkRoM3pDWEpHZVFIQ2otX09tZm5vT1RvY052RndFRTRZZ0hIa3ZiZUsxYUtaMXlaaWZ3bFQwdzdjVW5XdyZjaWQ9Jyk7CiAgICAgICAgICAgICAgICAgICAgaWYgKG1hcmtldGluZ3NjRGF0YU9iai5wYWdlID09ICdjb25maXJtYXRpb24nKQogICAgICAgICAgICAgICAgICAgICAgICBNYXJrZXRpbmcuaW1hZ2VSZXF1ZXN0KCcvL3IudHVybi5jb20vci9iZWFjb24/YjI9Z005TTVkMkxiQ2hxcmdFbUpQOG9kM1lXS3oteWplbm01S1ZKZmpaVjhJT2Zub09Ub2NOdkZ3RUU0WWdISGt2Ymp2bGpfQmFCTTRWanhQSkg2LWFHencmY2lkPSZicHJpY2U9JyArIG1hcmtldGluZ1VETy5yZXZlbnVlKTsKICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgIGlmIChtYXJrZXRpbmdzY0RhdGFPYmouY2F0ZWdvcnlpZC5pbmNsdWRlcygnZ2FtZScpIHx8IG1hcmtldGluZ3NjRGF0YU9iai5jYXRlZ29yeWlkLmluY2x1ZGVzKCdnYW1pbmcnKSB8fCBtYXJrZXRpbmdzY0RhdGFPYmouY2F0ZWdvcnlpZC5pbmNsdWRlcygnZy1zZXJpZXMnKSB8fCBtYXJrZXRpbmdzY0RhdGFPYmoucGFnZS5pbmNsdWRlcygnYWxpZW53YXJlJykgfHwgbWFya2V0aW5nc2NEYXRhT2JqLmNhdGVnb3J5aWQuaW5jbHVkZXMoJ2FsaWVud2FyZScpIHx8IHdpbmRvdy5sb2NhdGlvbi5ocmVmLmluY2x1ZGVzKCdnYW1pbmcnKSkgewogICAgICAgICAgICAgICAgICAgIGlmIChtYXJrZXRpbmdVRE8ucHJvbW9pZCA9PSAnMicgfHwgbWFya2V0aW5nVURPLnByb21vaWQgPT0gJzMnIHx8IG1hcmtldGluZ1VETy5wcm9tb2lkID09ICcxMycpCiAgICAgICAgICAgICAgICAgICAgICAgIE1hcmtldGluZy5pbWFnZVJlcXVlc3QoJy8vci50dXJuLmNvbS9yL2JlYWNvbj9iMj01WjlvUmV1NWVVRkRkamxiekV0MkI2dmNGNkRfbUF5STVoR0RiZTNNX29TZm5vT1RvY052RndFRTRZZ0hIa3ZiSHpCbXlJQk1Nb2o4VmctcTR3dFZoQSZjaWQ9Jyk7CiAgICAgICAgICAgICAgICAgICAgaWYgKG1hcmtldGluZ1VETy5jYXRlZ29yeS5pbmNsdWRlcygnZGVhbHMnKSkKICAgICAgICAgICAgICAgICAgICAgICAgTWFya2V0aW5nLmltYWdlUmVxdWVzdCgnLy9yLnR1cm4uY29tL3IvYmVhY29uP2IyPTlDYmZ5dmlXQ01raEppRlpoQzI2a2ljSEo5cjI5Y0dvQ2toclVVYnk1WW1mbm9PVG9jTnZGd0VFNFlnSEhrdmIxd0JJSGdtTFR1YzBQMHYweHJFLVN3JmNpZD0nKTsKICAgICAgICAgICAgICAgICAgICBpZiAobWFya2V0aW5nc2NEYXRhT2JqLnBhZ2UgPT0gJ2NvbmZpcm1hdGlvbicpCiAgICAgICAgICAgICAgICAgICAgICAgIE1hcmtldGluZy5pbWFnZVJlcXVlc3QoJy8vci50dXJuLmNvbS9yL2JlYWNvbj9iMj1rVHJCS29iVlp4V2NhZGFseDhBVFVmdHNfY1JZREFRYXBERU01SnRTUkt1Zm5vT1RvY052RndFRTRZZ0hIa3ZidmRPSkk3eU04bk5tMWp5TzQxWEJkZyZjaWQ9JmJwcmljZT0nICsgbWFya2V0aW5nVURPLnJldmVudWUpOwogICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgTWFya2V0aW5nLlVETy5wZXJmVGltaW5nRW5kKCdydWxlSWQtJyArIHRoaXMuaWQgKyAnLWRlcGxveW1lbnRJZC0nICsgdGhpcy5kZXBsb3ltZW50SWQpOwogICAgICAgICAgICB9IGNhdGNoIChlKSB7CiAgICAgICAgICAgICAgICBkZWxsX21hcmtldGluZ191dGlsLmRlYnVnKGUpOwogICAgICAgICAgICB9CiAgICAgICAgfSwgMzYwMDI3MywgWzM2MDYzMjldLCA2MzE5MjgsIFs2MTAzMjNdKTsKICAgICAgICBNYXJrZXRpbmcuYmluZERlcGVuZGVuY3lET01QYXJzZWQoZnVuY3Rpb24gKCkgewogICAgICAgICAgICB2YXIgQm9vdHN0cmFwcGVyID0gd2luZG93WydNYXJrZXRpbmcnXTsKICAgICAgICAgICAgdmFyIGVuc2lnaHRlbk9wdGlvbnMgPSBNYXJrZXRpbmcuZW5zaWdodGVuT3B0aW9uczsKICAgICAgICAgICAgdHJ5IHsKICAgICAgICAgICAgICAgIE1hcmtldGluZy5VRE8ucGVyZlRpbWluZ1N0YXJ0KCdydWxlSWQtJyArIHRoaXMuaWQgKyAnLWRlcGxveW1lbnRJZC0nICsgdGhpcy5kZXBsb3ltZW50SWQpOwogICAgICAgICAgICAgICAgdmFyIG1hcmtldGluZ3NjRGF0YU9iaiA9IE1hcmtldGluZy5zY0RhdGFPYmo7CiAgICAgICAgICAgICAgICB2YXIgbWFya2V0aW5nVURPID0gTWFya2V0aW5nLlVETzsKICAgICAgICAgICAgICAgIHZhciBwaXhfaWQgPSAnJywgdHlwZSA9ICcnOwogICAgICAgICAgICAgICAgdmFyIHNpdGVVcmwgPSB3aW5kb3cubG9jYXRpb24ub3JpZ2luICsgd2luZG93LmxvY2F0aW9uLnBhdGhuYW1lOwogICAgICAgICAgICAgICAgaWYgKG1hcmtldGluZ1VETy5zZWdtZW50ID09ICdic2QnKSB7CiAgICAgICAgICAgICAgICAgICAgaWYgKG1hcmtldGluZ1VETy5wcm9tb2lkID09ICc5JykgewogICAgICAgICAgICAgICAgICAgICAgICBwaXhfaWQgPSAnNjc0NmM2OGMtZGU2ZS1hMjAwLThiZjEtOTY2YjQ2NzhjMmM0JzsKICAgICAgICAgICAgICAgICAgICAgICAgdHlwZSA9ICcxMCc7CiAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgICAgIGlmIChtYXJrZXRpbmdVRE8ucHJvbW9pZCA9PSAnMycpIHsKICAgICAgICAgICAgICAgICAgICAgICAgcGl4X2lkID0gJzcxNzNiZGU1LWIzZjYtYTUxNS0wNDJmLThlYzBlMzg0OWQ3OSc7CiAgICAgICAgICAgICAgICAgICAgICAgIHR5cGUgPSAnNCc7CiAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgICAgIGlmIChtYXJrZXRpbmdVRE8ucHJvbW9pZCA9PSAnNycgJiYgbWFya2V0aW5nc2NEYXRhT2JqLm1vZHVsZS5pbmNsdWRlcygnY29uZmlndXJhdG9yJykpIHsKICAgICAgICAgICAgICAgICAgICAgICAgcGl4X2lkID0gJzk4ZjAwY2RiLTI0NjUtNjc5NS01NTIyLThjYjhjZmY5ZWRhMSc7CiAgICAgICAgICAgICAgICAgICAgICAgIHR5cGUgPSAnNCc7CiAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgICAgIGlmIChtYXJrZXRpbmdVRE8ucHJvbW9pZCA9PSAnNCcpIHsKICAgICAgICAgICAgICAgICAgICAgICAgcGl4X2lkID0gJzhhYTM3OWExLWViNTctZmY5Yy0xNGEzLWY4MGY3MzI4NmY1ZSc7CiAgICAgICAgICAgICAgICAgICAgICAgIHR5cGUgPSAnNCc7CiAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgICAgIGlmIChtYXJrZXRpbmdVRE8ucHJvbW9pZCA9PSAnNScpIHsKICAgICAgICAgICAgICAgICAgICAgICAgcGl4X2lkID0gJzFlOWRkZTE3LWUxNDktYmI1MS1kYmYyLTNkNDVmM2RkNDY1Zic7CiAgICAgICAgICAgICAgICAgICAgICAgIHR5cGUgPSAnNCc7CiAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgICAgIGlmIChtYXJrZXRpbmdVRE8ucHJvbW9pZCA9PSAnMicpIHsKICAgICAgICAgICAgICAgICAgICAgICAgcGl4X2lkID0gJzc1MjU1YWVkLWQxYTgtMDQ4Ni0xMmE3LTE1MGZiZTM0ZDBhZic7CiAgICAgICAgICAgICAgICAgICAgICAgIHR5cGUgPSAnNTUnOwogICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgICAgICBpZiAobWFya2V0aW5nVURPLnByb21vaWQgPT0gJzcnICYmIG1hcmtldGluZ3NjRGF0YU9iai5tb2R1bGUuaW5jbHVkZXMoJ3Byb2R1Y3RkZXRhaWwnKSkgewogICAgICAgICAgICAgICAgICAgICAgICBwaXhfaWQgPSAnNTQzZjdhNzgtYTBhNS1hZmQ4LTU4ZjktMzllODdkNmU2OWZhJzsKICAgICAgICAgICAgICAgICAgICAgICAgdHlwZSA9ICc1NCc7CiAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgaWYgKG1hcmtldGluZ1VETy5zZWdtZW50ID09ICdlZXAnKSB7CiAgICAgICAgICAgICAgICAgICAgaWYgKG1hcmtldGluZ1VETy5wcm9tb2lkID09ICc5JykgewogICAgICAgICAgICAgICAgICAgICAgICBwaXhfaWQgPSAnNWE3OGM2M2MtNTI4Ni03MGUxLTZhYmYtYTAyN2JiM2RjM2MyJzsKICAgICAgICAgICAgICAgICAgICAgICAgdHlwZSA9ICcxMCc7CiAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgICAgIGlmIChtYXJrZXRpbmdVRE8ucHJvbW9pZCA9PSAnMycpIHsKICAgICAgICAgICAgICAgICAgICAgICAgcGl4X2lkID0gJzE3MWFiNGY2LTAxODQtYmU3NS03ZTljLTg0NWZlZGYxMGU3Yic7CiAgICAgICAgICAgICAgICAgICAgICAgIHR5cGUgPSAnNCc7CiAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgICAgIGlmIChtYXJrZXRpbmdVRE8ucHJvbW9pZCA9PSAnNycgJiYgbWFya2V0aW5nc2NEYXRhT2JqLm1vZHVsZS5pbmNsdWRlcygnY29uZmlndXJhdG9yJykpIHsKICAgICAgICAgICAgICAgICAgICAgICAgcGl4X2lkID0gJzk4ZWM2ZWIwLTNlMzAtYWRlYS1jNzBkLWZkYTUxZWZkZjgxNyc7CiAgICAgICAgICAgICAgICAgICAgICAgIHR5cGUgPSAnNCc7CiAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgICAgIGlmIChtYXJrZXRpbmdVRE8ucHJvbW9pZCA9PSAnNCcpIHsKICAgICAgICAgICAgICAgICAgICAgICAgcGl4X2lkID0gJ2MzNzNiMzhkLWY0YjYtZTUxOS0xMzBmLTkwYmUwOGJkMTM0Yyc7CiAgICAgICAgICAgICAgICAgICAgICAgIHR5cGUgPSAnNCc7CiAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgICAgIGlmIChtYXJrZXRpbmdVRE8ucHJvbW9pZCA9PSAnNScpIHsKICAgICAgICAgICAgICAgICAgICAgICAgcGl4X2lkID0gJzBiNjNkMjg3LTA5YzctYzliOC04NWNmLTRjOTFkODc3NjRlOSc7CiAgICAgICAgICAgICAgICAgICAgICAgIHR5cGUgPSAnNCc7CiAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgICAgIGlmIChtYXJrZXRpbmdVRE8ucHJvbW9pZCA9PSAnMicpIHsKICAgICAgICAgICAgICAgICAgICAgICAgcGl4X2lkID0gJ2M2ZWUzNzA2LWFiMDgtYmNiMi02MTMwLTc1ZjFkMGM0YjE1Nyc7CiAgICAgICAgICAgICAgICAgICAgICAgIHR5cGUgPSAnNTUnOwogICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgICAgICBpZiAobWFya2V0aW5nVURPLnByb21vaWQgPT0gJzcnICYmIG1hcmtldGluZ3NjRGF0YU9iai5tb2R1bGUuaW5jbHVkZXMoJ3Byb2R1Y3RkZXRhaWwnKSkgewogICAgICAgICAgICAgICAgICAgICAgICBwaXhfaWQgPSAnOGYxOTc5MTctYzI2ZC03NTY2LWZhOTAtNTcxYWZmNDhmYmVkJzsKICAgICAgICAgICAgICAgICAgICAgICAgdHlwZSA9ICc1NCc7CiAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgaWYgKG1hcmtldGluZ1VETy5zZWdtZW50ID09ICdkaHMnKSB7CiAgICAgICAgICAgICAgICAgICAgaWYgKG1hcmtldGluZ1VETy5wcm9tb2lkID09ICc5JykgewogICAgICAgICAgICAgICAgICAgICAgICBwaXhfaWQgPSAnYWZjZTY5NDItZDYyNC0xNzAyLWMzYTMtYjVkMzlmYmExY2EzJzsKICAgICAgICAgICAgICAgICAgICAgICAgdHlwZSA9ICcxMCc7CiAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgICAgIGlmIChtYXJrZXRpbmdVRE8ucHJvbW9pZCA9PSAnMycpIHsKICAgICAgICAgICAgICAgICAgICAgICAgcGl4X2lkID0gJzE2MDA0NmY3LTdhMjUtNmUwMS0xM2E1LTJjY2I1OTA2NjBkNCc7CiAgICAgICAgICAgICAgICAgICAgICAgIHR5cGUgPSAnNCc7CiAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgICAgIGlmIChtYXJrZXRpbmdVRE8ucHJvbW9pZCA9PSAnNycgJiYgbWFya2V0aW5nc2NEYXRhT2JqLm1vZHVsZS5pbmNsdWRlcygnY29uZmlndXJhdG9yJykpIHsKICAgICAgICAgICAgICAgICAgICAgICAgcGl4X2lkID0gJzQ1NjRlY2VhLWFkM2MtM2U1NC1lY2YzLWFlODcxNGFjOWIzNyc7CiAgICAgICAgICAgICAgICAgICAgICAgIHR5cGUgPSAnNCc7CiAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgICAgIGlmIChtYXJrZXRpbmdVRE8ucHJvbW9pZCA9PSAnNCcpIHsKICAgICAgICAgICAgICAgICAgICAgICAgcGl4X2lkID0gJ2I5ZjdhMzViLTc4YjktNTg4Ny1mZjEzLTlkYTRiZTIyOGQ3OSc7CiAgICAgICAgICAgICAgICAgICAgICAgIHR5cGUgPSAnNCc7CiAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgICAgIGlmIChtYXJrZXRpbmdVRE8ucHJvbW9pZCA9PSAnNScpIHsKICAgICAgICAgICAgICAgICAgICAgICAgcGl4X2lkID0gJzFmMDNhN2RlLWU2ZjMtNzc0Ny0wOTRiLTA5MWFmNDc5MDA2Mic7CiAgICAgICAgICAgICAgICAgICAgICAgIHR5cGUgPSAnNCc7CiAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgICAgIGlmIChtYXJrZXRpbmdVRE8ucHJvbW9pZCA9PSAnMicpIHsKICAgICAgICAgICAgICAgICAgICAgICAgcGl4X2lkID0gJ2E0NWY2ZWY1LWZiODEtYzBmYS0wY2QwLTQ4OWYxYWZiMzA3Mic7CiAgICAgICAgICAgICAgICAgICAgICAgIHR5cGUgPSAnNTUnOwogICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgICAgICBpZiAobWFya2V0aW5nVURPLnByb21vaWQgPT0gJzcnICYmIG1hcmtldGluZ3NjRGF0YU9iai5tb2R1bGUuaW5jbHVkZXMoJ3Byb2R1Y3RkZXRhaWwnKSkgewogICAgICAgICAgICAgICAgICAgICAgICBwaXhfaWQgPSAnYWYxNDI2NjItMzBhNy01MWE4LTIwOGYtNzZlYWJiZjNlMjljJzsKICAgICAgICAgICAgICAgICAgICAgICAgdHlwZSA9ICc1NCc7CiAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgaWYgKG1hcmtldGluZ1VETy5jYXRlZ29yeS5pbmNsdWRlcygnYWxpZW53YXJlJykgfHwgc2l0ZVVybC5pbmNsdWRlcygnYWxpZW53YXJlYXJlbmEuY29tJykpIHsKICAgICAgICAgICAgICAgICAgICBpZiAobWFya2V0aW5nVURPLnByb21vaWQgPT0gJzknKSB7CiAgICAgICAgICAgICAgICAgICAgICAgIHBpeF9pZCA9ICcwOGMyZDZkZi0yMWNmLTBmOWMtMThmMi04ZDU5MDdhNDU3YjEnOwogICAgICAgICAgICAgICAgICAgICAgICB0eXBlID0gJzEwJzsKICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICAgICAgaWYgKG1hcmtldGluZ1VETy5wcm9tb2lkID09ICczJykgewogICAgICAgICAgICAgICAgICAgICAgICBwaXhfaWQgPSAnZmNhOGM4ZTEtMTI5Yy04MDk0LWNmZjItY2UxMWZlZGM4MWFjJzsKICAgICAgICAgICAgICAgICAgICAgICAgdHlwZSA9ICc0JzsKICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICAgICAgaWYgKG1hcmtldGluZ1VETy5wcm9tb2lkID09ICc3JyAmJiBtYXJrZXRpbmdzY0RhdGFPYmoubW9kdWxlLmluY2x1ZGVzKCdjb25maWd1cmF0b3InKSkgewogICAgICAgICAgICAgICAgICAgICAgICBwaXhfaWQgPSAnMGEwYWEzYmQtODYyNS00NWM4LTBkNmItMmU4OTBhYTZiMGVlJzsKICAgICAgICAgICAgICAgICAgICAgICAgdHlwZSA9ICc0JzsKICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICAgICAgaWYgKG1hcmtldGluZ1VETy5wcm9tb2lkID09ICc0JykgewogICAgICAgICAgICAgICAgICAgICAgICBwaXhfaWQgPSAnM2Q2MWVmZGMtNjI1YS0yZjQwLWMxYmQtMjUxY2FiMjg3OWNkJzsKICAgICAgICAgICAgICAgICAgICAgICAgdHlwZSA9ICc0JzsKICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICAgICAgaWYgKG1hcmtldGluZ1VETy5wcm9tb2lkID09ICcyJykgewogICAgICAgICAgICAgICAgICAgICAgICBwaXhfaWQgPSAnNGUwMjg1NjQtN2EyYi05YWRjLTcwYTktMDZiNDBlMTRlMTI0JzsKICAgICAgICAgICAgICAgICAgICAgICAgdHlwZSA9ICc1NSc7CiAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgICAgIGlmIChtYXJrZXRpbmdVRE8ucHJvbW9pZCA9PSAnNycgJiYgbWFya2V0aW5nc2NEYXRhT2JqLm1vZHVsZS5pbmNsdWRlcygncHJvZHVjdGRldGFpbCcpKSB7CiAgICAgICAgICAgICAgICAgICAgICAgIHBpeF9pZCA9ICcwMzU5NmFjZS00M2JkLWIxYWUtMmY4MS0yNjNhYjQxYzE0ODYnOwogICAgICAgICAgICAgICAgICAgICAgICB0eXBlID0gJzU0JzsKICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICAgICAgaWYgKG1hcmtldGluZ1VETy5wcm9tb2lkID09ICcxJyB8fCBzaXRlVXJsLmluY2x1ZGVzKCdhbGllbndhcmVhcmVuYS5jb20nKSkgewogICAgICAgICAgICAgICAgICAgICAgICBwaXhfaWQgPSAnMTE3NTBhOGEtNjU4MC1mZDVmLTI4YzEtOWFmNjFiYzQzMTg4JzsKICAgICAgICAgICAgICAgICAgICAgICAgdHlwZSA9ICc0JzsKICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICBpZiAobWFya2V0aW5nVURPLmNhdGVnb3J5LmluY2x1ZGVzKCdnYW0nKSkgewogICAgICAgICAgICAgICAgICAgIGlmIChtYXJrZXRpbmdVRE8ucHJvbW9pZCA9PSAnOScpIHsKICAgICAgICAgICAgICAgICAgICAgICAgcGl4X2lkID0gJ2RlMmVmYmY1LTg3ZWQtZThiNC05MjFmLTUwNTQyZjMyYzc4MCc7CiAgICAgICAgICAgICAgICAgICAgICAgIHR5cGUgPSAnMTAnOwogICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgICAgICBpZiAobWFya2V0aW5nVURPLnByb21vaWQgPT0gJzEzJykgewogICAgICAgICAgICAgICAgICAgICAgICBwaXhfaWQgPSAnMjRlMDJiZGMtZGIxMi01NGI3LWY1MjAtZjFjMGM5ZDY2MWZiJzsKICAgICAgICAgICAgICAgICAgICAgICAgdHlwZSA9ICc0JzsKICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICAgICAgaWYgKG1hcmtldGluZ1VETy5wcm9tb2lkID09ICc3JyAmJiBtYXJrZXRpbmdzY0RhdGFPYmoubW9kdWxlLmluY2x1ZGVzKCdjb25maWd1cmF0b3InKSkgewogICAgICAgICAgICAgICAgICAgICAgICBwaXhfaWQgPSAnZDJkMGMzY2MtMTYyNS1kY2RmLTU4NzUtNTQ0MTNmZDVjMGFmJzsKICAgICAgICAgICAgICAgICAgICAgICAgdHlwZSA9ICc0JzsKICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICAgICAgaWYgKG1hcmtldGluZ1VETy5wcm9tb2lkID09ICc0JykgewogICAgICAgICAgICAgICAgICAgICAgICBwaXhfaWQgPSAnZDU4ODMyOWYtNWM5OS01MjEyLTU4YjAtNWI2YWYwYTVhZjZiJzsKICAgICAgICAgICAgICAgICAgICAgICAgdHlwZSA9ICc0JzsKICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICAgICAgaWYgKG1hcmtldGluZ1VETy5wcm9tb2lkID09ICcyJykgewogICAgICAgICAgICAgICAgICAgICAgICBwaXhfaWQgPSAnZWI2NTMwZTUtNTNjOS04NGUxLWI3MTgtNjA5YmQ3YjU2YzI5JzsKICAgICAgICAgICAgICAgICAgICAgICAgdHlwZSA9ICc1NSc7CiAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgICAgIGlmIChtYXJrZXRpbmdVRE8ucHJvbW9pZCA9PSAnNycgJiYgbWFya2V0aW5nc2NEYXRhT2JqLm1vZHVsZS5pbmNsdWRlcygncHJvZHVjdGRldGFpbCcpKSB7CiAgICAgICAgICAgICAgICAgICAgICAgIHBpeF9pZCA9ICc2MDg1NzdjMi02ODhmLTJkYTktODY0NS0xMGEzYjIwOWI2MjQnOwogICAgICAgICAgICAgICAgICAgICAgICB0eXBlID0gJzU0JzsKICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICBpZiAocGl4X2lkICYmIHR5cGUpIHsKICAgICAgICAgICAgICAgICAgICB2YXIgX3BpeCA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdfcGl4X2lkXycgKyBwaXhfaWQpOwogICAgICAgICAgICAgICAgICAgIGlmICghX3BpeCkKICAgICAgICAgICAgICAgICAgICAgICAgTWFya2V0aW5nLmltYWdlUmVxdWVzdCgnLy9zLmFtYXpvbi1hZHN5c3RlbS5jb20vaXVpMz9kPWZvcmVzdGVyLWRpZCZleC1mYXJncz0lM0ZpZCUzRCcgKyBwaXhfaWQgKyAnJTI2dHlwZSUzRCcgKyB0eXBlICsgJyUyNm0lM0QxJmV4LWZjaD00MTY2MTMmZXgtc3JjPScgKyBzaXRlVXJsICsgJyZleC1oYXJncz12JTNEMS4wJTNCYyUzRDUyNjc1OTI1NjA0MDElM0JwJTNEJyArIHBpeF9pZC50b1VwcGVyQ2FzZSgpKTsKICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgIE1hcmtldGluZy5VRE8ucGVyZlRpbWluZ0VuZCgncnVsZUlkLScgKyB0aGlzLmlkICsgJy1kZXBsb3ltZW50SWQtJyArIHRoaXMuZGVwbG95bWVudElkKTsKICAgICAgICAgICAgfSBjYXRjaCAoZSkgewogICAgICAgICAgICAgICAgZGVsbF9tYXJrZXRpbmdfdXRpbC5kZWJ1ZyhlKTsKICAgICAgICAgICAgfQogICAgICAgIH0sIDM2MDAyNjQsIFszNjA2MzI5XSwgNjYyNzI4LCBbNjEwMzIzXSk7CiAgICAgICAgTWFya2V0aW5nLmJpbmREZXBlbmRlbmN5RE9NUGFyc2VkKGZ1bmN0aW9uICgpIHsKICAgICAgICAgICAgdmFyIEJvb3RzdHJhcHBlciA9IHdpbmRvd1snTWFya2V0aW5nJ107CiAgICAgICAgICAgIHZhciBlbnNpZ2h0ZW5PcHRpb25zID0gTWFya2V0aW5nLmVuc2lnaHRlbk9wdGlvbnM7CiAgICAgICAgICAgIHRyeSB7CiAgICAgICAgICAgICAgICBNYXJrZXRpbmcuVURPLnBlcmZUaW1pbmdTdGFydCgncnVsZUlkLScgKyB0aGlzLmlkICsgJy1kZXBsb3ltZW50SWQtJyArIHRoaXMuZGVwbG95bWVudElkKTsKICAgICAgICAgICAgICAgIHZhciBmaXJlUGl4ZWwgPSBmdW5jdGlvbiAoKSB7CiAgICAgICAgICAgICAgICAgICAgY29uc3QgJF9fX29sZF84NDEzOTg2ZmJiNGRiMGVmID0ge30uY29uc3RydWN0b3IuZ2V0T3duUHJvcGVydHlEZXNjcmlwdG9yKHdpbmRvdywgJ3Nlc3Npb25TdG9yYWdlJyk7CiAgICAgICAgICAgICAgICAgICAgdHJ5IHsKICAgICAgICAgICAgICAgICAgICAgICAgaWYgKCRfX19vbGRfODQxMzk4NmZiYjRkYjBlZikKICAgICAgICAgICAgICAgICAgICAgICAgICAgICh7fS5jb25zdHJ1Y3Rvci5kZWZpbmVQcm9wZXJ0eSh3aW5kb3csICdzZXNzaW9uU3RvcmFnZScsICRfX19tb2NrX2EyMGE1MDliNGU3NmNhMWQuc2Vzc2lvblN0b3JhZ2UpKTsKICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIGZ1bmN0aW9uICgpIHsKICAgICAgICAgICAgICAgICAgICAgICAgICAgIHZhciB1ZG8gPSBNYXJrZXRpbmcuVURPOwogICAgICAgICAgICAgICAgICAgICAgICAgICAgdmFyIGNhY2hlYnVzdGVyID0gTWF0aC5yYW5kb20oKSAqIDEwMDAwMDA7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAoTWFya2V0aW5nLlVETy5wcm9tb2lkID09ICcxMDAnIHx8IGxvY2F0aW9uLmhyZWYuaW5jbHVkZXMoJ3RoYW5reW91JykpCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgTWFya2V0aW5nLmltYWdlUmVxdWVzdCgnLy90Lm15dmlzdWFsaXEubmV0L2FjdGl2aXR5X3BpeGVsP3B0PWkmZXQ9YSZyPScgKyBjYWNoZWJ1c3RlciArICcmYWdvPTIxMiZhbz0xMDE4JnB4PTExMjkmb3JkPScgKyB1ZG8uZHBpZCArICcmcmV2ZW51ZT0nICsgdWRvLnJldmVudWUgKyAnJnUxPScgKyB1ZG8ub2dpZCArICcmdTI9JyArIHVkby5kcGlkICsgJyZvdGhlcmNvb2tpZV9pZD0nICsgdWRvLm1jbWlkKTsKICAgICAgICAgICAgICAgICAgICAgICAgICAgIGVsc2UKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBNYXJrZXRpbmcuaW5zZXJ0U2NyaXB0KCcvL3Z0Lm15dmlzdWFsaXEubmV0LzIvNE9qZk1NdjN6U01rMktPRFVFOGxlUSUzRCUzRC92dC0zMzUuanMnKTsKICAgICAgICAgICAgICAgICAgICAgICAgICAgIHZhciBodmVQaXhlbCA9ICcvL3QubXl2aXN1YWxpcS5uZXQvYWN0aXZpdHlfcGl4ZWw/cHQ9aSZldD1hJnI9JyArIGNhY2hlYnVzdGVyICsgJyZhZ289MjEyJmFvPTEwMTgmcHg9MTEzMCZvcmQ9JyArIHVkby5kcGlkICsgJyZvdGhlcmNvb2tpZV9pZD0nICsgdWRvLm1jbWlkOwogICAgICAgICAgICAgICAgICAgICAgICAgICAgdWRvLmh2ZV9iY292ZShodmVQaXhlbCk7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICB1ZG8uaHZlX2NoYXQoaHZlUGl4ZWwpOwogICAgICAgICAgICAgICAgICAgICAgICAgICAgdWRvLmh2ZV9jb250YWN0VXMoaHZlUGl4ZWwpOwogICAgICAgICAgICAgICAgICAgICAgICAgICAgdWRvLmh2ZV9kb3dubG9hZChodmVQaXhlbCk7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICB1ZG8uaHZlX21wdihodmVQaXhlbCk7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICB1ZG8uaHZlX3JmcV9zdWJtaXQoaHZlUGl4ZWwpOwogICAgICAgICAgICAgICAgICAgICAgICAgICAgdWRvLmh2ZV9zb2NpYWwoaHZlUGl4ZWwpOwogICAgICAgICAgICAgICAgICAgICAgICAgICAgdWRvLmh2ZV95dHViZShodmVQaXhlbCk7CiAgICAgICAgICAgICAgICAgICAgICAgIH0uYXBwbHkodGhpcywgYXJndW1lbnRzKTsKICAgICAgICAgICAgICAgICAgICB9IGZpbmFsbHkgewogICAgICAgICAgICAgICAgICAgICAgICBpZiAoJF9fX29sZF84NDEzOTg2ZmJiNGRiMGVmKQogICAgICAgICAgICAgICAgICAgICAgICAgICAgKHt9LmNvbnN0cnVjdG9yLmRlZmluZVByb3BlcnR5KHdpbmRvdywgJ3Nlc3Npb25TdG9yYWdlJywgJF9fX29sZF84NDEzOTg2ZmJiNGRiMGVmKSk7CiAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgfTsKICAgICAgICAgICAgICAgIGZpcmVQaXhlbCgpOwogICAgICAgICAgICAgICAgaWYgKE1hcmtldGluZy5zY0RhdGFPYmouY21zID09ICdvbHInKQogICAgICAgICAgICAgICAgICAgIHdpbmRvdy5hZGRFdmVudExpc3RlbmVyKCd1ZG9SZWFkeScsIGZ1bmN0aW9uICgpIHsKICAgICAgICAgICAgICAgICAgICAgICAgZmlyZVBpeGVsKCk7CiAgICAgICAgICAgICAgICAgICAgfSk7CiAgICAgICAgICAgICAgICBNYXJrZXRpbmcuVURPLnBlcmZUaW1pbmdFbmQoJ3J1bGVJZC0nICsgdGhpcy5pZCArICctZGVwbG95bWVudElkLScgKyB0aGlzLmRlcGxveW1lbnRJZCk7CiAgICAgICAgICAgIH0gY2F0Y2ggKGUpIHsKICAgICAgICAgICAgICAgIGRlbGxfbWFya2V0aW5nX3V0aWwuZGVidWcoZSk7CiAgICAgICAgICAgIH0KICAgICAgICB9LCAzNjA4Njc0LCBbMzYwNjMyOV0sIDY4Mzc1MSwgWzYxMDMyM10pOwogICAgICAgIE1hcmtldGluZy5iaW5kRGVwZW5kZW5jeURPTVBhcnNlZChmdW5jdGlvbiAoKSB7CiAgICAgICAgICAgIHZhciBCb290c3RyYXBwZXIgPSB3aW5kb3dbJ01hcmtldGluZyddOwogICAgICAgICAgICB2YXIgZW5zaWdodGVuT3B0aW9ucyA9IE1hcmtldGluZy5lbnNpZ2h0ZW5PcHRpb25zOwogICAgICAgICAgICB0cnkgewogICAgICAgICAgICAgICAgTWFya2V0aW5nLlVETy5wZXJmVGltaW5nU3RhcnQoJ3J1bGVJZC0nICsgdGhpcy5pZCArICctZGVwbG95bWVudElkLScgKyB0aGlzLmRlcGxveW1lbnRJZCk7CiAgICAgICAgICAgICAgICBpZiAoTWFya2V0aW5nLlVETy5wcm9tb2lkICE9PSAnMTAwJykgewogICAgICAgICAgICAgICAgICAgIHdpbmRvdy5hOSA9IHt9OwogICAgICAgICAgICAgICAgICAgIGE5LmV2ZW50VHlwZSA9ICd2aXNpdG9yJzsKICAgICAgICAgICAgICAgICAgICBhOS5zZWdtZW50TnVtYmVyID0gJzAnOwogICAgICAgICAgICAgICAgICAgIGE5LnNlZ21lbnROYW1lID0gJ1NpdGUgVmlzaXRvcic7CiAgICAgICAgICAgICAgICAgICAgaWYgKC9hbGllbndhcmUvaS50ZXN0KE1hcmtldGluZy5VRE8uY2F0ZWdvcnkgfHwgTWFya2V0aW5nLlVETy5mYW1pbHkgfHwgTWFya2V0aW5nLlVETy5wcm9kdWN0KSkgewogICAgICAgICAgICAgICAgICAgICAgICBhOS5jbGllbnROYW1lID0gJ0RlbGwlMjBBbGllbndhcmUnOwogICAgICAgICAgICAgICAgICAgICAgICBhOS5jbGllbnRJRCA9ICc3OTM4NjMnOwogICAgICAgICAgICAgICAgICAgIH0gZWxzZSBpZiAoTWFya2V0aW5nLlVETy5zZWdtZW50ID09ICdkaHMnKSB7CiAgICAgICAgICAgICAgICAgICAgICAgIGE5LmNsaWVudE5hbWUgPSAnRGVsbCUyMENvbnN1bWVyJzsKICAgICAgICAgICAgICAgICAgICAgICAgYTkuY2xpZW50SUQgPSAnNzkzODczJzsKICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICAgICAgaWYgKEpTT04uc3RyaW5naWZ5KGE5KSAhPT0gJ3t9JyAmJiBhOS5jbGllbnROYW1lICYmIGE5LmNsaWVudElEICYmIGE5LmV2ZW50VHlwZSAmJiBhOS5zZWdtZW50TnVtYmVyICYmIGE5LnNlZ21lbnROYW1lKQogICAgICAgICAgICAgICAgICAgICAgICBNYXJrZXRpbmcuaW5zZXJ0U2NyaXB0KCcvL2EudHJpYmFsZnVzaW9uLmNvbS9waXhlbC90YWdzLycgKyBhOS5jbGllbnROYW1lICsgJy8nICsgYTkuY2xpZW50SUQgKyAnL3BpeGVsLmpzJyk7CiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICBNYXJrZXRpbmcuVURPLnBlcmZUaW1pbmdFbmQoJ3J1bGVJZC0nICsgdGhpcy5pZCArICctZGVwbG95bWVudElkLScgKyB0aGlzLmRlcGxveW1lbnRJZCk7CiAgICAgICAgICAgIH0gY2F0Y2ggKGUpIHsKICAgICAgICAgICAgICAgIGRlbGxfbWFya2V0aW5nX3V0aWwuZGVidWcoZSk7CiAgICAgICAgICAgIH0KICAgICAgICB9LCAzNTgyNDc0LCBbMzYwNjMyOV0sIDY5MjcxOCwgWzYxMDMyM10pOwogICAgICAgIE1hcmtldGluZy5iaW5kRGVwZW5kZW5jeURPTVBhcnNlZChmdW5jdGlvbiAoKSB7CiAgICAgICAgICAgIHZhciBCb290c3RyYXBwZXIgPSB3aW5kb3dbJ01hcmtldGluZyddOwogICAgICAgICAgICB2YXIgZW5zaWdodGVuT3B0aW9ucyA9IE1hcmtldGluZy5lbnNpZ2h0ZW5PcHRpb25zOwogICAgICAgICAgICB0cnkgewogICAgICAgICAgICAgICAgTWFya2V0aW5nLlVETy5wZXJmVGltaW5nU3RhcnQoJ3J1bGVJZC0nICsgdGhpcy5pZCArICctZGVwbG95bWVudElkLScgKyB0aGlzLmRlcGxveW1lbnRJZCk7CiAgICAgICAgICAgICAgICB2YXIgbWFya2V0aW5nVURPID0gTWFya2V0aW5nLlVETzsKICAgICAgICAgICAgICAgIHZhciBtYXJrZXRpbmdzY0RhdGFPYmogPSBNYXJrZXRpbmcuc2NEYXRhT2JqOwogICAgICAgICAgICAgICAgKGZ1bmN0aW9uICh3LCBkLCB0LCByLCB1KSB7CiAgICAgICAgICAgICAgICAgICAgd1t1XSA9IHdbdV0gfHwgW107CiAgICAgICAgICAgICAgICAgICAgd1t1XS5wdXNoKHsKICAgICAgICAgICAgICAgICAgICAgICAgJ3Byb2plY3RJZCc6ICcxMDAwMCcsCiAgICAgICAgICAgICAgICAgICAgICAgICdwcm9wZXJ0aWVzJzogeyAncGl4ZWxJZCc6ICcxMDA5NDYyMycgfQogICAgICAgICAgICAgICAgICAgIH0pOwogICAgICAgICAgICAgICAgICAgIHZhciBzID0gZC5jcmVhdGVFbGVtZW50KHQpOwogICAgICAgICAgICAgICAgICAgIHMuc3JjID0gcjsKICAgICAgICAgICAgICAgICAgICBzLmFzeW5jID0gdHJ1ZTsKICAgICAgICAgICAgICAgICAgICBzLm9ubG9hZCA9IHMub25yZWFkeXN0YXRlY2hhbmdlID0gZnVuY3Rpb24gKCkgewogICAgICAgICAgICAgICAgICAgICAgICB2YXIgeSwgcnMgPSB0aGlzLnJlYWR5U3RhdGUsIGMgPSB3W3VdOwogICAgICAgICAgICAgICAgICAgICAgICBpZiAocnMgJiYgcnMgIT0gJ2NvbXBsZXRlJyAmJiBycyAhPSAnbG9hZGVkJykKICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybjsKICAgICAgICAgICAgICAgICAgICAgICAgdHJ5IHsKICAgICAgICAgICAgICAgICAgICAgICAgICAgIHkgPSBZQUhPTy55d2EuSTEzTi5maXJlQmVhY29uOwogICAgICAgICAgICAgICAgICAgICAgICAgICAgd1t1XSA9IFtdOwogICAgICAgICAgICAgICAgICAgICAgICAgICAgd1t1XS5wdXNoID0gZnVuY3Rpb24gKHApIHsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB5KFtwXSk7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9OwogICAgICAgICAgICAgICAgICAgICAgICAgICAgeShjKTsKICAgICAgICAgICAgICAgICAgICAgICAgfSBjYXRjaCAoZSkgewogICAgICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICAgICAgfTsKICAgICAgICAgICAgICAgICAgICB2YXIgc2NyID0gZC5nZXRFbGVtZW50c0J5VGFnTmFtZSh0KVswXSwgcGFyID0gc2NyLnBhcmVudE5vZGU7CiAgICAgICAgICAgICAgICAgICAgaWYgKE1hcmtldGluZy5zY0RhdGFPYmoucGFnZSAhPSAnY29uZmlybWF0aW9uJyB8fCBNYXJrZXRpbmcuc2NEYXRhT2JqLnBhZ2UgPT0gJ2NvbmZpcm1hdGlvbicpCiAgICAgICAgICAgICAgICAgICAgICAgIHBhci5pbnNlcnRCZWZvcmUocywgc2NyKTsKICAgICAgICAgICAgICAgIH0od2luZG93LCBkb2N1bWVudCwgJ3NjcmlwdCcsICdodHRwczovL3MueWltZy5jb20vd2kveXRjLmpzJywgJ2RvdHEnKSk7CiAgICAgICAgICAgICAgICB3aW5kb3cuZG90cSA9IHdpbmRvdy5kb3RxIHx8IFtdOwogICAgICAgICAgICAgICAgdmFyIGVjVmFsdWUgPSAnJywgcXN0cmluZ1BhcmFtID0ge307CiAgICAgICAgICAgICAgICBpZiAobWFya2V0aW5nc2NEYXRhT2JqLmNhdGVnb3J5aWQuaW5jbHVkZXMoJ2dhbScpIHx8IG1hcmtldGluZ3NjRGF0YU9iai5jYXRlZ29yeWlkLmluY2x1ZGVzKCdnLXNlcmllcycpIHx8IG1hcmtldGluZ3NjRGF0YU9iai5wYWdlLmluY2x1ZGVzKCdhbGllbndhcmUnKSB8fCBtYXJrZXRpbmdzY0RhdGFPYmouY2F0ZWdvcnlpZC5pbmNsdWRlcygnYWxpZW53YXJlJykpCiAgICAgICAgICAgICAgICAgICAgZWNWYWx1ZSA9IG1hcmtldGluZ1VETy5wcm9tb2lkID09ICcxMDAnID8gJ2dhbWluZycgOiAnZ2FtJzsKICAgICAgICAgICAgICAgIGVsc2UgaWYgKG1hcmtldGluZ1VETy5zZWdtZW50ID09ICdkaHMnKQogICAgICAgICAgICAgICAgICAgIGVjVmFsdWUgPSBtYXJrZXRpbmdVRE8ucHJvbW9pZCA9PSAnMTAwJyA/ICdjb25zdW1lcmNvbnZlcnNpb24nIDogJ2Nvbic7CiAgICAgICAgICAgICAgICBlbHNlIGlmIChtYXJrZXRpbmdVRE8uc2VnbWVudCA9PSAnYnNkJykKICAgICAgICAgICAgICAgICAgICBlY1ZhbHVlID0gbWFya2V0aW5nVURPLnByb21vaWQgPT0gJzEwMCcgPyAncHVyY2hhc2UnIDogJ3NicnRnJzsKICAgICAgICAgICAgICAgIGVsc2UgaWYgKG1hcmtldGluZ1VETy5zZWdtZW50ID09ICdlZXAnKQogICAgICAgICAgICAgICAgICAgIGVjVmFsdWUgPSBtYXJrZXRpbmdVRE8ucHJvbW9pZCA9PSAnMTAwJyA/ICdtcHBjb252ZXJzaW9uJyA6ICdtZW1iZXInOwogICAgICAgICAgICAgICAgaWYgKG1hcmtldGluZ1VETy5wcm9tb2lkID09ICcxMDAnKQogICAgICAgICAgICAgICAgICAgIGlmIChtYXJrZXRpbmdVRE8uc2VnbWVudCA9PSAnZGhzJyB8fCBtYXJrZXRpbmdVRE8uc2VnbWVudCA9PSAnYnNkJykKICAgICAgICAgICAgICAgICAgICAgICAgcXN0cmluZ1BhcmFtID0gewogICAgICAgICAgICAgICAgICAgICAgICAgICAgJ2V0JzogJ2N1c3RvbScsCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAnZWMnOiBlY1ZhbHVlLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgJ2VhJzogJ1B1cmNoYXNlJywKICAgICAgICAgICAgICAgICAgICAgICAgICAgICdwcm9kdWN0X2lkJzogbWFya2V0aW5nVURPLm9yZGVyY29kZSwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICdndic6IG1hcmtldGluZ1VETy5yZXZlbnVlCiAgICAgICAgICAgICAgICAgICAgICAgIH07CiAgICAgICAgICAgICAgICAgICAgZWxzZQogICAgICAgICAgICAgICAgICAgICAgICBxc3RyaW5nUGFyYW0gPSB7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAnZXQnOiAnY3VzdG9tJywKICAgICAgICAgICAgICAgICAgICAgICAgICAgICdlYyc6IGVjVmFsdWUsCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAnZ3YnOiBtYXJrZXRpbmdVRE8ucmV2ZW51ZQogICAgICAgICAgICAgICAgICAgICAgICB9OwogICAgICAgICAgICAgICAgZWxzZQogICAgICAgICAgICAgICAgICAgIHFzdHJpbmdQYXJhbSA9IHsKICAgICAgICAgICAgICAgICAgICAgICAgJ2V0JzogJ2N1c3RvbScsCiAgICAgICAgICAgICAgICAgICAgICAgICdlYyc6IGVjVmFsdWUKICAgICAgICAgICAgICAgICAgICB9OwogICAgICAgICAgICAgICAgaWYgKG1hcmtldGluZ1VETy5wcm9tb2lkID09ICc3JykKICAgICAgICAgICAgICAgICAgICBpZiAobWFya2V0aW5nVURPLnNlZ21lbnQgPT0gJ2RocycgfHwgbWFya2V0aW5nVURPLnNlZ21lbnQgPT0gJ2JzZCcpCiAgICAgICAgICAgICAgICAgICAgICAgIHFzdHJpbmdQYXJhbSA9IHsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICdldCc6ICdjdXN0b20nLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgJ2VhJzogJ1ZpZXdQcm9kdWN0JywKICAgICAgICAgICAgICAgICAgICAgICAgICAgICdwcm9kdWN0X2lkJzogbWFya2V0aW5nVURPLm9yZGVyY29kZSwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICdlYyc6IGVjVmFsdWUKICAgICAgICAgICAgICAgICAgICAgICAgfTsKICAgICAgICAgICAgICAgIGlmIChtYXJrZXRpbmdVRE8ucHJvbW9pZCA9PSAnOScpCiAgICAgICAgICAgICAgICAgICAgaWYgKG1hcmtldGluZ1VETy5zZWdtZW50ID09ICdkaHMnIHx8IG1hcmtldGluZ1VETy5zZWdtZW50ID09ICdic2QnKQogICAgICAgICAgICAgICAgICAgICAgICBxc3RyaW5nUGFyYW0gPSB7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAnZXQnOiAnY3VzdG9tJywKICAgICAgICAgICAgICAgICAgICAgICAgICAgICdlYSc6ICdBZGRUb0NhcnQnLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgJ3Byb2R1Y3RfaWQnOiBtYXJrZXRpbmdVRE8ub3JkZXJjb2RlLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgJ2VjJzogZWNWYWx1ZQogICAgICAgICAgICAgICAgICAgICAgICB9OwogICAgICAgICAgICAgICAgaWYgKGVjVmFsdWUgIT09ICcnKQogICAgICAgICAgICAgICAgICAgIHdpbmRvdy5kb3RxLnB1c2goewogICAgICAgICAgICAgICAgICAgICAgICAncHJvamVjdElkJzogJzEwMDAwJywKICAgICAgICAgICAgICAgICAgICAgICAgJ3Byb3BlcnRpZXMnOiB7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAncGl4ZWxJZCc6ICcxMDA5NDYyMycsCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAncXN0cmluZ3MnOiBxc3RyaW5nUGFyYW0KICAgICAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgICAgIH0pOwogICAgICAgICAgICAgICAgTWFya2V0aW5nLlVETy5wZXJmVGltaW5nRW5kKCdydWxlSWQtJyArIHRoaXMuaWQgKyAnLWRlcGxveW1lbnRJZC0nICsgdGhpcy5kZXBsb3ltZW50SWQpOwogICAgICAgICAgICB9IGNhdGNoIChlKSB7CiAgICAgICAgICAgICAgICBkZWxsX21hcmtldGluZ191dGlsLmRlYnVnKGUpOwogICAgICAgICAgICB9CiAgICAgICAgfSwgMzU5MzMwMCwgWzM2MDYzMjldLCA2MzIzMTcsIFs2MTAzMjNdKTsKICAgIH0oKSkKfQ=="},{"name":"sugarcoat-734d7527fc54bd38411660873e25d16d00ba55e8","aliases":[],"kind":{"mime":"application/javascript"},"content":"ewogICAgY29uc3QgJF9fX21vY2tfYTIwYTUwOWI0ZTc2Y2ExZCA9IHt9OwogICAgKGV4cG9ydHMgPT4gewogICAgICAgICd1c2Ugc3RyaWN0JzsKICAgICAgICBsZXQgaXNTZWFsZWQgPSBmYWxzZTsKICAgICAgICBjbGFzcyBTdG9yYWdlIHsKICAgICAgICAgICAgY29uc3RydWN0b3IoKSB7CiAgICAgICAgICAgICAgICBpZiAoaXNTZWFsZWQpIHsKICAgICAgICAgICAgICAgICAgICB0aHJvdyBuZXcgVHlwZUVycm9yKCdJbGxlZ2FsIGNvbnN0cnVjdG9yJyk7CiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgIH0KICAgICAgICAgICAgZ2V0IGxlbmd0aCgpIHsKICAgICAgICAgICAgICAgIHJldHVybiBPYmplY3Qua2V5cyh0aGlzKS5sZW5ndGg7CiAgICAgICAgICAgIH0KICAgICAgICAgICAga2V5KGluZGV4KSB7CiAgICAgICAgICAgICAgICBjb25zdCBrZXlzID0gT2JqZWN0LmtleXModGhpcyk7CiAgICAgICAgICAgICAgICBpZiAoaW5kZXggPCAwIHx8IGluZGV4ID49IGtleXMubGVuZ3RoKSB7CiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIG51bGw7CiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICByZXR1cm4ga2V5c1tpbmRleF07CiAgICAgICAgICAgIH0KICAgICAgICAgICAgZ2V0SXRlbShrZXkpIHsKICAgICAgICAgICAgICAgIHJldHVybiBPYmplY3QucHJvdG90eXBlLmhhc093blByb3BlcnR5LmNhbGwodGhpcywga2V5KSA/IHRoaXNba2V5XSA6IG51bGw7CiAgICAgICAgICAgIH0KICAgICAgICAgICAgc2V0SXRlbShrZXksIHZhbHVlKSB7CiAgICAgICAgICAgICAgICB0aGlzW2tleV0gPSBTdHJpbmcodmFsdWUpOwogICAgICAgICAgICB9CiAgICAgICAgICAgIHJlbW92ZUl0ZW0oa2V5KSB7CiAgICAgICAgICAgICAgICBkZWxldGUgdGhpc1trZXldOwogICAgICAgICAgICB9CiAgICAgICAgICAgIGNsZWFyKCkgewogICAgICAgICAgICAgICAgY29uc3Qga2V5cyA9IE9iamVjdC5rZXlzKHRoaXMpOwogICAgICAgICAgICAgICAgZm9yIChjb25zdCBrZXkgb2Yga2V5cykgewogICAgICAgICAgICAgICAgICAgIGRlbGV0ZSB0aGlzW2tleV07CiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgIH0KICAgICAgICB9CiAgICAgICAgZXhwb3J0cy5TdG9yYWdlID0gewogICAgICAgICAgICBjb25maWd1cmFibGU6IHRydWUsCiAgICAgICAgICAgIGVudW1lcmFibGU6IHRydWUsCiAgICAgICAgICAgIHZhbHVlOiBTdG9yYWdlLAogICAgICAgICAgICB3cml0YWJsZTogdHJ1ZQogICAgICAgIH07CiAgICAgICAgY29uc3QgbG9jYWxTdG9yYWdlID0gbmV3IFN0b3JhZ2UoKTsKICAgICAgICBleHBvcnRzLmxvY2FsU3RvcmFnZSA9IHsKICAgICAgICAgICAgY29uZmlndXJhYmxlOiB0cnVlLAogICAgICAgICAgICBlbnVtZXJhYmxlOiB0cnVlLAogICAgICAgICAgICBnZXQoKSB7CiAgICAgICAgICAgICAgICByZXR1cm4gbG9jYWxTdG9yYWdlOwogICAgICAgICAgICB9CiAgICAgICAgfTsKICAgICAgICBjb25zdCBzZXNzaW9uU3RvcmFnZSA9IG5ldyBTdG9yYWdlKCk7CiAgICAgICAgZXhwb3J0cy5zZXNzaW9uU3RvcmFnZSA9IHsKICAgICAgICAgICAgY29uZmlndXJhYmxlOiB0cnVlLAogICAgICAgICAgICBlbnVtZXJhYmxlOiB0cnVlLAogICAgICAgICAgICBnZXQoKSB7CiAgICAgICAgICAgICAgICByZXR1cm4gc2Vzc2lvblN0b3JhZ2U7CiAgICAgICAgICAgIH0KICAgICAgICB9OwogICAgICAgIGlzU2VhbGVkID0gdHJ1ZTsKICAgIH0pKCRfX19tb2NrX2EyMGE1MDliNGU3NmNhMWQpOwogICAgKGZ1bmN0aW9uICgpIHsKICAgICAgICBNYXJrZXRpbmcuYmluZERlcGVuZGVuY3lET01QYXJzZWQoZnVuY3Rpb24gKCkgewogICAgICAgICAgICB2YXIgQm9vdHN0cmFwcGVyID0gd2luZG93WydNYXJrZXRpbmcnXTsKICAgICAgICAgICAgdmFyIGVuc2lnaHRlbk9wdGlvbnMgPSBNYXJrZXRpbmcuZW5zaWdodGVuT3B0aW9uczsKICAgICAgICAgICAgdHJ5IHsKICAgICAgICAgICAgICAgIE1hcmtldGluZy5VRE8ucGVyZlRpbWluZ1N0YXJ0KCdydWxlSWQtJyArIHRoaXMuaWQgKyAnLWRlcGxveW1lbnRJZC0nICsgdGhpcy5kZXBsb3ltZW50SWQpOwogICAgICAgICAgICAgICAgdmFyIGdlbyA9IFsKICAgICAgICAgICAgICAgICAgICAnYXUnLAogICAgICAgICAgICAgICAgICAgICdueicsCiAgICAgICAgICAgICAgICAgICAgJ2luJywKICAgICAgICAgICAgICAgICAgICAnc2cnLAogICAgICAgICAgICAgICAgICAgICdteScsCiAgICAgICAgICAgICAgICAgICAgJ2pwJywKICAgICAgICAgICAgICAgICAgICAna3InCiAgICAgICAgICAgICAgICBdOwogICAgICAgICAgICAgICAgdmFyIHVybCA9ICd2MT0mdjI9JyArIE1hcmtldGluZy5VRE8uZGVhbHMgKyAnJnYzPSZzMT0nICsgd2luZG93LmxvY2F0aW9uLmhyZWYgKyAnJnMyPScgKyBkb2N1bWVudC5yZWZlcnJlciArICcmczM9JyArIE1hcmtldGluZy5VRE8ucHJvbW9pZDsKICAgICAgICAgICAgICAgIHZhciBmdWxsVXJsID0gJ3MxPScgKyB3aW5kb3cubG9jYXRpb24uaHJlZiArICcmczI9JyArIGRvY3VtZW50LnJlZmVycmVyICsgJyZzMz0nICsgTWFya2V0aW5nLlVETy5wcm9tb2lkICsgJyZzND0nICsgTWFya2V0aW5nLlVETy5yZXZlbnVlICsgJyZzNT0nICsgTWFya2V0aW5nLlVETy5wcm9kY2F0ICsgJyZzNz0nICsgTWFya2V0aW5nLlVETy5vcmRlcmNvZGUgKyAnJnM4PScgKyBNYXJrZXRpbmcuVURPLmNhdGVnb3J5ICsgJyZzOT0nICsgTWFya2V0aW5nLlVETy5mYW1pbHkgKyAnJnMxMD0nICsgTWFya2V0aW5nLlVETy5wcm9kdWN0ICsgJyZ2Mj0nICsgTWFya2V0aW5nLlVETy5kZWFscyArICcmdjU9JyArIE1hcmtldGluZy5zY0RhdGFPYmouY291bnRyeSArICcmdjY9JyArIE1hcmtldGluZy5zY0RhdGFPYmoubGFuZ3VhZ2UgKyAnJnY3PScgKyBNYXJrZXRpbmcuVURPLmNzZWcgKyAnJnY4PScgKyBNYXJrZXRpbmcuc2NEYXRhT2JqLnNlZ21lbnQgKyAnJnY5PScgKyBNYXJrZXRpbmcuVURPLnBsYXRmb3JtICsgJyZ2MTA9JyArIE1hcmtldGluZy5VRE8uZHBpZDsKICAgICAgICAgICAgICAgIGlmIChnZW8uaW5kZXhPZihEZWxsLk1ldHJpY3Muc2MuY291bnRyeSkgPiAtMSkKICAgICAgICAgICAgICAgICAgICBNYXJrZXRpbmcuaW5zZXJ0U2NyaXB0KCcvL3BpeGVsLm1hdGh0YWcuY29tL2V2ZW50L2pzP210X2lkPTEzNjc0NDcmbXRfYWRpZD0xODkxNjYmbXRfZXhlbT0mJyArIGZ1bGxVcmwpOwogICAgICAgICAgICAgICAgaWYgKE1hcmtldGluZy5zY0RhdGFPYmouY291bnRyeSA9PSAnYXUnIHx8IE1hcmtldGluZy5zY0RhdGFPYmouY291bnRyeSA9PSAnbnonIHx8IE1hcmtldGluZy5zY0RhdGFPYmouY291bnRyeSA9PSAnaW4nIHx8IE1hcmtldGluZy5zY0RhdGFPYmouY291bnRyeSA9PSAnanAnKQogICAgICAgICAgICAgICAgICAgIE1hcmtldGluZy5pbnNlcnRTY3JpcHQoJy8vcGl4ZWwubWF0aHRhZy5jb20vZXZlbnQvanM/bXRfaWQ9MTMyNTM2NSZtdF9hZGlkPTE4OTE2NiZtdF9leGVtPSYnICsgdXJsKTsKICAgICAgICAgICAgICAgIGlmIChNYXJrZXRpbmcuc2NEYXRhT2JqLmNvdW50cnkgPT0gJ2F1JyB8fCBNYXJrZXRpbmcuc2NEYXRhT2JqLmNvdW50cnkgPT0gJ256JykKICAgICAgICAgICAgICAgICAgICBNYXJrZXRpbmcuaW5zZXJ0U2NyaXB0KCcvL3BpeGVsLm1hdGh0YWcuY29tL2V2ZW50L2ltZz9tdF9pZD0xMzM4NDc5Jm10X2FkaWQ9MTg5MTY2Jm10X2V4ZW09Jm10X2V4Y2w9JicgKyB1cmwgKyAnJm9yZD0lbicpOwogICAgICAgICAgICAgICAgaWYgKE1hcmtldGluZy5zY0RhdGFPYmouY291bnRyeSA9PSAnanAnKQogICAgICAgICAgICAgICAgICAgIE1hcmtldGluZy5pbnNlcnRTY3JpcHQoJy8vcGl4ZWwubWF0aHRhZy5jb20vZXZlbnQvanM/bXRfaWQ9MTMzODQ4MiZtdF9hZGlkPTE4OTE2NiZtdF9leGVtPSZtdF9leGNsPSYnICsgdXJsKTsKICAgICAgICAgICAgICAgIGlmIChNYXJrZXRpbmcuc2NEYXRhT2JqLmNvdW50cnkgPT0gJ2luJykKICAgICAgICAgICAgICAgICAgICBNYXJrZXRpbmcuaW5zZXJ0U2NyaXB0KCcvL3BpeGVsLm1hdGh0YWcuY29tL2V2ZW50L2pzP210X2lkPTEzMzg0ODEmbXRfYWRpZD0xODkxNjYmbXRfZXhlbT0mbXRfZXhjbD0mJyArIHVybCk7CiAgICAgICAgICAgICAgICBNYXJrZXRpbmcuVURPLnBlcmZUaW1pbmdFbmQoJ3J1bGVJZC0nICsgdGhpcy5pZCArICctZGVwbG95bWVudElkLScgKyB0aGlzLmRlcGxveW1lbnRJZCk7CiAgICAgICAgICAgIH0gY2F0Y2ggKGUpIHsKICAgICAgICAgICAgICAgIGRlbGxfbWFya2V0aW5nX3V0aWwuZGVidWcoZSk7CiAgICAgICAgICAgIH0KICAgICAgICB9LCAzNjAwMjc0LCBbCiAgICAgICAgICAgIDM1MDY5MjQsCiAgICAgICAgICAgIDM2MDYzMjkKICAgICAgICBdLCA2MDk4MjAsIFsKICAgICAgICAgICAgNjEwMzEwLAogICAgICAgICAgICA2MTAzMjMKICAgICAgICBdKTsKICAgICAgICBNYXJrZXRpbmcuYmluZERlcGVuZGVuY3lET01QYXJzZWQoZnVuY3Rpb24gKCkgewogICAgICAgICAgICB2YXIgQm9vdHN0cmFwcGVyID0gd2luZG93WydNYXJrZXRpbmcnXTsKICAgICAgICAgICAgdmFyIGVuc2lnaHRlbk9wdGlvbnMgPSBNYXJrZXRpbmcuZW5zaWdodGVuT3B0aW9uczsKICAgICAgICAgICAgdHJ5IHsKICAgICAgICAgICAgICAgIE1hcmtldGluZy5VRE8ucGVyZlRpbWluZ1N0YXJ0KCdydWxlSWQtJyArIHRoaXMuaWQgKyAnLWRlcGxveW1lbnRJZC0nICsgdGhpcy5kZXBsb3ltZW50SWQpOwogICAgICAgICAgICAgICAgaWYgKE1hcmtldGluZy5VRE8ucHJpb3Jjb25zZW50KSB7CiAgICAgICAgICAgICAgICAgICAgdmFyIG1hcmtldGluZ3NjRGF0YU9iaiA9IE1hcmtldGluZy5zY0RhdGFPYmo7CiAgICAgICAgICAgICAgICAgICAgdmFyIG1hcmtldGluZ1VETyA9IE1hcmtldGluZy5VRE87CiAgICAgICAgICAgICAgICAgICAgdmFyIHNlZ0lEID0gJyc7CiAgICAgICAgICAgICAgICAgICAgdmFyIHBpeGVsSUQgPSAnJzsKICAgICAgICAgICAgICAgICAgICBpZiAobWFya2V0aW5nc2NEYXRhT2JqLnNlZ21lbnQgPT0gJ2JzZCcpCiAgICAgICAgICAgICAgICAgICAgICAgIGlmIChtYXJrZXRpbmdzY0RhdGFPYmoucGFnZSA9PSAnY29uZmlybWF0aW9uJykgewogICAgICAgICAgICAgICAgICAgICAgICAgICAgc2VnSUQgPSAnaWQ9MTExODM3MSZzZWc9MTgwMTc4NzMnOwogICAgICAgICAgICAgICAgICAgICAgICAgICAgcGl4ZWxJRCA9ICcxMTE4MzcxJzsKICAgICAgICAgICAgICAgICAgICAgICAgfSBlbHNlIHsKICAgICAgICAgICAgICAgICAgICAgICAgICAgIHNlZ0lEID0gJ2lkPTEwOTY5NTEmc2VnPTE3NTUyODIyJzsKICAgICAgICAgICAgICAgICAgICAgICAgICAgIHBpeGVsSUQgPSAnMTA5Njk1MSc7CiAgICAgICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgICAgICBpZiAobWFya2V0aW5nc2NEYXRhT2JqLnNlZ21lbnQgPT0gJ2RocycpCiAgICAgICAgICAgICAgICAgICAgICAgIGlmIChtYXJrZXRpbmdzY0RhdGFPYmoucGFnZSA9PSAnY29uZmlybWF0aW9uJykgewogICAgICAgICAgICAgICAgICAgICAgICAgICAgc2VnSUQgPSAnaWQ9MTAyMDMxMCZzZWc9MTQxNTEyNjEnOwogICAgICAgICAgICAgICAgICAgICAgICAgICAgcGl4ZWxJRCA9ICcxMDIwMzEwJzsKICAgICAgICAgICAgICAgICAgICAgICAgfSBlbHNlIHsKICAgICAgICAgICAgICAgICAgICAgICAgICAgIHNlZ0lEID0gJ2lkPTEwMjAyNzgmc2VnPTE0MTQ5MTk1JzsKICAgICAgICAgICAgICAgICAgICAgICAgICAgIHBpeGVsSUQgPSAnMTAyMDI3OCc7CiAgICAgICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgICAgICBpZiAobWFya2V0aW5nc2NEYXRhT2JqLnNlZ21lbnQgPT0gJ2VlcCcpCiAgICAgICAgICAgICAgICAgICAgICAgIGlmIChtYXJrZXRpbmdzY0RhdGFPYmoucGFnZSA9PSAnY29uZmlybWF0aW9uJykgewogICAgICAgICAgICAgICAgICAgICAgICAgICAgc2VnSUQgPSAnaWQ9MTE4NDI4MSZzZWc9MTk3Mzk4MTQnOwogICAgICAgICAgICAgICAgICAgICAgICAgICAgcGl4ZWxJRCA9ICcxMTg0MjgxJzsKICAgICAgICAgICAgICAgICAgICAgICAgfSBlbHNlIHsKICAgICAgICAgICAgICAgICAgICAgICAgICAgIHNlZ0lEID0gJ2lkPTExODQyNzUmc2VnPTE5NzM5NzMwJzsKICAgICAgICAgICAgICAgICAgICAgICAgICAgIHBpeGVsSUQgPSAnMTE4NDI3NSc7CiAgICAgICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgICAgICBpZiAobWFya2V0aW5nc2NEYXRhT2JqLmNtcyA9PSAnZGVsbGVtYycgfHwgbWFya2V0aW5nc2NEYXRhT2JqLmNtcyA9PSAnZGVsbHRlY2gnIHx8IG1hcmtldGluZ3NjRGF0YU9iai5jbXMgPT0gJ29scicpCiAgICAgICAgICAgICAgICAgICAgICAgIGlmIChtYXJrZXRpbmdzY0RhdGFPYmouY21zID09ICdvbHInKSB7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICB2YXIgZmlyZVByZW1pZXJQaXhlbCA9IGZ1bmN0aW9uICgpIHsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAod2luZG93LmxvY2F0aW9uLmhyZWYuaW5jbHVkZXMoJy9jYXJ0L3RoYW5reW91JykgfHwgbWFya2V0aW5nVURPLnByb21vaWQgPT0gJzEwMCcpIHsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdmFyIGVuY29kZVVSTCA9IGVuY29kZVVSSUNvbXBvbmVudCgnaHR0cHM6Ly9waXhlbC5tZWRpYWlxZGlnaXRhbC5jb20vcGl4ZWw/dTE9JyArIG1hcmtldGluZ1VETy5jaWQgKyAnJnUyPScgKyBtYXJrZXRpbmdVRE8udHlwZSArICcmdTM9JnU0PSZ1NT0nICsgbWFya2V0aW5nVURPLmRpc2NvdW50ICsgJyZ1Nj0nICsgbWFya2V0aW5nVURPLmRwaWQgKyAnJnU3PScgKyBtYXJrZXRpbmdVRE8uY3VycmVuY3kgKyAnJnU4PScgKyBtYXJrZXRpbmdVRE8uY291cG9uICsgJyZ1OT0nICsgbWFya2V0aW5nVURPLnByb2RjYXQgKyAnJnUxMD0nICsgbWFya2V0aW5nVURPLmNvdW50cnkgKyAnJnUxMT0nICsgbWFya2V0aW5nVURPLmxhbmd1YWdlICsgJyZ1MTI9JyArIG1hcmtldGluZ1VETy5kZXZpY2UgKyAnJnUxMz0nICsgbWFya2V0aW5nVURPLnBsYXRmb3JtICsgJyZ1MTQ9JyArIG1hcmtldGluZ1VETy5wcm9tb2lkICsgJyZ1MTU9JyArIGVuY29kZVVSSUNvbXBvbmVudChtYXJrZXRpbmdVRE8uY2F0ZWdvcnkpICsgJyZ1MTY9JyArIG1hcmtldGluZ1VETy5kZWFscyArICcmdTE3PScgKyBlbmNvZGVVUklDb21wb25lbnQobWFya2V0aW5nVURPLmZhbWlseSkgKyAnJnUxOD0nICsgZW5jb2RlVVJJQ29tcG9uZW50KG1hcmtldGluZ1VETy5wcm9kdWN0KSArICcmdTE5PScgKyBtYXJrZXRpbmdVRE8ub3JkZXJjb2RlICsgJyZ1MjA9JyArIG1hcmtldGluZ1VETy5hY2NvdW50aWQgKyAnJnUyMT0nICsgSlNPTi5zdHJpbmdpZnkobWFya2V0aW5nVURPLnByb2R1Y3RsaXN0KSArICcmdTIyPScgKyBtYXJrZXRpbmdVRE8uY291bnRyeSArICcmcGl4ZWxfaWQ9MTE4NDI3NCZ1aWQ9JHtVSUR9Jyk7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIE1hcmtldGluZy5pbWFnZVJlcXVlc3QoJy8vc2VjdXJlLmFkbnhzLmNvbS9weD9pZD0xMTg0Mjc0JnNlZz0xOTczOTcwOCZvcmRlcl9pZD0nICsgbWFya2V0aW5nVURPLmRwaWQgKyAnJnZhbHVlPScgKyBtYXJrZXRpbmdVRE8ucmV2ZW51ZSArICcmcmVkaXI9JyArIGVuY29kZVVSTCArICcmdD0yJyk7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgICAgICAgICAgICAgfTsKICAgICAgICAgICAgICAgICAgICAgICAgICAgIGZpcmVQcmVtaWVyUGl4ZWwoKTsKICAgICAgICAgICAgICAgICAgICAgICAgICAgIHdpbmRvdy5hZGRFdmVudExpc3RlbmVyKCdoYXNoY2hhbmdlJywgZnVuY3Rpb24gKGUpIHsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBmaXJlUHJlbWllclBpeGVsKCk7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9KTsKICAgICAgICAgICAgICAgICAgICAgICAgfSBlbHNlIHsKICAgICAgICAgICAgICAgICAgICAgICAgICAgIHZhciBlbmNvZGVVUkwgPSBlbmNvZGVVUklDb21wb25lbnQoJ2h0dHBzOi8vcGl4ZWwubWVkaWFpcWRpZ2l0YWwuY29tL3BpeGVsP3UxPScgKyBtYXJrZXRpbmdVRE8uYWNjb3VudGlkICsgJyZ1Mj0nICsgZW5jb2RlVVJJQ29tcG9uZW50KG1hcmtldGluZ1VETy5jYXRlZ29yeSkgKyAnJnUzPScgKyBtYXJrZXRpbmdVRE8uY2F0ZWdvcnlwYXRoICsgJyZ1ND0nICsgbWFya2V0aW5nVURPLmNvdW50cnkgKyAnJnU1PScgKyBtYXJrZXRpbmdVRE8uY2lkICsgJyZ1Nj0nICsgbWFya2V0aW5nVURPLmxhbmd1YWdlICsgJyZ1Nz0nICsgZW5jb2RlVVJJQ29tcG9uZW50KG1hcmtldGluZ1VETy5mYW1pbHkpICsgJyZ1OD0nICsgbWFya2V0aW5nVURPLnByb2RjYXQgKyAnJnU5PScgKyBlbmNvZGVVUklDb21wb25lbnQobWFya2V0aW5nVURPLnByb2R1Y3QpICsgJyZwaXhlbF9pZD0xMTg0MjcwJnVpZD0ke1VJRH0nKTsKICAgICAgICAgICAgICAgICAgICAgICAgICAgIE1hcmtldGluZy5pbWFnZVJlcXVlc3QoJy8vc2VjdXJlLmFkbnhzLmNvbS9weD9pZD0xMTg0MjcwJnNlZz0xOTczOTcwMiZvcmRlcl9pZD0nICsgbWFya2V0aW5nVURPLmRwaWQgKyAnJnZhbHVlPScgKyBtYXJrZXRpbmdVRE8ucmV2ZW51ZSArICcmcmVkaXI9JyArIGVuY29kZVVSTCArICcmdD0yJyk7CiAgICAgICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgICAgICBpZiAoc2VnSUQgIT0gJycgJiYgcGl4ZWxJRCAhPSAnJykKICAgICAgICAgICAgICAgICAgICAgICAgaWYgKG1hcmtldGluZ3NjRGF0YU9iai5wYWdlID09ICdjb25maXJtYXRpb24nKSB7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICB2YXIgcmVkaXJlY3RVUkwgPSBlbmNvZGVVUklDb21wb25lbnQoJ2h0dHBzOi8vcGl4ZWwubWVkaWFpcWRpZ2l0YWwuY29tL3BpeGVsP3UxPScgKyBtYXJrZXRpbmdVRE8uY2lkICsgJyZ1Mj0nICsgbWFya2V0aW5nVURPLnR5cGUgKyAnJnUzPSZ1ND0mdTU9JyArIG1hcmtldGluZ1VETy5kaXNjb3VudCArICcmdTY9JyArIG1hcmtldGluZ1VETy5kcGlkICsgJyZ1Nz0nICsgbWFya2V0aW5nVURPLmN1cnJlbmN5ICsgJyZ1OD0nICsgbWFya2V0aW5nVURPLmNvdXBvbiArICcmdTk9JyArIG1hcmtldGluZ1VETy5wcm9kY2F0ICsgJyZ1MTA9JyArIG1hcmtldGluZ1VETy5jb3VudHJ5ICsgJyZ1MTE9JyArIG1hcmtldGluZ1VETy5sYW5ndWFnZSArICcmdTEyPScgKyBtYXJrZXRpbmdVRE8uZGV2aWNlICsgJyZ1MTM9JyArIG1hcmtldGluZ1VETy5wbGF0Zm9ybSArICcmdTE0PScgKyBtYXJrZXRpbmdVRE8ucHJvbW9pZCArICcmdTE1PScgKyBlbmNvZGVVUklDb21wb25lbnQobWFya2V0aW5nVURPLmNhdGVnb3J5KSArICcmdTE2PScgKyBtYXJrZXRpbmdVRE8uZGVhbHMgKyAnJnUxNz0nICsgZW5jb2RlVVJJQ29tcG9uZW50KG1hcmtldGluZ1VETy5mYW1pbHkpICsgJyZ1MTg9JyArIGVuY29kZVVSSUNvbXBvbmVudChtYXJrZXRpbmdVRE8ucHJvZHVjdCkgKyAnJnUxOT0nICsgbWFya2V0aW5nVURPLm9yZGVyY29kZSArICcmdTIwPScgKyBtYXJrZXRpbmdVRE8uYWNjb3VudGlkICsgJyZ1MjE9JyArIEpTT04uc3RyaW5naWZ5KG1hcmtldGluZ1VETy5wcm9kdWN0bGlzdCkgKyAnJnUyMj0nICsgbWFya2V0aW5nVURPLmNvdW50cnkgKyAnJnBpeGVsX2lkPScgKyBwaXhlbElEICsgJyZ1aWQ9JHtVSUR9Jyk7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICBNYXJrZXRpbmcuaW1hZ2VSZXF1ZXN0KCcvL3NlY3VyZS5hZG54cy5jb20vcHg/JyArIHNlZ0lEICsgJyZvcmRlcl9pZD0nICsgbWFya2V0aW5nVURPLmRwaWQgKyAnJnZhbHVlPScgKyBtYXJrZXRpbmdVRE8ucmV2ZW51ZSArICcmcmVkaXI9JyArIHJlZGlyZWN0VVJMICsgJyZ0PTInKTsKICAgICAgICAgICAgICAgICAgICAgICAgfSBlbHNlIHsKICAgICAgICAgICAgICAgICAgICAgICAgICAgIHZhciByZWRpcmVjdFVSTCA9IGVuY29kZVVSSUNvbXBvbmVudCgnaHR0cHM6Ly9waXhlbC5tZWRpYWlxZGlnaXRhbC5jb20vcGl4ZWw/dTE9JyArIG1hcmtldGluZ1VETy5hY2NvdW50aWQgKyAnJnUyPScgKyBlbmNvZGVVUklDb21wb25lbnQobWFya2V0aW5nVURPLmNhdGVnb3J5KSArICcmdTM9JyArIG1hcmtldGluZ1VETy5jYXRlZ29yeXBhdGggKyAnJnU0PScgKyBtYXJrZXRpbmdVRE8uY291bnRyeSArICcmdTU9JyArIG1hcmtldGluZ1VETy5jaWQgKyAnJnU2PScgKyBtYXJrZXRpbmdVRE8ubGFuZ3VhZ2UgKyAnJnU3PScgKyBlbmNvZGVVUklDb21wb25lbnQobWFya2V0aW5nVURPLmZhbWlseSkgKyAnJnU4PScgKyBtYXJrZXRpbmdVRE8ucHJvZGNhdCArICcmdTk9JyArIGVuY29kZVVSSUNvbXBvbmVudChtYXJrZXRpbmdVRE8ucHJvZHVjdCkgKyAnJnBpeGVsX2lkPScgKyBwaXhlbElEICsgJyZ1aWQ9JHtVSUR9Jyk7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICBNYXJrZXRpbmcuaW1hZ2VSZXF1ZXN0KCcvL3NlY3VyZS5hZG54cy5jb20vcHg/JyArIHNlZ0lEICsgJyZvcmRlcl9pZD0nICsgbWFya2V0aW5nVURPLmRwaWQgKyAnJnZhbHVlPScgKyBtYXJrZXRpbmdVRE8ucmV2ZW51ZSArICcmcmVkaXI9JyArIHJlZGlyZWN0VVJMICsgJyZ0PTInKTsKICAgICAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgTWFya2V0aW5nLlVETy5wZXJmVGltaW5nRW5kKCdydWxlSWQtJyArIHRoaXMuaWQgKyAnLWRlcGxveW1lbnRJZC0nICsgdGhpcy5kZXBsb3ltZW50SWQpOwogICAgICAgICAgICB9IGNhdGNoIChlKSB7CiAgICAgICAgICAgICAgICBkZWxsX21hcmtldGluZ191dGlsLmRlYnVnKGUpOwogICAgICAgICAgICB9CiAgICAgICAgfSwgMzU5MzM3OCwgWzM2MDYzMjldLCA2MzE3MDYsIFs2MTAzMjNdKTsKICAgICAgICBNYXJrZXRpbmcuYmluZERlcGVuZGVuY3lET01QYXJzZWQoZnVuY3Rpb24gKCkgewogICAgICAgICAgICBjb25zdCAkX19fb2xkXzNkZDFjM2EyODI0YWRkZTAgPSB7fS5jb25zdHJ1Y3Rvci5nZXRPd25Qcm9wZXJ0eURlc2NyaXB0b3Iod2luZG93LCAnc2Vzc2lvblN0b3JhZ2UnKTsKICAgICAgICAgICAgdHJ5IHsKICAgICAgICAgICAgICAgIGlmICgkX19fb2xkXzNkZDFjM2EyODI0YWRkZTApCiAgICAgICAgICAgICAgICAgICAgKHt9LmNvbnN0cnVjdG9yLmRlZmluZVByb3BlcnR5KHdpbmRvdywgJ3Nlc3Npb25TdG9yYWdlJywgJF9fX21vY2tfYTIwYTUwOWI0ZTc2Y2ExZC5zZXNzaW9uU3RvcmFnZSkpOwogICAgICAgICAgICAgICAgcmV0dXJuIGZ1bmN0aW9uICgpIHsKICAgICAgICAgICAgICAgICAgICB2YXIgQm9vdHN0cmFwcGVyID0gd2luZG93WydNYXJrZXRpbmcnXTsKICAgICAgICAgICAgICAgICAgICB2YXIgZW5zaWdodGVuT3B0aW9ucyA9IE1hcmtldGluZy5lbnNpZ2h0ZW5PcHRpb25zOwogICAgICAgICAgICAgICAgICAgIHRyeSB7CiAgICAgICAgICAgICAgICAgICAgICAgIE1hcmtldGluZy5VRE8ucGVyZlRpbWluZ1N0YXJ0KCdydWxlSWQtJyArIHRoaXMuaWQgKyAnLWRlcGxveW1lbnRJZC0nICsgdGhpcy5kZXBsb3ltZW50SWQpOwogICAgICAgICAgICAgICAgICAgICAgICBpZiAoTWFya2V0aW5nLlVETy5wcmlvcmNvbnNlbnQpIHsKICAgICAgICAgICAgICAgICAgICAgICAgICAgIHZhciBidWlsZFVybCA9IGZ1bmN0aW9uIChzcG90bmFtZSkgewogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiAnLy9waXhlbC5tYXRodGFnLmNvbS9ldmVudC9pbWc/bXRfaWQ9MTI1MjUzNyZtdF9hZGlkPTEyOTgwNSZtdF9leGVtPSZtdF9leGNsPSZ2MT0mdjI9JnYzPSZzMT0nICsgd2luZG93LmxvY2F0aW9uLmhyZWYgKyAnJnMyPScgKyB3aW5kb3cuZG9jdW1lbnQucmVmZXJyZXIgKyAnJnMzPScgKyBzcG90bmFtZTsKICAgICAgICAgICAgICAgICAgICAgICAgICAgIH07CiAgICAgICAgICAgICAgICAgICAgICAgICAgICB2YXIgbXB2VXJsID0gYnVpbGRVcmwoJ0hWRV9NdWx0aV8zX3BhZ2Vfdmlld3MnKTsKICAgICAgICAgICAgICAgICAgICAgICAgICAgIE1hcmtldGluZy5VRE8uaHZlX21wdihtcHZVcmwpOwogICAgICAgICAgICAgICAgICAgICAgICAgICAgdmFyIHNvY2lhbFVybCA9IGJ1aWxkVXJsKCdIVkVfU29jaWFsX3NoYXJlcycpOwogICAgICAgICAgICAgICAgICAgICAgICAgICAgTWFya2V0aW5nLlVETy5odmVfc29jaWFsKHNvY2lhbFVybCk7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICB2YXIgZG93bmxvYWRVcmwgPSBidWlsZFVybCgnSFZFX0Fzc2V0X2Rvd25sb2FkcycpOwogICAgICAgICAgICAgICAgICAgICAgICAgICAgTWFya2V0aW5nLlVETy5odmVfZG93bmxvYWQoZG93bmxvYWRVcmwpOwogICAgICAgICAgICAgICAgICAgICAgICAgICAgdmFyIHZpZGVvVXJsID0gYnVpbGRVcmwoJ0hWRV9WaWRlb19wbGF5Jyk7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICBNYXJrZXRpbmcuVURPLmh2ZV95dHViZSh2aWRlb1VybCk7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICBNYXJrZXRpbmcuVURPLmh2ZV9iY292ZSh2aWRlb1VybCk7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICB2YXIgY2hhdFVybCA9IGJ1aWxkVXJsKCdIVkVfQ2hhdCcpOwogICAgICAgICAgICAgICAgICAgICAgICAgICAgTWFya2V0aW5nLlVETy5odmVfY2hhdChjaGF0VXJsKTsKICAgICAgICAgICAgICAgICAgICAgICAgICAgIHZhciBjb250YWN0VXJsID0gYnVpbGRVcmwoJ0hWRV9Db250YWN0VXMnKTsKICAgICAgICAgICAgICAgICAgICAgICAgICAgIE1hcmtldGluZy5VRE8uaHZlX2NvbnRhY3RVcyhjb250YWN0VXJsKTsKICAgICAgICAgICAgICAgICAgICAgICAgICAgIHZhciByZnFTdWJtaXRVcmwgPSBidWlsZFVybCgnSFZFX3JmcV9zdWJtaXQnKTsKICAgICAgICAgICAgICAgICAgICAgICAgICAgIE1hcmtldGluZy5VRE8uaHZlX3JmcV9zdWJtaXQocmZxU3VibWl0VXJsKTsKICAgICAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgICAgICAgICBNYXJrZXRpbmcuVURPLnBlcmZUaW1pbmdFbmQoJ3J1bGVJZC0nICsgdGhpcy5pZCArICctZGVwbG95bWVudElkLScgKyB0aGlzLmRlcGxveW1lbnRJZCk7CiAgICAgICAgICAgICAgICAgICAgfSBjYXRjaCAoZSkgewogICAgICAgICAgICAgICAgICAgICAgICBkZWxsX21hcmtldGluZ191dGlsLmRlYnVnKGUpOwogICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgIH0uYXBwbHkodGhpcywgYXJndW1lbnRzKTsKICAgICAgICAgICAgfSBmaW5hbGx5IHsKICAgICAgICAgICAgICAgIGlmICgkX19fb2xkXzNkZDFjM2EyODI0YWRkZTApCiAgICAgICAgICAgICAgICAgICAgKHt9LmNvbnN0cnVjdG9yLmRlZmluZVByb3BlcnR5KHdpbmRvdywgJ3Nlc3Npb25TdG9yYWdlJywgJF9fX29sZF8zZGQxYzNhMjgyNGFkZGUwKSk7CiAgICAgICAgICAgIH0KICAgICAgICB9LCAzNTkzMzU4LCBbMzYwNjMyOV0sIDYzNDAyMywgWzYxMDMyM10pOwogICAgfSgpKQp9"},{"name":"sugarcoat-fd66a6a4134ef30b76835db8bc91171c43f29651","aliases":[],"kind":{"mime":"application/javascript"},"content":"ewogICAgY29uc3QgJF9fX21vY2tfYTIwYTUwOWI0ZTc2Y2ExZCA9IHt9OwogICAgKGV4cG9ydHMgPT4gewogICAgICAgICd1c2Ugc3RyaWN0JzsKICAgICAgICBsZXQgaXNTZWFsZWQgPSBmYWxzZTsKICAgICAgICBjbGFzcyBTdG9yYWdlIHsKICAgICAgICAgICAgY29uc3RydWN0b3IoKSB7CiAgICAgICAgICAgICAgICBpZiAoaXNTZWFsZWQpIHsKICAgICAgICAgICAgICAgICAgICB0aHJvdyBuZXcgVHlwZUVycm9yKCdJbGxlZ2FsIGNvbnN0cnVjdG9yJyk7CiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgIH0KICAgICAgICAgICAgZ2V0IGxlbmd0aCgpIHsKICAgICAgICAgICAgICAgIHJldHVybiBPYmplY3Qua2V5cyh0aGlzKS5sZW5ndGg7CiAgICAgICAgICAgIH0KICAgICAgICAgICAga2V5KGluZGV4KSB7CiAgICAgICAgICAgICAgICBjb25zdCBrZXlzID0gT2JqZWN0LmtleXModGhpcyk7CiAgICAgICAgICAgICAgICBpZiAoaW5kZXggPCAwIHx8IGluZGV4ID49IGtleXMubGVuZ3RoKSB7CiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIG51bGw7CiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICByZXR1cm4ga2V5c1tpbmRleF07CiAgICAgICAgICAgIH0KICAgICAgICAgICAgZ2V0SXRlbShrZXkpIHsKICAgICAgICAgICAgICAgIHJldHVybiBPYmplY3QucHJvdG90eXBlLmhhc093blByb3BlcnR5LmNhbGwodGhpcywga2V5KSA/IHRoaXNba2V5XSA6IG51bGw7CiAgICAgICAgICAgIH0KICAgICAgICAgICAgc2V0SXRlbShrZXksIHZhbHVlKSB7CiAgICAgICAgICAgICAgICB0aGlzW2tleV0gPSBTdHJpbmcodmFsdWUpOwogICAgICAgICAgICB9CiAgICAgICAgICAgIHJlbW92ZUl0ZW0oa2V5KSB7CiAgICAgICAgICAgICAgICBkZWxldGUgdGhpc1trZXldOwogICAgICAgICAgICB9CiAgICAgICAgICAgIGNsZWFyKCkgewogICAgICAgICAgICAgICAgY29uc3Qga2V5cyA9IE9iamVjdC5rZXlzKHRoaXMpOwogICAgICAgICAgICAgICAgZm9yIChjb25zdCBrZXkgb2Yga2V5cykgewogICAgICAgICAgICAgICAgICAgIGRlbGV0ZSB0aGlzW2tleV07CiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgIH0KICAgICAgICB9CiAgICAgICAgZXhwb3J0cy5TdG9yYWdlID0gewogICAgICAgICAgICBjb25maWd1cmFibGU6IHRydWUsCiAgICAgICAgICAgIGVudW1lcmFibGU6IHRydWUsCiAgICAgICAgICAgIHZhbHVlOiBTdG9yYWdlLAogICAgICAgICAgICB3cml0YWJsZTogdHJ1ZQogICAgICAgIH07CiAgICAgICAgY29uc3QgbG9jYWxTdG9yYWdlID0gbmV3IFN0b3JhZ2UoKTsKICAgICAgICBleHBvcnRzLmxvY2FsU3RvcmFnZSA9IHsKICAgICAgICAgICAgY29uZmlndXJhYmxlOiB0cnVlLAogICAgICAgICAgICBlbnVtZXJhYmxlOiB0cnVlLAogICAgICAgICAgICBnZXQoKSB7CiAgICAgICAgICAgICAgICByZXR1cm4gbG9jYWxTdG9yYWdlOwogICAgICAgICAgICB9CiAgICAgICAgfTsKICAgICAgICBjb25zdCBzZXNzaW9uU3RvcmFnZSA9IG5ldyBTdG9yYWdlKCk7CiAgICAgICAgZXhwb3J0cy5zZXNzaW9uU3RvcmFnZSA9IHsKICAgICAgICAgICAgY29uZmlndXJhYmxlOiB0cnVlLAogICAgICAgICAgICBlbnVtZXJhYmxlOiB0cnVlLAogICAgICAgICAgICBnZXQoKSB7CiAgICAgICAgICAgICAgICByZXR1cm4gc2Vzc2lvblN0b3JhZ2U7CiAgICAgICAgICAgIH0KICAgICAgICB9OwogICAgICAgIGlzU2VhbGVkID0gdHJ1ZTsKICAgIH0pKCRfX19tb2NrX2EyMGE1MDliNGU3NmNhMWQpOwogICAgKGZ1bmN0aW9uICgpIHsKICAgICAgICBNYXJrZXRpbmcuYmluZERlcGVuZGVuY3lET01QYXJzZWQoZnVuY3Rpb24gKCkgewogICAgICAgICAgICBjb25zdCAkX19fb2xkX2ZiYWU1NzJmOGEyMzIyN2YgPSB7fS5jb25zdHJ1Y3Rvci5nZXRPd25Qcm9wZXJ0eURlc2NyaXB0b3Iod2luZG93LCAnc2Vzc2lvblN0b3JhZ2UnKTsKICAgICAgICAgICAgdHJ5IHsKICAgICAgICAgICAgICAgIGlmICgkX19fb2xkX2ZiYWU1NzJmOGEyMzIyN2YpCiAgICAgICAgICAgICAgICAgICAgKHt9LmNvbnN0cnVjdG9yLmRlZmluZVByb3BlcnR5KHdpbmRvdywgJ3Nlc3Npb25TdG9yYWdlJywgJF9fX21vY2tfYTIwYTUwOWI0ZTc2Y2ExZC5zZXNzaW9uU3RvcmFnZSkpOwogICAgICAgICAgICAgICAgcmV0dXJuIGZ1bmN0aW9uICgpIHsKICAgICAgICAgICAgICAgICAgICB2YXIgQm9vdHN0cmFwcGVyID0gd2luZG93WydNYXJrZXRpbmcnXTsKICAgICAgICAgICAgICAgICAgICB2YXIgZW5zaWdodGVuT3B0aW9ucyA9IE1hcmtldGluZy5lbnNpZ2h0ZW5PcHRpb25zOwogICAgICAgICAgICAgICAgICAgIHRyeSB7CiAgICAgICAgICAgICAgICAgICAgICAgIE1hcmtldGluZy5VRE8ucGVyZlRpbWluZ1N0YXJ0KCdydWxlSWQtJyArIHRoaXMuaWQgKyAnLWRlcGxveW1lbnRJZC0nICsgdGhpcy5kZXBsb3ltZW50SWQpOwogICAgICAgICAgICAgICAgICAgICAgICB2YXIgbWFya2V0aW5nc2NEYXRhT2JqID0gTWFya2V0aW5nLnNjRGF0YU9iaiwgbWFya2V0aW5nVURPID0gTWFya2V0aW5nLlVETywgY2FjaGVidXN0ZXIgPSBuZXcgRGF0ZSgpLmdldFRpbWUoKSwgcGl4ZWxJRCA9ICcnLCBodmVQaXhlbElEID0gJyc7CiAgICAgICAgICAgICAgICAgICAgICAgIHZhciBwaXhlbEZpcmUgPSBmdW5jdGlvbiAocGl4ZWxpZCkgewogICAgICAgICAgICAgICAgICAgICAgICAgICAgTWFya2V0aW5nLmltYWdlUmVxdWVzdCgnLy90Lm15dmlzdWFsaXEubmV0L2FjdGl2aXR5X3BpeGVsP3B0PWkmZXQ9YSZyPScgKyBjYWNoZWJ1c3RlciArICcmYWdvPTIxMiZhbz04NzEmcHg9JyArIHBpeGVsaWQgKyAnJm9yZD0nICsgbWFya2V0aW5nVURPLmRwaWQgKyAnJnJldmVudWU9JyArIG1hcmtldGluZ1VETy5yZXZlbnVlKTsKICAgICAgICAgICAgICAgICAgICAgICAgfTsKICAgICAgICAgICAgICAgICAgICAgICAgTWFya2V0aW5nLm9uKCdjbGljaycsICcuT295YWxhVmlkZW8nLCBmdW5jdGlvbiAoKSB7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICBwaXhlbGlkID0gJzEwMDEnOwogICAgICAgICAgICAgICAgICAgICAgICAgICAgcGl4ZWxGaXJlKHBpeGVsaWQpOwogICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKG1hcmtldGluZ3NjRGF0YU9iai5wYWdlLmluY2x1ZGVzKCdhbGllbndhcmUnKSB8fCBtYXJrZXRpbmdzY0RhdGFPYmouY2F0ZWdvcnlpZC5pbmNsdWRlcygnYWxpZW53YXJlJykgfHwgbWFya2V0aW5nVURPLmNhdGVnb3J5LmluY2x1ZGVzKCdhbGllbndhcmUnKSB8fCBtYXJrZXRpbmdVRE8uZmFtaWx5LnRvTG93ZXJDYXNlKCkuaW5jbHVkZXMoJ2FsaWVud2FyZScpKSB7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcGl4ZWxpZCA9ICcxMDAyJzsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBwaXhlbEZpcmUocGl4ZWxpZCk7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAobWFya2V0aW5nVURPLnNlZ21lbnQgPT0gJ2JzZCcpIHsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBwaXhlbGlkID0gJzEwMDMnOwogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHBpeGVsRmlyZShwaXhlbGlkKTsKICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmIChtYXJrZXRpbmdVRE8uc2VnbWVudCA9PSAnZGhzJykgewogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHBpeGVsaWQgPSAnMTAwNCc7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcGl4ZWxGaXJlKHBpeGVsaWQpOwogICAgICAgICAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKG1hcmtldGluZ1VETy5zZWdtZW50ID09ICdlZXAnKSB7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcGl4ZWxpZCA9ICcxMDA1JzsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBwaXhlbEZpcmUocGl4ZWxpZCk7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICAgICAgICAgIH0pOwogICAgICAgICAgICAgICAgICAgICAgICBpZiAod2luZG93LmxvY2F0aW9uLnBhdGhuYW1lID09ICcvZW4vc21hbGwtYnVzaW5lc3MtY2VudHJhbCcpIHsKICAgICAgICAgICAgICAgICAgICAgICAgICAgIHBpeGVsaWQgPSAnMTAwNic7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICBwaXhlbEZpcmUocGl4ZWxpZCk7CiAgICAgICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgICAgICAgICAgaWYgKHdpbmRvdy5sb2NhdGlvbi5wYXRobmFtZS5pbmNsdWRlcygnL2VuL3NtYWxsLWJ1c2luZXNzLWNlbnRyYWwvY29udGFjdC1kZWxsL3RoYW5rLXlvdScpKSB7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICBwaXhlbGlkID0gJzEwMDcnOwogICAgICAgICAgICAgICAgICAgICAgICAgICAgcGl4ZWxGaXJlKHBpeGVsaWQpOwogICAgICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICAgICAgICAgIG1hcmtldGluZ1VETy5odmVfbXB2KCcvL3QubXl2aXN1YWxpcS5uZXQvYWN0aXZpdHlfcGl4ZWw/cHQ9aSZldD1hJnI9JyArIGNhY2hlYnVzdGVyICsgJyZhZ289MjEyJmFvPTg3MSZweD04Nzgmb3JkPScgKyBtYXJrZXRpbmdVRE8uZHBpZCArICcmcmV2ZW51ZT0nICsgbWFya2V0aW5nVURPLnJldmVudWUpOwogICAgICAgICAgICAgICAgICAgICAgICBpZiAobWFya2V0aW5nVURPLnNlZ21lbnQgPT0gJ2JzZCcpCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBodmVQaXhlbElEID0gJzg4MCc7CiAgICAgICAgICAgICAgICAgICAgICAgIGlmIChtYXJrZXRpbmdVRE8uc2VnbWVudCA9PSAnZGhzJykKICAgICAgICAgICAgICAgICAgICAgICAgICAgIGh2ZVBpeGVsSUQgPSAnODgxJzsKICAgICAgICAgICAgICAgICAgICAgICAgaWYgKG1hcmtldGluZ1VETy5zZWdtZW50ID09ICdlZXAnKQogICAgICAgICAgICAgICAgICAgICAgICAgICAgaHZlUGl4ZWxJRCA9ICc4ODInOwogICAgICAgICAgICAgICAgICAgICAgICBpZiAobWFya2V0aW5nc2NEYXRhT2JqLnBhZ2UuaW5jbHVkZXMoJ2FsaWVud2FyZScpIHx8IG1hcmtldGluZ3NjRGF0YU9iai5jYXRlZ29yeWlkLmluY2x1ZGVzKCdhbGllbndhcmUnKSB8fCBtYXJrZXRpbmdVRE8uY2F0ZWdvcnkuaW5jbHVkZXMoJ2FsaWVud2FyZScpIHx8IG1hcmtldGluZ1VETy5mYW1pbHkudG9Mb3dlckNhc2UoKS5pbmNsdWRlcygnYWxpZW53YXJlJykpCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBodmVQaXhlbElEID0gJzg3OSc7CiAgICAgICAgICAgICAgICAgICAgICAgIGlmIChodmVQaXhlbElEICE9PSAnJykKICAgICAgICAgICAgICAgICAgICAgICAgICAgIG1hcmtldGluZ1VETy5odmVfbXB2KCcvL3QubXl2aXN1YWxpcS5uZXQvYWN0aXZpdHlfcGl4ZWw/cHQ9aSZldD1hJnI9JyArIGNhY2hlYnVzdGVyICsgJyZhZ289MjEyJmFvPTg3MSZweD0nICsgaHZlUGl4ZWxJRCArICcmb3JkPScgKyBtYXJrZXRpbmdVRE8uZHBpZCArICcmcmV2ZW51ZT0nICsgbWFya2V0aW5nVURPLnJldmVudWUpOwogICAgICAgICAgICAgICAgICAgICAgICBNYXJrZXRpbmcuVURPLnBlcmZUaW1pbmdFbmQoJ3J1bGVJZC0nICsgdGhpcy5pZCArICctZGVwbG95bWVudElkLScgKyB0aGlzLmRlcGxveW1lbnRJZCk7CiAgICAgICAgICAgICAgICAgICAgfSBjYXRjaCAoZSkgewogICAgICAgICAgICAgICAgICAgICAgICBkZWxsX21hcmtldGluZ191dGlsLmRlYnVnKGUpOwogICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgIH0uYXBwbHkodGhpcywgYXJndW1lbnRzKTsKICAgICAgICAgICAgfSBmaW5hbGx5IHsKICAgICAgICAgICAgICAgIGlmICgkX19fb2xkX2ZiYWU1NzJmOGEyMzIyN2YpCiAgICAgICAgICAgICAgICAgICAgKHt9LmNvbnN0cnVjdG9yLmRlZmluZVByb3BlcnR5KHdpbmRvdywgJ3Nlc3Npb25TdG9yYWdlJywgJF9fX29sZF9mYmFlNTcyZjhhMjMyMjdmKSk7CiAgICAgICAgICAgIH0KICAgICAgICB9LCAzNTkzMzc0LCBbMzYwNjMyOV0sIDYzODAyMCwgWzYxMDMyM10pOwogICAgfSgpKQp9"}]